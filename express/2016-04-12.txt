{"nick":"antiPoP","reason":"Ping timeout: 248 seconds","date":"2016-04-12T00:00:30.051Z","type":"quit"}
{"nick":"smokeo","reason":"Remote host closed the connection","date":"2016-04-12T00:41:42.300Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T00:50:19.686Z","type":"join"}
{"nick":"vincentcr","date":"2016-04-12T00:57:38.472Z","type":"join"}
{"nick":"vincentcr","reason":"Ping timeout: 260 seconds","date":"2016-04-12T01:01:59.480Z","type":"quit"}
{"nick":"smokeo","reason":"Remote host closed the connection","date":"2016-04-12T01:25:13.290Z","type":"quit"}
{"nick":"nilsi","date":"2016-04-12T01:46:12.012Z","type":"join"}
{"nick":"nilsi","reason":"Ping timeout: 244 seconds","date":"2016-04-12T01:50:36.942Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T01:53:16.691Z","type":"join"}
{"nick":"Ahmed90","reason":"Quit: Leaving","date":"2016-04-12T01:58:02.306Z","type":"quit"}
{"nick":"subfuzion","reason":"Read error: Connection reset by peer","date":"2016-04-12T02:05:33.740Z","type":"quit"}
{"nick":"loglaunch","reason":"Ping timeout: 248 seconds","date":"2016-04-12T02:05:50.139Z","type":"quit"}
{"nick":"aisipos","reason":"Ping timeout: 248 seconds","date":"2016-04-12T02:05:50.294Z","type":"quit"}
{"nick":"subfuzion","date":"2016-04-12T02:06:00.338Z","type":"join"}
{"nick":"aisipos","date":"2016-04-12T02:07:45.207Z","type":"join"}
{"nick":"jhirley","reason":"Quit: This computer has gone to sleep","date":"2016-04-12T02:11:09.872Z","type":"quit"}
{"nick":"crawleyprint","reason":"Ping timeout: 248 seconds","date":"2016-04-12T02:11:10.683Z","type":"quit"}
{"nick":"loglaunch","date":"2016-04-12T02:13:04.242Z","type":"join"}
{"nick":"blindbox","reason":"Ping timeout: 248 seconds","date":"2016-04-12T02:14:22.128Z","type":"quit"}
{"nick":"crawleyprint","date":"2016-04-12T02:17:15.129Z","type":"join"}
{"nick":"blindbox","date":"2016-04-12T02:18:09.042Z","type":"join"}
{"nick":"danneu","date":"2016-04-12T02:42:03.339Z","type":"join"}
{"nick":"vincentcr","date":"2016-04-12T02:58:27.000Z","type":"join"}
{"nick":"vincentcr","reason":"Ping timeout: 240 seconds","date":"2016-04-12T03:03:03.914Z","type":"quit"}
{"nick":"brolin","reason":"Quit: Lost terminal","date":"2016-04-12T03:03:11.851Z","type":"quit"}
{"nick":"smokeo","reason":"Remote host closed the connection","date":"2016-04-12T03:06:46.890Z","type":"quit"}
{"nick":"brolin","date":"2016-04-12T03:09:41.945Z","type":"join"}
{"nick":"waz","reason":"Quit: My Mac has gone to sleep. ZZZzzz…","date":"2016-04-12T03:17:52.569Z","type":"quit"}
{"nick":"Polyma","reason":"Quit: Polyma","date":"2016-04-12T03:31:57.296Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T03:31:59.983Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 240 seconds","date":"2016-04-12T03:36:33.883Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T03:37:45.474Z","type":"join"}
{"nick":"smokeo","reason":"Read error: Connection reset by peer","date":"2016-04-12T03:39:17.335Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T03:39:34.642Z","type":"join"}
{"nick":"smokeo_","date":"2016-04-12T03:42:53.043Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 244 seconds","date":"2016-04-12T03:44:46.673Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T03:45:46.018Z","type":"join"}
{"nick":"smokeo_","reason":"Ping timeout: 244 seconds","date":"2016-04-12T03:47:20.093Z","type":"quit"}
{"nick":"prbc","date":"2016-04-12T03:55:20.808Z","type":"join"}
{"nick":"smokeo","reason":"Remote host closed the connection","date":"2016-04-12T04:06:07.810Z","type":"quit"}
{"nick":"vincentc_","date":"2016-04-12T04:59:09.050Z","type":"join"}
{"nick":"vincentc_","reason":"Ping timeout: 264 seconds","date":"2016-04-12T05:04:04.056Z","type":"quit"}
{"nick":"brolin","reason":"Quit: Lost terminal","date":"2016-04-12T05:10:59.178Z","type":"quit"}
{"nick":"Abhishek_","reason":"Quit: Connection closed for inactivity","date":"2016-04-12T05:18:36.189Z","type":"quit"}
{"nick":"obbs","reason":"Read error: Connection reset by peer","date":"2016-04-12T05:23:12.661Z","type":"quit"}
{"nick":"obbs","date":"2016-04-12T05:23:48.549Z","type":"join"}
{"nick":"obbs_","date":"2016-04-12T05:23:54.545Z","type":"join"}
{"nick":"danneu","reason":"Quit: Connection closed for inactivity","date":"2016-04-12T05:26:45.824Z","type":"quit"}
{"nick":"fkm","reason":"Ping timeout: 244 seconds","date":"2016-04-12T05:32:46.967Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T05:37:30.346Z","type":"join"}
{"nick":"lpin","date":"2016-04-12T05:38:01.196Z","type":"join"}
{"nick":"fkm","date":"2016-04-12T05:38:20.444Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 246 seconds","date":"2016-04-12T05:41:45.337Z","type":"quit"}
{"nick":"bybb","date":"2016-04-12T05:55:22.173Z","type":"join"}
{"nick":"smokeo","date":"2016-04-12T06:09:35.210Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 268 seconds","date":"2016-04-12T06:14:32.205Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T06:41:43.652Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 244 seconds","date":"2016-04-12T06:46:07.646Z","type":"quit"}
{"nick":"vincentcr","date":"2016-04-12T06:59:46.646Z","type":"join"}
{"nick":"fees","date":"2016-04-12T07:00:50.577Z","type":"join"}
{"nick":"cyphase","reason":"Ping timeout: 250 seconds","date":"2016-04-12T07:03:15.067Z","type":"quit"}
{"nick":"vincentcr","reason":"Ping timeout: 244 seconds","date":"2016-04-12T07:04:12.676Z","type":"quit"}
{"nick":"visualshock","date":"2016-04-12T07:08:31.655Z","type":"join"}
{"nick":"nilsi_","date":"2016-04-12T07:10:49.724Z","type":"join"}
{"nick":"nilsi_","reason":"Ping timeout: 252 seconds","date":"2016-04-12T07:15:10.386Z","type":"quit"}
{"nick":"cyphase","date":"2016-04-12T07:16:47.454Z","type":"join"}
{"nick":"clarkk","date":"2016-04-12T07:32:03.150Z","type":"join"}
{"nick":"smokeo","date":"2016-04-12T07:39:42.288Z","type":"join"}
{"nick":"EdenCoder","reason":"Ping timeout: 276 seconds","date":"2016-04-12T07:39:45.321Z","type":"quit"}
{"nick":"smokeo","reason":"Ping timeout: 276 seconds","date":"2016-04-12T07:44:57.309Z","type":"quit"}
{"nick":"clarkk","reason":"Quit: Leaving.","date":"2016-04-12T07:47:52.077Z","type":"quit"}
{"nick":"clarkk","date":"2016-04-12T07:48:12.926Z","type":"join"}
{"nick":"visualshock","reason":"Quit: Leaving","date":"2016-04-12T07:48:39.538Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T07:51:40.949Z","type":"join"}
{"nick":"smokeo","reason":"Read error: Connection reset by peer","date":"2016-04-12T07:52:53.111Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T07:53:27.831Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 248 seconds","date":"2016-04-12T07:57:55.867Z","type":"quit"}
{"nick":"cdbattags","date":"2016-04-12T07:58:19.294Z","type":"join"}
{"nick":"bybb","reason":"Remote host closed the connection","date":"2016-04-12T07:58:33.784Z","type":"quit"}
{"nick":"bybb","date":"2016-04-12T08:10:54.241Z","type":"join"}
{"nick":"prbc","reason":"Remote host closed the connection","date":"2016-04-12T08:15:14.062Z","type":"quit"}
{"nick":"prbc","date":"2016-04-12T08:16:28.276Z","type":"join"}
{"nick":"deam","date":"2016-04-12T08:20:58.440Z","type":"join"}
{"nick":"prbc","reason":"Ping timeout: 248 seconds","date":"2016-04-12T08:21:23.809Z","type":"quit"}
{"nick":"prbc","date":"2016-04-12T08:38:45.545Z","type":"join"}
{"nick":"encod3","date":"2016-04-12T08:39:32.460Z","type":"join"}
{"nick":"smokeo","date":"2016-04-12T08:39:39.470Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 260 seconds","date":"2016-04-12T08:44:34.478Z","type":"quit"}
{"nick":"lennym","date":"2016-04-12T08:46:42.341Z","type":"join"}
{"nick":"lennym","message":"Morning all","date":"2016-04-12T08:47:11.578Z","type":"message"}
{"nick":"prbc","reason":"Remote host closed the connection","date":"2016-04-12T08:55:53.635Z","type":"quit"}
{"nick":"liamonade","date":"2016-04-12T08:59:05.703Z","type":"join"}
{"nick":"busticated","reason":"Read error: Connection reset by peer","date":"2016-04-12T09:01:25.460Z","type":"quit"}
{"nick":"busticated","date":"2016-04-12T09:02:07.165Z","type":"join"}
{"nick":"visualshock","date":"2016-04-12T09:15:48.644Z","type":"join"}
{"nick":"cdbattag_","date":"2016-04-12T09:23:31.442Z","type":"join"}
{"nick":"cdbattags","reason":"Ping timeout: 276 seconds","date":"2016-04-12T09:27:00.317Z","type":"quit"}
{"nick":"cdbattag_","reason":"Remote host closed the connection","date":"2016-04-12T09:30:58.584Z","type":"quit"}
{"nick":"cdbattags","date":"2016-04-12T09:31:27.049Z","type":"join"}
{"nick":"liamonade","reason":"Ping timeout: 260 seconds","date":"2016-04-12T09:34:22.692Z","type":"quit"}
{"nick":"liamonade","date":"2016-04-12T09:34:34.400Z","type":"join"}
{"nick":"cdbattag_","date":"2016-04-12T09:34:35.827Z","type":"join"}
{"nick":"cdbattag_","reason":"Remote host closed the connection","date":"2016-04-12T09:35:39.505Z","type":"quit"}
{"nick":"cdbattag_","date":"2016-04-12T09:36:06.035Z","type":"join"}
{"nick":"cdbattags","reason":"Read error: Connection reset by peer","date":"2016-04-12T09:36:38.340Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T09:39:41.988Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 240 seconds","date":"2016-04-12T09:44:03.890Z","type":"quit"}
{"nick":"thealphanerd","reason":"Quit: farewell for now","date":"2016-04-12T10:27:27.187Z","type":"quit"}
{"nick":"thealphanerd","date":"2016-04-12T10:27:57.607Z","type":"join"}
{"nick":"stennowork","date":"2016-04-12T10:34:33.862Z","type":"join"}
{"nick":"stennowork","message":"BONJOUR!!","date":"2016-04-12T10:35:14.435Z","type":"message"}
{"nick":"stennowork","action":"learned that in france you have to greet others loud and happily, otherwise they'll be insulted by it","date":"2016-04-12T10:35:33.630Z","type":"action"}
{"nick":"smokeo","date":"2016-04-12T10:39:36.008Z","type":"join"}
{"nick":"cdbattags","date":"2016-04-12T10:41:37.022Z","type":"join"}
{"nick":"smokeo","reason":"Ping timeout: 264 seconds","date":"2016-04-12T10:44:16.005Z","type":"quit"}
{"nick":"cdbattags","reason":"Remote host closed the connection","date":"2016-04-12T10:44:25.098Z","type":"quit"}
{"nick":"cdbattags","date":"2016-04-12T10:44:51.989Z","type":"join"}
{"nick":"cdbattag_","reason":"Ping timeout: 248 seconds","date":"2016-04-12T10:45:18.069Z","type":"quit"}
{"nick":"cdbattag_","date":"2016-04-12T10:53:52.302Z","type":"join"}
{"nick":"cdbattag_","reason":"Remote host closed the connection","date":"2016-04-12T10:54:07.030Z","type":"quit"}
{"nick":"cdbattags","reason":"Read error: Connection reset by peer","date":"2016-04-12T10:54:13.327Z","type":"quit"}
{"nick":"cdbattags","date":"2016-04-12T10:54:44.162Z","type":"join"}
{"nick":"vincentcr","date":"2016-04-12T11:01:16.582Z","type":"join"}
{"nick":"clarkk","reason":"Quit: Leaving.","date":"2016-04-12T11:02:22.658Z","type":"quit"}
{"nick":"vincentcr","reason":"Ping timeout: 252 seconds","date":"2016-04-12T11:05:37.452Z","type":"quit"}
{"nick":"sagaris","date":"2016-04-12T11:06:38.422Z","type":"join"}
{"nick":"sagaris","reason":"Client Quit","date":"2016-04-12T11:07:10.025Z","type":"quit"}
{"nick":"waz","date":"2016-04-12T11:08:07.865Z","type":"join"}
{"nick":"encod3","reason":"Remote host closed the connection","date":"2016-04-12T11:13:01.757Z","type":"quit"}
{"nick":"encod3","date":"2016-04-12T11:14:00.543Z","type":"join"}
{"nick":"encod3","reason":"Ping timeout: 252 seconds","date":"2016-04-12T11:18:49.405Z","type":"quit"}
{"nick":"Polyma","date":"2016-04-12T11:22:53.381Z","type":"join"}
{"nick":"nilsi_","date":"2016-04-12T11:29:06.307Z","type":"join"}
{"nick":"encod3","date":"2016-04-12T11:31:59.350Z","type":"join"}
{"nick":"lpin","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2016-04-12T11:36:36.417Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T11:39:34.291Z","type":"join"}
{"nick":"mven_","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2016-04-12T11:44:12.839Z","type":"quit"}
{"nick":"smokeo","reason":"Ping timeout: 276 seconds","date":"2016-04-12T11:44:48.285Z","type":"quit"}
{"nick":"waz","reason":"Quit: My Mac has gone to sleep. ZZZzzz…","date":"2016-04-12T11:50:05.774Z","type":"quit"}
{"nick":"smokeo","date":"2016-04-12T11:52:09.482Z","type":"join"}
{"nick":"waz","date":"2016-04-12T11:53:55.980Z","type":"join"}
{"nick":"bybb","reason":"Remote host closed the connection","date":"2016-04-12T12:01:29.280Z","type":"quit"}
{"nick":"stmbgr","date":"2016-04-12T12:03:49.636Z","type":"join"}
{"nick":"smokeo","reason":"Remote host closed the connection","date":"2016-04-12T12:21:14.920Z","type":"quit"}
{"nick":"jimmychoo","date":"2016-04-12T12:39:08.949Z","type":"join"}
{"nick":"nilsi_","reason":"Remote host closed the connection","date":"2016-04-12T12:40:13.367Z","type":"quit"}
{"nick":"stennowork","message":"gnrf","date":"2016-04-12T12:43:32.429Z","type":"message"}
{"nick":"visualshock","reason":"Quit: Leaving","date":"2016-04-12T12:48:09.965Z","type":"quit"}
{"nick":"annoymouse","date":"2016-04-12T12:48:42.208Z","type":"join"}
{"nick":"liamonade","reason":"Quit: This computer has gone to sleep","date":"2016-04-12T12:50:11.228Z","type":"quit"}
{"nick":"towb","message":"ladies and gents i tell you this for sure, when the circus was here they had a big uproar, walking hand in hand the female chimpanzee take stennowork for she man LALALA","date":"2016-04-12T12:50:21.843Z","type":"message"}
{"nick":"towb","message":"stennowork: whats up","date":"2016-04-12T12:51:23.223Z","type":"message"}
{"nick":"stennowork","message":"what is that even supposed to mean","date":"2016-04-12T12:51:36.444Z","type":"message"}
{"nick":"towb","message":"that you ran awayw ith the monkey","date":"2016-04-12T12:52:17.616Z","type":"message"}
{"nick":"stennowork","message":"why should i do that","date":"2016-04-12T12:52:47.925Z","type":"message"}
{"nick":"towb","message":"i stole it from an old calypso song battle, think rap battle but less hoes and more fun","date":"2016-04-12T12:52:56.374Z","type":"message"}
{"nick":"towb","message":"and like ~1960","date":"2016-04-12T12:53:07.394Z","type":"message"}
{"nick":"stennowork","message":"just this way to the neon orange gallow, tonight we tighten the noose around the killers collar","date":"2016-04-12T12:53:40.165Z","type":"message"}
{"nick":"stennowork","message":"watch him play his wind pipe organ","date":"2016-04-12T12:53:54.550Z","type":"message"}
{"nick":"towb","message":"o.O","date":"2016-04-12T12:54:35.947Z","type":"message"}
{"nick":"towb","message":"reminds me about... saddam","date":"2016-04-12T12:54:59.115Z","type":"message"}
{"nick":"stennowork","message":"just 5 dollars to see a face explode, to see a man strung up by his throat, come one come all, if you look close enough you see deaths machinery exposed","date":"2016-04-12T12:55:14.848Z","type":"message"}
{"nick":"towb","message":"i think you need more happy music :O","date":"2016-04-12T12:56:03.886Z","type":"message"}
{"nick":"stennowork","message":"so wont you hold me closer, just one more minute, until the execution's over, won't you behead another, c'mon we're waiting, won't you shock and entertain us","date":"2016-04-12T12:56:18.305Z","type":"message"}
{"nick":"liamonade","date":"2016-04-12T12:56:36.238Z","type":"join"}
{"nick":"stennowork","message":"until the end of the world","date":"2016-04-12T12:57:17.400Z","type":"message"}
{"nick":"clarkk","date":"2016-04-12T12:57:28.019Z","type":"join"}
{"nick":"stennowork","message":"snap snap snap goes the neck, rah rah rah the audience, black black black goes his face, the sky spreads like thighs inside lace","date":"2016-04-12T12:58:29.611Z","type":"message"}
{"nick":"towb","message":"D:","date":"2016-04-12T12:58:50.387Z","type":"message"}
{"nick":"bybb","date":"2016-04-12T12:59:09.025Z","type":"join"}
{"nick":"nilsi_","date":"2016-04-12T12:59:34.615Z","type":"join"}
{"nick":"bybb","reason":"Remote host closed the connection","date":"2016-04-12T13:02:10.833Z","type":"quit"}
{"nick":"vincentc_","date":"2016-04-12T13:02:11.919Z","type":"join"}
{"nick":"waz","reason":"Read error: Connection reset by peer","date":"2016-04-12T13:03:10.436Z","type":"quit"}
{"nick":"waz","date":"2016-04-12T13:04:35.199Z","type":"join"}
{"nick":"vincentc_","reason":"Ping timeout: 240 seconds","date":"2016-04-12T13:06:33.887Z","type":"quit"}
{"nick":"jimmychoo","reason":"Quit: Bye!","date":"2016-04-12T13:08:27.066Z","type":"quit"}
{"nick":"liamonade","reason":"Quit: This computer has gone to sleep","date":"2016-04-12T13:08:37.098Z","type":"quit"}
{"nick":"liamonade","date":"2016-04-12T13:09:05.360Z","type":"join"}
{"nick":"bybb","date":"2016-04-12T13:12:04.473Z","type":"join"}
{"nick":"subfuzion","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2016-04-12T13:14:26.628Z","type":"quit"}
{"nick":"nilsi_","reason":"Remote host closed the connection","date":"2016-04-12T13:15:42.032Z","type":"quit"}
{"nick":"jimmychoo","date":"2016-04-12T13:20:49.944Z","type":"join"}
{"nick":"bybb","reason":"Remote host closed the connection","date":"2016-04-12T13:23:49.032Z","type":"quit"}
{"nick":"samgoody","date":"2016-04-12T13:25:55.119Z","type":"join"}
{"nick":"Grimor","date":"2016-04-12T13:27:24.991Z","type":"join"}
{"nick":"clarkk","reason":"Quit: Leaving.","date":"2016-04-12T13:32:37.970Z","type":"quit"}
{"nick":"Auger","date":"2016-04-12T13:37:21.446Z","type":"join"}
{"nick":"smokeo","date":"2016-04-12T13:37:22.054Z","type":"join"}
{"nick":"Auger","message":"morning","date":"2016-04-12T13:37:39.703Z","type":"message"}
{"nick":"lennym","message":"afternoon Auger","date":"2016-04-12T13:39:58.919Z","type":"message"}
{"nick":"seaoftea","date":"2016-04-12T13:41:44.407Z","type":"join"}
{"nick":"seaoftea","message":"I have an app that uses middleware to return a url with a shortcode. Is there a way to get the path of the app.use method through the req object, or some other way?","date":"2016-04-12T13:44:08.181Z","type":"message"}
{"nick":"lennym","message":"seaoftea: Not 100% sure I follow what you mean? Is this right: You have a middleware which might be mounted on a route, and you want to get the full url (because req.url has stripped the mount path)?","date":"2016-04-12T13:47:38.982Z","type":"message"}
{"nick":"lennym","message":"seaoftea: req.originalUrl sounds like it might be what you need","date":"2016-04-12T13:47:50.532Z","type":"message"}
{"nick":"lennym","message":"seaoftea: Or req.baseUrl if you want the mounting path","date":"2016-04-12T13:48:01.576Z","type":"message"}
{"nick":"christo_m","message":"has anyone here done batch processsing in express?","date":"2016-04-12T13:48:04.583Z","type":"message"}
{"nick":"christo_m","message":"i want to chain api calls like generate a pdf.. then email it, etc","date":"2016-04-12T13:48:18.362Z","type":"message"}
{"nick":"samgoody","reason":"Quit: Leaving.","date":"2016-04-12T13:48:24.918Z","type":"quit"}
{"nick":"seaoftea","message":"lennym, Thanks, baseUrl is what I was looking for. I could have sworn that I tried that and it didn't return anything but maybe I just kept going between url and originalUrl... what's the difference between req.url and req.path?","date":"2016-04-12T13:52:05.079Z","type":"message"}
{"nick":"lennym","message":"seaoftea: Not 100% sure of the difference off the top of my head","date":"2016-04-12T13:52:41.935Z","type":"message"}
{"nick":"christo_m","message":"lennym: any ideas?","date":"2016-04-12T13:54:07.776Z","type":"message"}
{"nick":"christo_m","message":"i tihnk i asked this before but didn't really get a clear answer from anyone :(","date":"2016-04-12T13:54:18.978Z","type":"message"}
{"nick":"lennym","message":"christo_m: Chaining api calls just sounds like a middleware stack","date":"2016-04-12T13:55:31.664Z","type":"message"}
{"nick":"christo_m","message":"lennym: right.","date":"2016-04-12T13:55:54.494Z","type":"message"}
{"nick":"christo_m","message":"but what if they may depend on each other..","date":"2016-04-12T13:56:01.200Z","type":"message"}
{"nick":"christo_m","message":"i cant just aggregate a bunch of promises and execute them at once","date":"2016-04-12T13:56:14.263Z","type":"message"}
{"nick":"christo_m","message":"i need to take responses from one and use it for a request for another","date":"2016-04-12T13:56:24.652Z","type":"message"}
{"nick":"lennym","message":"seaoftea: I *think* req.url may include query string parameters, and req.path is always just the path","date":"2016-04-12T13:56:30.676Z","type":"message"}
{"nick":"seaoftea","message":"christo_m, You can pass information /w the req object.","date":"2016-04-12T13:56:31.685Z","type":"message"}
{"nick":"lennym","message":"this^","date":"2016-04-12T13:56:45.141Z","type":"message"}
{"nick":"christo_m","message":"seaoftea: explain","date":"2016-04-12T13:57:09.451Z","type":"message"}
{"nick":"christo_m","message":"how id go about this","date":"2016-04-12T13:57:16.094Z","type":"message"}
{"nick":"lennym","message":"christo_m: Each step in your middleware stack decorates the request (or response) object with anything that subsequent steps might need to execute.","date":"2016-04-12T13:57:48.465Z","type":"message"}
{"nick":"seaoftea","message":"christo_m, OK, each middleware uses (req,res,next). You just assign your data to req.SOMEVAR and then call next()","date":"2016-04-12T13:57:57.439Z","type":"message"}
{"nick":"christo_m","message":"yes i know how middleware works.","date":"2016-04-12T13:58:01.912Z","type":"message"}
{"nick":"christo_m","message":"that doesnt solve my problem though","date":"2016-04-12T13:58:06.132Z","type":"message"}
{"nick":"lennym","message":"(related: I recently saw res.locals used for this purpose, and I think it makes a lot of sense)","date":"2016-04-12T13:58:12.368Z","type":"message"}
{"nick":"lennym","message":"Why not?","date":"2016-04-12T13:58:18.203Z","type":"message"}
{"nick":"lennym","message":"What is left of your problem that is unsolved?","date":"2016-04-12T13:58:31.492Z","type":"message"}
{"nick":"christo_m","message":"lennym: okay.. so i need to make a PDF and then email it.. i have /pdf and /email","date":"2016-04-12T13:58:34.330Z","type":"message"}
{"nick":"lennym","message":"Why do you have two routes for one action?","date":"2016-04-12T13:58:52.891Z","type":"message"}
{"nick":"christo_m","message":"because sometimes i just want to email things","date":"2016-04-12T13:59:01.300Z","type":"message"}
{"nick":"christo_m","message":"and sometimes i just want a PDF","date":"2016-04-12T13:59:05.016Z","type":"message"}
{"nick":"christo_m","message":"they're actually separate things.","date":"2016-04-12T13:59:08.153Z","type":"message"}
{"nick":"christo_m","message":"but having /makeAndSendPDF breaks rest.","date":"2016-04-12T13:59:22.847Z","type":"message"}
{"nick":"seaoftea","message":"ok but underneath the /pdf and /email requests are functions that you can call in a separate chain?","date":"2016-04-12T13:59:35.862Z","type":"message"}
{"nick":"christo_m","message":"and also i dont want to chain these requests clientside bceause the client is mobile in this case","date":"2016-04-12T13:59:36.683Z","type":"message"}
{"nick":"lennym","message":"OK, so you take the functions ound to those routes, and stick them together in a stack which you bind to /pdf-and-email","date":"2016-04-12T13:59:38.672Z","type":"message"}
{"nick":"christo_m","message":"lennym: lol, no.","date":"2016-04-12T13:59:49.087Z","type":"message"}
{"nick":"christo_m","message":"because then if i want to upload to rackspace cdn","date":"2016-04-12T13:59:59.080Z","type":"message"}
{"nick":"lennym","message":"In which case I can no longer help you","date":"2016-04-12T13:59:59.970Z","type":"message"}
{"nick":"christo_m","message":"i need /pdf-and-email-and-upload","date":"2016-04-12T14:00:07.029Z","type":"message"}
{"nick":"christo_m","message":"that isnt the solution.","date":"2016-04-12T14:00:09.323Z","type":"message"}
{"nick":"christo_m","message":"and it breaks REST purity.","date":"2016-04-12T14:00:13.827Z","type":"message"}
{"nick":"lennym","message":"(unless you were just lolling at my route, which is fine, replace /pdf-and-email with a route of your choice","date":"2016-04-12T14:00:29.664Z","type":"message"}
{"nick":"lennym","message":")","date":"2016-04-12T14:00:31.246Z","type":"message"}
{"nick":"christo_m","message":"yes and everytime a new use case comes up i have to make a new custom route like that","date":"2016-04-12T14:00:47.739Z","type":"message"}
{"nick":"christo_m","message":"that doesnt make sense","date":"2016-04-12T14:00:50.744Z","type":"message"}
{"nick":"lennym","message":"Well, your problem is that you want to have one incoming request perform that action, right?","date":"2016-04-12T14:01:09.674Z","type":"message"}
{"nick":"lennym","message":"So it will need to have a url.","date":"2016-04-12T14:01:20.652Z","type":"message"}
{"nick":"seaoftea","message":"christo_m, Then just have one route called /whatever and use query's... if you want to create pdf and email then ?pdf=true&email=true","date":"2016-04-12T14:01:47.331Z","type":"message"}
{"nick":"seaoftea","message":"Then have all your middleware in a row that checks for each query and then executes","date":"2016-04-12T14:02:51.862Z","type":"message"}
{"nick":"lennym","message":"This would work too ^","date":"2016-04-12T14:03:23.078Z","type":"message"}
{"nick":"seaoftea","message":"Other than that, IDK even know how you would do it with any technology","date":"2016-04-12T14:03:27.119Z","type":"message"}
{"nick":"lennym","message":"But it sounds like your problem is not one of \"how do I do this?\" but \"how do I write a url scheme that satisfactorily describes this?\"","date":"2016-04-12T14:03:54.387Z","type":"message"}
{"nick":"lennym","message":"Which is a fine problem to have, but is different to the one you first described.","date":"2016-04-12T14:04:14.977Z","type":"message"}
{"nick":"Fishrock123","date":"2016-04-12T14:05:12.487Z","type":"join"}
{"nick":"seaoftea","message":"lennym, about that res.locals thing. Why do you think we should store data in there instead?","date":"2016-04-12T14:06:00.873Z","type":"message"}
{"nick":"lennym","message":"seaoftea: Because/if the data is more closely related to sending responses that the request itself","date":"2016-04-12T14:06:35.434Z","type":"message"}
{"nick":"seaoftea","message":"sure, separate it out logically","date":"2016-04-12T14:06:53.897Z","type":"message"}
{"nick":"seaoftea","message":"makes sense","date":"2016-04-12T14:06:56.149Z","type":"message"}
{"nick":"lennym","message":"seaoftea: When it's some aspect of the request - e.g. req.user, req.session then that's fine","date":"2016-04-12T14:07:02.447Z","type":"message"}
{"nick":"lennym","message":"seaoftea: But I think treating res.locals as \"this is the place where we keep data relevant to sending a response\" scales past just template rendering","date":"2016-04-12T14:07:45.911Z","type":"message"}
{"nick":"lennym","message":"seaoftea: And potentially makes it simpler to swap between rendering templates and sending json","date":"2016-04-12T14:08:36.088Z","type":"message"}
{"nick":"lennym","message":"If you've got an SPA that also does server-side rendering depending on accepts headers","date":"2016-04-12T14:09:01.000Z","type":"message"}
{"nick":"lennym","message":"For example","date":"2016-04-12T14:09:05.479Z","type":"message"}
{"nick":"lennym","message":"It's only something I saw in the wild literally yesterday, but it got me thinking it's a good idea","date":"2016-04-12T14:09:22.617Z","type":"message"}
{"nick":"noteness","reason":"Ping timeout: 246 seconds","date":"2016-04-12T14:13:48.438Z","type":"quit"}
{"nick":"christo_m","message":"did either of you look at the batch-request thing i posted?","date":"2016-04-12T14:16:16.535Z","type":"message"}
{"nick":"christo_m","message":"lennym: http://batch-request.socialradar.com/#dependencies","date":"2016-04-12T14:16:29.483Z","type":"message"}
{"nick":"christo_m","message":"the problem is i cant do anything with the response..","date":"2016-04-12T14:16:46.416Z","type":"message"}
{"nick":"samgoody","date":"2016-04-12T14:16:54.551Z","type":"join"}
{"nick":"christo_m","message":"i get back a json object that tells me the response of each request","date":"2016-04-12T14:16:57.040Z","type":"message"}
{"nick":"christo_m","message":"so no , it isnt about URL scheme or query params necessarily, this uses a JSON object in the post body to dictate what happens","date":"2016-04-12T14:17:21.744Z","type":"message"}
{"nick":"noteness","date":"2016-04-12T14:19:03.247Z","type":"join"}
{"nick":"christo_m","message":"lennym: anyway, assume my problem is what you described, i still dont know how im doing this","date":"2016-04-12T14:22:54.661Z","type":"message"}
{"nick":"jimmychoo","reason":"Ping timeout: 240 seconds","date":"2016-04-12T14:32:03.891Z","type":"quit"}
{"nick":"brolin","date":"2016-04-12T14:36:18.265Z","type":"join"}
{"nick":"lennym","message":"christo_m: So, you say you can't/don't want to make multiple requests from the client, which means you pretty much have to have a single endpoint.","date":"2016-04-12T14:39:17.996Z","type":"message"}
{"nick":"lennym","message":"christo_m: Once you've hit your server, the benefit of using that batch request thing is zero, since you already have access to the routers/middleware that performs those actions directly, there's no need to add the overhead of an http request from the server to itself","date":"2016-04-12T14:40:14.776Z","type":"message"}
{"nick":"christo_m","message":"lennym: https://gist.github.com/christomitov/ad359acc36ffea0282a3f5aaa48b0a6e","date":"2016-04-12T14:40:29.072Z","type":"message"}
{"nick":"christo_m","message":"now i have to do something like this","date":"2016-04-12T14:40:31.800Z","type":"message"}
{"nick":"christo_m","message":"this is going to become monolith as more cases come up.","date":"2016-04-12T14:40:38.937Z","type":"message"}
{"nick":"clarkk","date":"2016-04-12T14:41:00.502Z","type":"join"}
{"nick":"christo_m","message":"lennym: well thats the other problem","date":"2016-04-12T14:41:02.933Z","type":"message"}
{"nick":"christo_m","message":"this API is a bunch of micro services.. so /file is its own app/endpoint","date":"2016-04-12T14:41:11.116Z","type":"message"}
{"nick":"christo_m","message":"same with /pdf, and /email.","date":"2016-04-12T14:41:14.852Z","type":"message"}
{"nick":"christo_m","message":"so the http requests happen from the server rather than the client, they're still there","date":"2016-04-12T14:41:31.590Z","type":"message"}
{"nick":"jimmychoo","date":"2016-04-12T14:41:39.941Z","type":"join"}
{"nick":"christo_m","message":"actually those ifs need to be else ifs, and the ordering matters.. the longer ones should be first","date":"2016-04-12T14:42:22.037Z","type":"message"}
{"nick":"lennym","message":"It's difficult to see why those if statements are like they are without some content. You could easily achieve the same with a middleware stack where each layer did if(req.query.thing) {} else { next() }","date":"2016-04-12T14:42:25.705Z","type":"message"}
{"nick":"christo_m","message":"lennym: right but it matters what came before that middleware..","date":"2016-04-12T14:43:25.658Z","type":"message"}
{"nick":"christo_m","message":"theres an implicit dependency","date":"2016-04-12T14:43:28.248Z","type":"message"}
{"nick":"christo_m","message":"they aren't swappable in isolation.. they will have to be in some order, i think.","date":"2016-04-12T14:43:59.766Z","type":"message"}
{"nick":"lennym","message":"If one of the layers depends on others, then you can build that into that particular layer, certainly","date":"2016-04-12T14:44:09.296Z","type":"message"}
{"nick":"lennym","message":"But your middleware stack is naturally ordered, so you just start with the least dependent and flow through","date":"2016-04-12T14:44:30.708Z","type":"message"}
{"nick":"christo_m","message":"lennym: okay so how would you construct this","date":"2016-04-12T14:44:40.646Z","type":"message"}
{"nick":"christo_m","message":"those are pretty much the three cases i have currently.","date":"2016-04-12T14:44:47.165Z","type":"message"}
{"nick":"christo_m","message":"in the gist i sent you","date":"2016-04-12T14:44:50.337Z","type":"message"}
{"nick":"lennym","message":"It's impossible for me to tell, without knowing what goes inside the conditionals","date":"2016-04-12T14:45:47.005Z","type":"message"}
{"nick":"christo_m","message":"ok well ill tell you right now that /pdf is the least dependent","date":"2016-04-12T14:46:05.825Z","type":"message"}
{"nick":"lennym","message":"For example, if req.query.pdf is set to true, is there pdf processing that is dependent on what else is happening after the pdf, or is it always going to be the case?","date":"2016-04-12T14:46:19.560Z","type":"message"}
{"nick":"christo_m","message":"PDF has no dependencies","date":"2016-04-12T14:46:27.743Z","type":"message"}
{"nick":"lennym","message":"Cool, so that's your first middleware in the stack","date":"2016-04-12T14:46:42.580Z","type":"message"}
{"nick":"christo_m","message":"i mean it takes a docDefintiion object as per the PDFMake docs","date":"2016-04-12T14:46:43.729Z","type":"message"}
{"nick":"christo_m","message":"ya thats a given","date":"2016-04-12T14:46:47.158Z","type":"message"}
{"nick":"christo_m","message":"okay now that thing responds with an application/pdf as the body","date":"2016-04-12T14:47:00.160Z","type":"message"}
{"nick":"christo_m","message":"but that needs to be siphoned into a req.body.message.attachments[{}] object","date":"2016-04-12T14:47:19.621Z","type":"message"}
{"nick":"christo_m","message":"like, an aboject inside the attachments array, before going to email for example.","date":"2016-04-12T14:47:30.177Z","type":"message"}
{"nick":"lennym","message":"Now, your email and file stuff, I guess those are a) independent of one another, and b) just need to have had some input generated previously - this might be a pdf, it might be something else","date":"2016-04-12T14:47:39.685Z","type":"message"}
{"nick":"christo_m","message":"correct","date":"2016-04-12T14:47:56.490Z","type":"message"}
{"nick":"christo_m","message":"!","date":"2016-04-12T14:47:57.911Z","type":"message"}
{"nick":"fbentz","date":"2016-04-12T14:48:02.389Z","type":"join"}
{"nick":"lennym","message":"(no need to act so shocked!)","date":"2016-04-12T14:48:06.987Z","type":"message"}
{"nick":"lennym","message":"So up at the top you'll create your attachments array, then any attachment-making middleware can just push to that.","date":"2016-04-12T14:48:49.556Z","type":"message"}
{"nick":"christo_m","message":"i had to","date":"2016-04-12T14:48:54.059Z","type":"message"}
{"nick":"christo_m","message":"its encouragement","date":"2016-04-12T14:48:57.078Z","type":"message"}
{"nick":"lennym","message":"Then you have two middlewares that sit at the bottom and process attachments.","date":"2016-04-12T14:49:04.700Z","type":"message"}
{"nick":"christo_m","message":"at the top?","date":"2016-04-12T14:49:06.517Z","type":"message"}
{"nick":"lennym","message":"They don't care what attachments have been created, nor do they care if other things are creating attachments.","date":"2016-04-12T14:49:31.068Z","type":"message"}
{"nick":"smokeo_","date":"2016-04-12T14:49:31.961Z","type":"join"}
{"nick":"christo_m","message":"i need to see an example","date":"2016-04-12T14:49:40.400Z","type":"message"}
{"nick":"lennym","message":"s/creating/processing","date":"2016-04-12T14:49:42.567Z","type":"message"}
{"nick":"christo_m","message":"you can just keep it super barebones","date":"2016-04-12T14:49:44.394Z","type":"message"}
{"nick":"christo_m","message":"i dont know why i need two middlewares for attachments..","date":"2016-04-12T14:49:52.895Z","type":"message"}
{"nick":"smokeo","reason":"Ping timeout: 244 seconds","date":"2016-04-12T14:52:48.157Z","type":"quit"}
{"nick":"smokeo_","reason":"Ping timeout: 244 seconds","date":"2016-04-12T14:53:52.941Z","type":"quit"}
{"nick":"lennym","message":"I put a comment on your gist, it's not perfect, obviously, I just coded it now, but it's how I might approach such a problem","date":"2016-04-12T14:56:02.440Z","type":"message"}
{"nick":"lennym","message":"https://gist.github.com/christomitov/ad359acc36ffea0282a3f5aaa48b0a6e#gistcomment-1748990","date":"2016-04-12T14:56:10.476Z","type":"message"}
{"nick":"lennym","message":"Obviosuly it could be VERY heavily DRY-ed out","date":"2016-04-12T14:56:40.685Z","type":"message"}
{"nick":"lennym","message":"Since every layer is \"if query flag do action with req, res\"","date":"2016-04-12T14:57:11.045Z","type":"message"}
{"nick":"christo_m","message":"lennym: why do you push pdf into response attachment?","date":"2016-04-12T14:57:23.359Z","type":"message"}
{"nick":"christo_m","message":"shouldnht be into the request object","date":"2016-04-12T14:57:27.602Z","type":"message"}
{"nick":"christo_m","message":"because then eventually /email is called with this modified request?","date":"2016-04-12T14:57:35.926Z","type":"message"}
{"nick":"lennym","message":"It doesn't really matter, I think I was thinking about what I said earlier about using res.locals","date":"2016-04-12T14:57:59.437Z","type":"message"}
{"nick":"lennym","message":"But then forgot the locals","date":"2016-04-12T14:58:05.422Z","type":"message"}
{"nick":"christo_m","message":"ok","date":"2016-04-12T14:58:17.104Z","type":"message"}
{"nick":"lennym","message":"Anyway, that doesn't matter. As long as it's on req OR res then it's available to later middlewares, which is the key","date":"2016-04-12T14:58:32.119Z","type":"message"}
{"nick":"lennym","message":"And I'd probably eventually end up making my \"do the thing\" functions middlewares themselves for maximal re-use/composability","date":"2016-04-12T14:59:16.713Z","type":"message"}
{"nick":"christo_m","message":"lennym: see the thing is you cant even assume PDF is going into an attachment array just because \"query.pdf\" is there","date":"2016-04-12T14:59:28.856Z","type":"message"}
{"nick":"christo_m","message":"really you only care about doing that if you're going to be emailing the PDF","date":"2016-04-12T14:59:38.620Z","type":"message"}
{"nick":"christo_m","message":"it may just as well be being posted to /file to be uploaded to CDN","date":"2016-04-12T14:59:46.926Z","type":"message"}
{"nick":"lennym","message":"Then don't use attachments for the variable name","date":"2016-04-12T14:59:57.746Z","type":"message"}
{"nick":"lennym","message":"Use something generic and process it into attachments later","date":"2016-04-12T15:00:09.627Z","type":"message"}
{"nick":"christo_m","message":"i see","date":"2016-04-12T15:00:22.558Z","type":"message"}
{"nick":"lennym","message":"The idea is to disconnect \"making the file\" from \"doing something with the file\"","date":"2016-04-12T15:00:30.353Z","type":"message"}
{"nick":"christo_m","message":"that is the idea indeed","date":"2016-04-12T15:00:36.828Z","type":"message"}
{"nick":"christo_m","message":"and in fact, why the endpoints are separate to begin with","date":"2016-04-12T15:00:42.056Z","type":"message"}
{"nick":"lennym","message":"The file maker don't care, it has one job","date":"2016-04-12T15:00:43.771Z","type":"message"}
{"nick":"christo_m","message":"exactly.","date":"2016-04-12T15:00:50.658Z","type":"message"}
{"nick":"lennym","message":"And the file sender don't care where the files came from, they have one job","date":"2016-04-12T15:00:56.586Z","type":"message"}
{"nick":"christo_m","message":"thats why i decaupled like that in the first place","date":"2016-04-12T15:00:56.741Z","type":"message"}
{"nick":"christo_m","message":"decoupled*","date":"2016-04-12T15:01:01.616Z","type":"message"}
{"nick":"christo_m","message":"i didnt want something that is responsible for generating PDFs to have to worry about SMTP and mailers and crap","date":"2016-04-12T15:01:20.681Z","type":"message"}
{"nick":"lennym","message":"Yup, makes sense","date":"2016-04-12T15:01:31.243Z","type":"message"}
{"nick":"christo_m","message":"i mean yes, i could have abstracted the logic into a module and required it","date":"2016-04-12T15:01:32.407Z","type":"message"}
{"nick":"christo_m","message":"but then id have to have URLs like how you mentioned earlier.","date":"2016-04-12T15:01:40.960Z","type":"message"}
{"nick":"lennym","message":"So continue with that train of thought to its logical conclusion","date":"2016-04-12T15:01:41.419Z","type":"message"}
{"nick":"vincentc_","date":"2016-04-12T15:03:07.013Z","type":"join"}
{"nick":"lennym","message":"christo_m: You absolutely still should abstract your code into modules and require it","date":"2016-04-12T15:03:16.539Z","type":"message"}
{"nick":"lennym","message":"That's orthogonal to urls structure","date":"2016-04-12T15:03:25.504Z","type":"message"}
{"nick":"christo_m","message":"lennym: ill show you what my mailer stuff looks like","date":"2016-04-12T15:03:37.959Z","type":"message"}
{"nick":"christo_m","message":"ya its not great having logic along with my endpoints","date":"2016-04-12T15:03:43.997Z","type":"message"}
{"nick":"lennym","message":"Since all your url structure needs to do is be able to map to some kind of \"do this, and this and not this\"","date":"2016-04-12T15:03:45.402Z","type":"message"}
{"nick":"christo_m","message":"lennym: https://gist.github.com/christomitov/90ab4d2c0ab480ccd0c9d152652c0db8","date":"2016-04-12T15:04:19.302Z","type":"message"}
{"nick":"christo_m","message":"something like this","date":"2016-04-12T15:04:21.360Z","type":"message"}
{"nick":"christo_m","message":"ya i should put that logic into a module","date":"2016-04-12T15:04:28.152Z","type":"message"}
{"nick":"christo_m","message":"sendEmail is the actual function that the url is mapped to","date":"2016-04-12T15:04:44.907Z","type":"message"}
{"nick":"christo_m","message":"its just always an argument with senior devs here who think more modules is something inherently evil.. i dunno","date":"2016-04-12T15:05:03.390Z","type":"message"}
{"nick":"christo_m","message":"id rather save it for later since the logic is short as it is.","date":"2016-04-12T15:05:11.992Z","type":"message"}
{"nick":"lennym","message":"My only advice would to be to try to separate things which \"do an action\" from things that send a response","date":"2016-04-12T15:05:25.622Z","type":"message"}
{"nick":"christo_m","message":"i agree","date":"2016-04-12T15:05:34.306Z","type":"message"}
{"nick":"lennym","message":"So rip this lot out: https://gist.github.com/christomitov/90ab4d2c0ab480ccd0c9d152652c0db8#file-email-js-L52-L66","date":"2016-04-12T15:06:13.695Z","type":"message"}
{"nick":"lennym","message":"And then have a \"send a response\" and \"handle an error\" middlewares at the bottom of your stack","date":"2016-04-12T15:06:32.025Z","type":"message"}
{"nick":"lennym","message":"Everything before that either gets to \"throw\" or write to res.locals with response concerns","date":"2016-04-12T15:06:53.432Z","type":"message"}
{"nick":"lennym","message":"(not actually throw)","date":"2016-04-12T15:07:02.994Z","type":"message"}
{"nick":"christo_m","message":"lennym: wait you dont respond in your methods??","date":"2016-04-12T15:07:30.901Z","type":"message"}
{"nick":"vincentc_","reason":"Ping timeout: 264 seconds","date":"2016-04-12T15:07:40.000Z","type":"quit"}
{"nick":"lennym","message":"Correct.","date":"2016-04-12T15:07:46.047Z","type":"message"}
{"nick":"smokeo","date":"2016-04-12T15:07:51.368Z","type":"join"}
{"nick":"christo_m","message":"... i was thinking more to abstract https://gist.github.com/christomitov/90ab4d2c0ab480ccd0c9d152652c0db8#file-email-js-L5-L37","date":"2016-04-12T15:07:59.941Z","type":"message"}
{"nick":"lennym","message":"It means you can't do anything else with that method","date":"2016-04-12T15:08:01.236Z","type":"message"}
{"nick":"christo_m","message":"lennym: do you have an example project that does this?","date":"2016-04-12T15:08:15.796Z","type":"message"}
{"nick":"lennym","message":"Err....","date":"2016-04-12T15:08:23.729Z","type":"message"}
{"nick":"christo_m","message":"im just used to methods doing one thing.. you send a request to them, they respond.","date":"2016-04-12T15:08:25.872Z","type":"message"}
{"nick":"christo_m","message":"thats it..","date":"2016-04-12T15:08:30.589Z","type":"message"}
{"nick":"noteness","reason":"Ping timeout: 268 seconds","date":"2016-04-12T15:10:25.215Z","type":"quit"}
{"nick":"lennym","message":"So it's a bit abstract (I don't have much publicly available implementation code), but https://github.com/UKHomeOffice/passports-form-controller/blob/master/lib/form.js#L73-L82 is where I create a middleware stack, create a chain of processing methods, with a final method to handle the successful response or an error.","date":"2016-04-12T15:11:27.334Z","type":"message"}
{"nick":"lennym","message":"The idea being that each method in the stack is responsible for exactly one thing, and \"send a response\" is one thing, so you don't get to do other things *and* send a response.","date":"2016-04-12T15:12:05.450Z","type":"message"}
{"nick":"christo_m","message":"ya ive never seen this","date":"2016-04-12T15:12:33.531Z","type":"message"}
{"nick":"christo_m","message":"also im still confused about your middleware because its generically added to the entire app","date":"2016-04-12T15:13:01.211Z","type":"message"}
{"nick":"christo_m","message":"i dont want that middleware going through the whole app..","date":"2016-04-12T15:13:06.833Z","type":"message"}
{"nick":"christo_m","message":"i think seaoftea is right in having a /batch endpoint..","date":"2016-04-12T15:13:15.258Z","type":"message"}
{"nick":"lennym","message":"christo_m: No, I mount the middlewares to a router, which can then be mounted onto any endpoint/url you like","date":"2016-04-12T15:13:53.050Z","type":"message"}
{"nick":"christo_m","message":"ah ok","date":"2016-04-12T15:13:59.351Z","type":"message"}
{"nick":"lennym","message":"christo_m: ROUTER ALL THE THIGNS!","date":"2016-04-12T15:14:01.264Z","type":"message"}
{"nick":"noteness","date":"2016-04-12T15:15:42.336Z","type":"join"}
{"nick":"lennym","message":"In that code I linked, it creates two routers (one for post, one for get) then mounts those onto another router, and exports that. Each have their own middleware pipelines and error handling contexts.","date":"2016-04-12T15:16:05.128Z","type":"message"}
{"nick":"lennym","message":"But it's routers all the way down.","date":"2016-04-12T15:16:10.809Z","type":"message"}
{"nick":"lennym","message":"Because at implementation time, I then create a set of those, and mount them onto another router for the different endpoints","date":"2016-04-12T15:16:49.754Z","type":"message"}
{"nick":"christo_m","message":"2 advanced 4 me","date":"2016-04-12T15:17:10.375Z","type":"message"}
{"nick":"lennym","message":"Basically it lets you catch/handle errors within a particular context. So in a POST context, I don't want to keep processing if a validator throws, so I can catch validation errors at the POST router error handler level, and let other error bubble up","date":"2016-04-12T15:18:17.914Z","type":"message"}
{"nick":"annoymouse","reason":"Quit: Connection closed for inactivity","date":"2016-04-12T15:18:55.741Z","type":"quit"}
{"nick":"lennym","message":"But yeah, it's the kind of thing that starts to make sense after a couple of years of doing stuff \"the wrong way\"","date":"2016-04-12T15:19:11.661Z","type":"message"}
{"nick":"christo_m","message":"i dont know if i agree with letting errors bubble up..","date":"2016-04-12T15:19:27.132Z","type":"message"}
{"nick":"christo_m","message":"they should be caught and dealt with where they occur","date":"2016-04-12T15:19:32.327Z","type":"message"}
{"nick":"christo_m","message":"but thats just me","date":"2016-04-12T15:19:34.133Z","type":"message"}
{"nick":"lennym","message":"It's pretty well analagous to promises in terms of process flow and handling context","date":"2016-04-12T15:19:43.890Z","type":"message"}
{"nick":"lennym","message":"Bascially s/router/promise-chain","date":"2016-04-12T15:19:53.461Z","type":"message"}
{"nick":"lennym","message":"christo_m: Different errors should be handled at different levels though","date":"2016-04-12T15:20:13.660Z","type":"message"}
{"nick":"lennym","message":"christo_m: And some absolutely should be allowed to go unhandled","date":"2016-04-12T15:20:30.565Z","type":"message"}
{"nick":"lennym","message":"christo_m: Sometimes it's better to crash and restart than try to rescue an unknown/unstable application state","date":"2016-04-12T15:21:02.288Z","type":"message"}
{"nick":"christo_m","message":"i guess thats why i think errors should be caught early","date":"2016-04-12T15:22:47.077Z","type":"message"}
{"nick":"lennym","message":"But yeah, most of the time the last thing in the pipe is a global error middleware that just serves a ¯\\_(ツ)_/¯page","date":"2016-04-12T15:22:51.056Z","type":"message"}
{"nick":"christo_m","message":"its hard to have an unknown application state when you're dealing with problems as they're coming up","date":"2016-04-12T15:22:58.013Z","type":"message"}
{"nick":"christo_m","message":"lololo","date":"2016-04-12T15:23:02.190Z","type":"message"}
{"nick":"lpin","date":"2016-04-12T15:23:44.192Z","type":"join"}
{"nick":"bybb","date":"2016-04-12T15:24:57.980Z","type":"join"}
{"nick":"lennym","message":"But there's expected error types and unexpected error types, and then there's \"WHOA!! WTF?\" error types. And at each level the error handler will only catch expected types. And the last type will make your app crash","date":"2016-04-12T15:25:23.067Z","type":"message"}
{"nick":"lennym","message":"(which is fine)","date":"2016-04-12T15:25:28.093Z","type":"message"}
{"nick":"bybb","reason":"Remote host closed the connection","date":"2016-04-12T15:27:45.355Z","type":"quit"}
{"nick":"efco","date":"2016-04-12T15:28:29.207Z","type":"join"}
{"nick":"Gloomy","date":"2016-04-12T15:35:12.709Z","type":"join"}
{"nick":"Gloomy","message":"Hi :-)","date":"2016-04-12T15:35:26.361Z","type":"message"}
{"nick":"Gloomy","message":"If I do res.render(jadeFile, data) where data is a JSON object,","date":"2016-04-12T15:35:46.028Z","type":"message"}
{"nick":"Gloomy","message":"how do I access that object from my jade file?","date":"2016-04-12T15:35:57.213Z","type":"message"}
{"nick":"christo_m","message":"Gloomy: well i dont use jade but isnt it just #{data}","date":"2016-04-12T15:38:05.121Z","type":"message"}
{"nick":"lennym","message":"Gloomy: Have you looked at http://jade-lang.com/tutorial/ ?","date":"2016-04-12T15:39:47.935Z","type":"message"}
{"nick":"Gloomy","message":"That's for a variable? So if I need to access one property of that object I need to do #{data[property]} ? (I'm just getting started with this still a bit confused)","date":"2016-04-12T15:40:28.360Z","type":"message"}
{"nick":"Gloomy","message":"lennym : Probably not deeply enough :-)","date":"2016-04-12T15:41:07.764Z","type":"message"}
{"nick":"lennym","message":"In particular http://jade-lang.com/tutorial/#Javascript","date":"2016-04-12T15:41:36.194Z","type":"message"}
{"nick":"hipsterslapfight","message":"that'd be data.property or data['property'] Gloomy","date":"2016-04-12T15:46:42.514Z","type":"message"}
{"nick":"hipsterslapfight","message":"but again, it depends on the shape of the object and what you're doing with it","date":"2016-04-12T15:46:59.203Z","type":"message"}
