{"nick":"prometh","message":"is it possible to create a db user with knex?","date":"2017-06-21T00:00:04.621Z","type":"message"}
{"nick":"cannap","message":"yes why not","date":"2017-06-21T00:00:17.730Z","type":"message"}
{"nick":"orbyt_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T00:00:46.287Z","type":"quit"}
{"nick":"cannap","message":"the post and get called together when he do a GET request","date":"2017-06-21T00:00:50.608Z","type":"message"}
{"nick":"cannap","message":"post should not be called then","date":"2017-06-21T00:01:07.701Z","type":"message"}
{"nick":"chjj","reason":"Ping timeout: 240 seconds","date":"2017-06-21T00:01:31.794Z","type":"quit"}
{"nick":"cannap","message":"when the problem still happens just rename the post route xD","date":"2017-06-21T00:01:32.540Z","type":"message"}
{"nick":"cannap","message":"maybe app.use('/', index); is a problem","date":"2017-06-21T00:01:57.297Z","type":"message"}
{"nick":"MachinShin","date":"2017-06-21T00:02:12.848Z","type":"join"}
{"nick":"MachinShin","reason":"Changing host","date":"2017-06-21T00:02:12.850Z","type":"quit"}
{"nick":"MachinShin","date":"2017-06-21T00:02:12.852Z","type":"join"}
{"nick":"cannap","message":"because use is everything","date":"2017-06-21T00:02:12.990Z","type":"message"}
{"nick":"jaawerth","message":"the post route isn't triggering on a get unless they're using a bugged version of express. more likely it's a middleware that's getting triggered multiple times as a route is traverrsed, hence my question about which middleware specifically is being invoked more than once","date":"2017-06-21T00:02:14.496Z","type":"message"}
{"nick":"eshlox","reason":"Quit: Connection closed for inactivity","date":"2017-06-21T00:02:24.491Z","type":"quit"}
{"nick":"PhiSyX","date":"2017-06-21T00:02:30.112Z","type":"join"}
{"nick":"cannap","message":"@diegoaguilar, can you comment the app.use'/'..)  thing","date":"2017-06-21T00:02:49.312Z","type":"message"}
{"nick":"Cohedrin_","reason":"Read error: Connection reset by peer","date":"2017-06-21T00:02:53.999Z","type":"quit"}
{"nick":"jaawerth","message":"typically one would only need to invoke validateSession on a parent route and then everything mounted under that route will be behind it","date":"2017-06-21T00:02:55.179Z","type":"message"}
{"nick":"doomhz","date":"2017-06-21T00:02:55.504Z","type":"join"}
{"nick":"cannap","message":"and check both are requested","date":"2017-06-21T00:02:57.615Z","type":"message"}
{"nick":"samsch","reason":"Quit: Leaving","date":"2017-06-21T00:03:26.199Z","type":"quit"}
{"nick":"diegoaguilar","message":"im reading ...","date":"2017-06-21T00:03:31.205Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T00:03:42.193Z","type":"quit"}
{"nick":"diegoaguilar","message":"the call to GET /payments seems to be done twice jaawerth","date":"2017-06-21T00:03:51.164Z","type":"message"}
{"nick":"goodenough","date":"2017-06-21T00:04:00.537Z","type":"join"}
{"nick":"jaawerth","message":"so *all* of the middleware attached to '/' on payments are being invoked more than once?","date":"2017-06-21T00:04:20.126Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T00:04:30.848Z","type":"quit"}
{"nick":"cannap","message":"i think so","date":"2017-06-21T00:04:39.330Z","type":"message"}
{"nick":"cannap","message":"not 100% sure","date":"2017-06-21T00:04:42.887Z","type":"message"}
{"nick":"goodenough","date":"2017-06-21T00:04:45.471Z","type":"join"}
{"nick":"SSoulske","date":"2017-06-21T00:05:43.611Z","type":"join"}
{"nick":"jaawerth","message":"diegoaguilar: are you getting an error about not being able to send again after headers are already sent, or something like that?","date":"2017-06-21T00:05:50.588Z","type":"message"}
{"nick":"diegoaguilar","message":"no, not getting such errs","date":"2017-06-21T00:06:01.929Z","type":"message"}
{"nick":"diegoaguilar","message":"Ill show u what logs look like, ive not tested POST yet","date":"2017-06-21T00:06:12.437Z","type":"message"}
{"nick":"jaawerth","message":"then payments.display probably isn't being invoked more than once, because if it was you'd probably get that error","date":"2017-06-21T00:06:20.923Z","type":"message"}
{"nick":"doomhz","reason":"Ping timeout: 246 seconds","date":"2017-06-21T00:07:31.558Z","type":"quit"}
{"nick":"Cohedrin_","date":"2017-06-21T00:07:40.795Z","type":"join"}
{"nick":"diegoaguilar","message":"https://www.hastebin.com/eyabolaqir.scala","date":"2017-06-21T00:08:25.911Z","type":"message"}
{"nick":"KermitoniT","date":"2017-06-21T00:08:37.284Z","type":"join"}
{"nick":"Xiti","date":"2017-06-21T00:08:40.192Z","type":"join"}
{"nick":"diegoaguilar","message":"it's weird cause there's a single GET /payments which is being dropped?","date":"2017-06-21T00:08:42.298Z","type":"message"}
{"nick":"goodenough","reason":"Ping timeout: 246 seconds","date":"2017-06-21T00:08:55.497Z","type":"quit"}
{"nick":"diegoaguilar","message":"these three lines confuse me:","date":"2017-06-21T00:09:14.664Z","type":"message"}
{"nick":"diegoaguilar","message":"no customer_id","date":"2017-06-21T00:09:15.129Z","type":"message"}
{"nick":"diegoaguilar","message":"GET /payments - - ms - -","date":"2017-06-21T00:09:15.271Z","type":"message"}
{"nick":"diegoaguilar","message":"no customer_id","date":"2017-06-21T00:09:15.273Z","type":"message"}
{"nick":"diegoaguilar","message":"btw, one effect is, two stripe customers created","date":"2017-06-21T00:10:11.112Z","type":"message"}
{"nick":"diegoaguilar","message":"that's how I knew it was being invoked twice","date":"2017-06-21T00:10:20.605Z","type":"message"}
{"nick":"cannap","message":"damn i throught you read about routes","date":"2017-06-21T00:10:24.187Z","type":"message"}
{"nick":"cannap","message":"and not the part where the controller hits the model","date":"2017-06-21T00:10:49.363Z","type":"message"}
{"nick":"cannap","message":"read = talk","date":"2017-06-21T00:11:17.644Z","type":"message"}
{"nick":"f32","message":"jaawerth: you around?","date":"2017-06-21T00:11:26.660Z","type":"message"}
{"nick":"f32","message":"jaawerth: i need some advice on https://pastebin.com/jX3zBuLY","date":"2017-06-21T00:11:33.090Z","type":"message"}
{"nick":"f32","message":"jaawerth: its a question related to node_modules","date":"2017-06-21T00:12:25.419Z","type":"message"}
{"nick":"f32","message":"given this directory structure, i really don't want /node_modules in the root","date":"2017-06-21T00:12:46.006Z","type":"message"}
{"nick":"cannap","message":"no you cant delete the folder on windows with a rightclick :P","date":"2017-06-21T00:12:49.947Z","type":"message"}
{"nick":"jaawerth","message":"diegoaguilar: well, one thing I notice is your validateCustomer middleware is *creating* a customer - that has a lot of potential for causing bugs, plus you generally don't want an action like that to occur on a GET, it violates http semantics","date":"2017-06-21T00:12:53.960Z","type":"message"}
{"nick":"jaawerth","message":"f32: looking now","date":"2017-06-21T00:13:04.381Z","type":"message"}
{"nick":"f32","message":"jaawerth: the key here is that i can compile both app and test with the TS compiler, but i also need to be able to install node_modules into the ./bin","date":"2017-06-21T00:13:31.479Z","type":"message"}
{"nick":"f32","message":"jaawerth: node isn't mandating that node_modules be inside bin for things to work, but its rather unsightly","date":"2017-06-21T00:14:11.463Z","type":"message"}
{"nick":"cannap","message":"symlink?","date":"2017-06-21T00:14:25.174Z","type":"message"}
{"nick":"jaawerth","message":"f32: wait, so you *want* node_modules to be in bin?","date":"2017-06-21T00:14:34.990Z","type":"message"}
{"nick":"f32","message":"jaawerth: yeah","date":"2017-06-21T00:14:38.665Z","type":"message"}
{"nick":"chjj","date":"2017-06-21T00:14:48.746Z","type":"join"}
{"nick":"cannap","message":"\"but why?\"","date":"2017-06-21T00:14:59.225Z","type":"message"}
{"nick":"f32","message":"jaawerth: i want package.json in the root (so i can run npm tasks)","date":"2017-06-21T00:15:01.345Z","type":"message"}
{"nick":"f32","message":"jaawerth: but i want node_modules inside the bin","date":"2017-06-21T00:15:10.691Z","type":"message"}
{"nick":"jaawerth","message":"well, generally the location of node_modules is going to be the location of the first package.json npm finds as it traverses up the tree from the cwd wherever you invoke npm install","date":"2017-06-21T00:15:11.550Z","type":"message"}
{"nick":"f32","message":"jaawerth: can you recommend a better structure ?","date":"2017-06-21T00:15:44.967Z","type":"message"}
{"nick":"gambl0re","date":"2017-06-21T00:15:57.650Z","type":"join"}
{"nick":"jaawerth","message":"so.. why does node_modules need to be in bin?","date":"2017-06-21T00:16:01.592Z","type":"message"}
{"nick":"f32","message":"jaawerth: i want to retain ./src and ./test directories","date":"2017-06-21T00:16:03.064Z","type":"message"}
{"nick":"cannap","message":"you can have outside -> ./src","date":"2017-06-21T00:16:20.309Z","type":"message"}
{"nick":"f32","message":"jaawerth: its pretty gross seeing node_modules in the root","date":"2017-06-21T00:16:23.806Z","type":"message"}
{"nick":"cannap","message":"an in outside is the package.jso","date":"2017-06-21T00:16:25.303Z","type":"message"}
{"nick":"cannap","message":"n","date":"2017-06-21T00:16:25.990Z","type":"message"}
{"nick":"jaawerth","message":"that should just contain your deps anyway and node's module resolution should take care of it for you","date":"2017-06-21T00:16:27.870Z","type":"message"}
{"nick":"diegoksp","reason":"Quit: Leaving","date":"2017-06-21T00:16:32.656Z","type":"quit"}
{"nick":"cannap","message":"and you still work in src","date":"2017-06-21T00:16:37.438Z","type":"message"}
{"nick":"cannap","message":"without the build stuff you need","date":"2017-06-21T00:16:41.768Z","type":"message"}
{"nick":"f32","message":"jaawerth: it works sure, but when building, i want to build to a target directory","date":"2017-06-21T00:16:53.864Z","type":"message"}
{"nick":"f32","message":"so, in this case, bin","date":"2017-06-21T00:17:02.930Z","type":"message"}
{"nick":"cannap","message":"./src/dist","date":"2017-06-21T00:17:10.363Z","type":"message"}
{"nick":"cannap","message":"bin","date":"2017-06-21T00:17:16.114Z","type":"message"}
{"nick":"jaawerth","message":"that's pretty much just how node/npm is built and there's no good way to work around it - if you're building to a dir and the dir is all you want deployed somewhere, you can have a script that copies/moves node_modules to the target dir and all the requires will work as normal","date":"2017-06-21T00:17:54.032Z","type":"message"}
{"nick":"evilqubit","reason":"Read error: Connection reset by peer","date":"2017-06-21T00:18:13.409Z","type":"quit"}
{"nick":"f32","message":"jaawerth: it seems like a lot of extra work to make that happen","date":"2017-06-21T00:18:20.462Z","type":"message"}
{"nick":"jaawerth","message":"f32: what is this - a module? a cli tool?","date":"2017-06-21T00:19:00.113Z","type":"message"}
{"nick":"f32","message":"jaawerth: cli tool","date":"2017-06-21T00:19:09.659Z","type":"message"}
{"nick":"evilqubit","date":"2017-06-21T00:19:13.600Z","type":"join"}
{"nick":"circ-user-Jnmac","reason":"Remote host closed the connection","date":"2017-06-21T00:19:22.386Z","type":"quit"}
{"nick":"SSoulske","reason":"Read error: Connection reset by peer","date":"2017-06-21T00:19:34.786Z","type":"quit"}
{"nick":"ividyon","reason":"Quit: Leaving","date":"2017-06-21T00:19:39.361Z","type":"quit"}
{"nick":"jaawerth","message":"alright, so, what I generally do is just publish the whole thing - I still have a /src and /dist, but the \"bin\" field in package.json will point to /bin or /dist/bin as appropriate (/bin from what you're saying about your structure)","date":"2017-06-21T00:19:57.886Z","type":"message"}
{"nick":"jaawerth","message":"f32: my one comment is that, while I've done it that way before (where compiled stuff is going to more than one dir), it often makes it cleaner if you put every compiled thing in /dist (so /dist/bin)","date":"2017-06-21T00:20:25.854Z","type":"message"}
{"nick":"f32","message":"jaawerth: i still have the same problem tho don't i?","date":"2017-06-21T00:21:08.940Z","type":"message"}
{"nick":"jaawerth","message":"f32: and if you point the \"bin\" field of package.json to foo: ./dist/bin/foo, when you install the cli tool with npm, it will symlink to the right place","date":"2017-06-21T00:21:11.183Z","type":"message"}
{"nick":"jaawerth","message":"node_modules being in the project root?","date":"2017-06-21T00:21:30.225Z","type":"message"}
{"nick":"f32","message":"jaawerth: can you draft a quick post of what you mean","date":"2017-06-21T00:21:34.110Z","type":"message"}
{"nick":"mezod","reason":"Remote host closed the connection","date":"2017-06-21T00:21:44.626Z","type":"quit"}
{"nick":"SSoulske","date":"2017-06-21T00:21:54.848Z","type":"join"}
{"nick":"f32","message":"im open to the idea im working against the grain, im curious how you would approach this","date":"2017-06-21T00:21:59.573Z","type":"message"}
{"nick":"einnjo","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T00:22:06.026Z","type":"quit"}
{"nick":"jaawerth","message":"f32: I might not be following the problem totally... if it's just not liking node_modules being in the project root, IME it's best to just accept that","date":"2017-06-21T00:22:07.922Z","type":"message"}
{"nick":"f32","message":"jaawerth: well, this module isn't for publishing","date":"2017-06-21T00:22:25.367Z","type":"message"}
{"nick":"jaawerth","message":"ah","date":"2017-06-21T00:22:28.591Z","type":"message"}
{"nick":"duderonomy","date":"2017-06-21T00:22:31.636Z","type":"join"}
{"nick":"cannap","message":"private:false in package.json","date":"2017-06-21T00:22:41.770Z","type":"message"}
{"nick":"f32","message":"jaawerth: i need to be able to build it, zip it, and send it somewhere","date":"2017-06-21T00:22:44.003Z","type":"message"}
{"nick":"cannap","message":"true","date":"2017-06-21T00:22:45.725Z","type":"message"}
{"nick":"jaawerth","message":"it'll work the same even if you install from git tho","date":"2017-06-21T00:22:46.769Z","type":"message"}
{"nick":"jaawerth","message":"ah ok","date":"2017-06-21T00:22:50.749Z","type":"message"}
{"nick":"f32","message":"jaawerth: so, i could do a post post build","date":"2017-06-21T00:23:01.896Z","type":"message"}
{"nick":"jaawerth","message":"f32: oh that's right, this is where you compile stuff and sent to a client so they can just run it","date":"2017-06-21T00:23:02.039Z","type":"message"}
{"nick":"f32","message":"<_<","date":"2017-06-21T00:23:03.743Z","type":"message"}
{"nick":"f32","message":"yeah","date":"2017-06-21T00:23:11.145Z","type":"message"}
{"nick":"cannap","message":".npmignore and .gitignore check","date":"2017-06-21T00:23:13.681Z","type":"message"}
{"nick":"orbyt_","date":"2017-06-21T00:23:21.210Z","type":"join"}
{"nick":"cagedwisdom","reason":"Remote host closed the connection","date":"2017-06-21T00:23:22.071Z","type":"quit"}
{"nick":"cannap","message":"or check this https://github.com/zeit/pkg","date":"2017-06-21T00:23:40.796Z","type":"message"}
{"nick":"cannap","message":"but yea i dont understand the current problem","date":"2017-06-21T00:23:57.975Z","type":"message"}
{"nick":"f32","message":"jaawerth: its also a logical divide, the top level code is entirely application level code, all typescript, it doesn't seem right to keep node_modules in the root","date":"2017-06-21T00:24:31.945Z","type":"message"}
{"nick":"jaawerth","message":"f32: since they'll need to run \"npm install\" at some point to get the deps, I would just have a install script that does your desired cleanup. That said, anything /bin points to in dist is going to need node_modules to be resolvable from /dist as well as /bin","date":"2017-06-21T00:24:40.721Z","type":"message"}
{"nick":"f32","message":"jaawerth: yeah, have considered using a task runner","date":"2017-06-21T00:25:13.949Z","type":"message"}
{"nick":"f32","message":"jaawerth: one of the main issues is running tasks from npm","date":"2017-06-21T00:25:29.626Z","type":"message"}
{"nick":"f32","message":"as package.json is mandating its existence in the root","date":"2017-06-21T00:25:55.872Z","type":"message"}
{"nick":"jaawerth","message":"f32: are you familiar with npm scripts?","date":"2017-06-21T00:26:24.313Z","type":"message"}
{"nick":"f32","message":"jaawerth: yeah, im using them atm","date":"2017-06-21T00:26:44.000Z","type":"message"}
{"nick":"f32","message":"(which is part of the problem)","date":"2017-06-21T00:26:49.224Z","type":"message"}
{"nick":"jaawerth","message":"ah ok. well, you COULD have a postinstall script that moves node_modules to /bin, and a preinstall script that moves it back if project root lacks it and /bin has it (to prevent reinstallation of all modules if npm install is run more than once)","date":"2017-06-21T00:27:41.906Z","type":"message"}
{"nick":"jaawerth","message":"it's hacky as hell and makes my skin crawl but for the purposes you need..","date":"2017-06-21T00:27:58.504Z","type":"message"}
{"nick":"cannap","message":"and dont forget to point npm to this folder xD","date":"2017-06-21T00:28:05.954Z","type":"message"}
{"nick":"cannap","message":"jk","date":"2017-06-21T00:28:12.343Z","type":"message"}
{"nick":"cannap","message":"gn8","date":"2017-06-21T00:28:13.526Z","type":"message"}
{"nick":"re1","reason":"Read error: Connection reset by peer","date":"2017-06-21T00:28:35.108Z","type":"quit"}
{"nick":"Cohedrin_","reason":"Read error: Connection reset by peer","date":"2017-06-21T00:29:01.130Z","type":"quit"}
{"nick":"f32","message":"jaawerth: there is a --prefix option","date":"2017-06-21T00:29:03.024Z","type":"message"}
{"nick":"f32","message":"just looking into that","date":"2017-06-21T00:29:10.154Z","type":"message"}
{"nick":"Cohedrin_","date":"2017-06-21T00:30:18.094Z","type":"join"}
{"nick":"jaawerth","message":"I think setting prefix only makes a difference with respect to global installs but I could be wrong","date":"2017-06-21T00:30:18.757Z","type":"message"}
{"nick":"nahtnam","message":"You have to be fucking kidding me","date":"2017-06-21T00:30:50.968Z","type":"message"}
{"nick":"nahtnam","message":"added 49 packages, removed 1242 packages and updated 293 packages in 30.696s","date":"2017-06-21T00:30:51.826Z","type":"message"}
{"nick":"nahtnam","message":"NPM is still removing all of my packages","date":"2017-06-21T00:30:58.817Z","type":"message"}
{"nick":"f32","message":"jaawerth: npm --prefix ./bin .","date":"2017-06-21T00:31:10.690Z","type":"message"}
{"nick":"f32","message":"err","date":"2017-06-21T00:31:17.696Z","type":"message"}
{"nick":"f32","message":"jaawerth: npm --prefix ./bin install .","date":"2017-06-21T00:31:24.997Z","type":"message"}
{"nick":"Soulske","date":"2017-06-21T00:31:26.156Z","type":"join"}
{"nick":"cannap","message":"@natten, npm5?","date":"2017-06-21T00:31:35.290Z","type":"message"}
{"nick":"jaawerth","message":"interesting, if that works I'll have learned something new","date":"2017-06-21T00:31:36.512Z","type":"message"}
{"nick":"nahtnam","message":"cannap: Yep","date":"2017-06-21T00:31:56.629Z","type":"message"}
{"nick":"cannap","message":"first time?","date":"2017-06-21T00:32:17.276Z","type":"message"}
{"nick":"doodadjs","message":"nahtnam: same for me","date":"2017-06-21T00:32:22.735Z","type":"message"}
{"nick":"jaawerth","message":"I was pretty sure prefix only applied to globals when it comes to node_modules","date":"2017-06-21T00:32:27.299Z","type":"message"}
{"nick":"nahtnam","message":"cannap: Nope happens all of the time","date":"2017-06-21T00:32:34.149Z","type":"message"}
{"nick":"nahtnam","message":"its bullshit","date":"2017-06-21T00:32:36.431Z","type":"message"}
{"nick":"nahtnam","message":"how is npm even marked stable","date":"2017-06-21T00:32:41.156Z","type":"message"}
{"nick":"nahtnam","message":"*npm5","date":"2017-06-21T00:32:44.239Z","type":"message"}
{"nick":"cannap","message":"is the app broken?","date":"2017-06-21T00:32:56.043Z","type":"message"}
{"nick":"nahtnam","message":"cannap: Nope","date":"2017-06-21T00:33:00.421Z","type":"message"}
{"nick":"nahtnam","message":"happens everywhere","date":"2017-06-21T00:33:05.388Z","type":"message"}
{"nick":"nahtnam","message":"in my libraries","date":"2017-06-21T00:33:09.460Z","type":"message"}
{"nick":"nahtnam","message":"in my websites","date":"2017-06-21T00:33:16.132Z","type":"message"}
{"nick":"nahtnam","message":"in my electron apps","date":"2017-06-21T00:33:18.733Z","type":"message"}
{"nick":"cannap","message":"maybe it flatten some stuff and its just a display error","date":"2017-06-21T00:33:22.732Z","type":"message"}
{"nick":"nahtnam","message":"rm -rf node_modules package-lock.json && npm install","date":"2017-06-21T00:33:37.786Z","type":"message"}
{"nick":"cannap","message":"or a wrong display number","date":"2017-06-21T00:33:38.499Z","type":"message"}
{"nick":"jaawerth","message":"f32: if the people don't need to be able to browse the actual code, you could always put the project bits in a subfolder and a standalone script or batch file or whatever that just does all the work - that way the dir they *see* is nice and clean","date":"2017-06-21T00:33:42.724Z","type":"message"}
{"nick":"nahtnam","message":"thats literally the norm","date":"2017-06-21T00:33:42.867Z","type":"message"}
{"nick":"nahtnam","message":"cannap: Nope, it actually removes everything","date":"2017-06-21T00:33:49.763Z","type":"message"}
{"nick":"doodadjs","message":"nahtnam: I did write a shell script that `mv node_modules ...`, then did `find . ... -exec mv -n {} ...` to restore them","date":"2017-06-21T00:33:51.398Z","type":"message"}
{"nick":"cannap","message":"but stuff works?","date":"2017-06-21T00:34:00.519Z","type":"message"}
{"nick":"cannap","message":"everything works?","date":"2017-06-21T00:34:10.491Z","type":"message"}
{"nick":"nahtnam","message":"cannap: No it doesnt","date":"2017-06-21T00:34:12.754Z","type":"message"}
{"nick":"jaawerth","message":"f32: better yet, just put all the stuff bin needs in a package.json right in /bin, and have your npm script run it from there","date":"2017-06-21T00:34:16.518Z","type":"message"}
{"nick":"nahtnam","message":"I have to do rm -rf node_modules package-lock.json && npm install","date":"2017-06-21T00:34:18.278Z","type":"message"}
{"nick":"cannap","message":"hm","date":"2017-06-21T00:34:19.034Z","type":"message"}
{"nick":"nahtnam","message":"doodadjs: Can you share the bash script with me?","date":"2017-06-21T00:34:26.313Z","type":"message"}
{"nick":"doodadjs","message":"moment...","date":"2017-06-21T00:34:33.062Z","type":"message"}
{"nick":"f32","message":"jaawerth: the npm --prefix ./bin install , option works great","date":"2017-06-21T00:34:48.903Z","type":"message"}
{"nick":"jaawerth","message":"huh","date":"2017-06-21T00:34:53.089Z","type":"message"}
{"nick":"jaawerth","message":"TIL!","date":"2017-06-21T00:34:54.169Z","type":"message"}
{"nick":"f32","message":"jaawerth: its perfect in fact","date":"2017-06-21T00:35:07.069Z","type":"message"}
{"nick":"jaawerth","message":"that's undocumented, too. nice catch","date":"2017-06-21T00:35:08.529Z","type":"message"}
{"nick":"cannap","message":"or you did not save everything in the package.json","date":"2017-06-21T00:35:09.042Z","type":"message"}
{"nick":"cannap","message":"i dont knoe","date":"2017-06-21T00:35:10.352Z","type":"message"}
{"nick":"cannap","message":"w","date":"2017-06-21T00:35:11.358Z","type":"message"}
{"nick":"cannap","message":"sry cant help i had no problems","date":"2017-06-21T00:35:17.782Z","type":"message"}
{"nick":"SSoulske","reason":"Ping timeout: 268 seconds","date":"2017-06-21T00:35:26.830Z","type":"quit"}
{"nick":"jaawerth","message":"oh, nm. \"If set on the command line, then it forces non-global commands to run in the specified folder.\"","date":"2017-06-21T00:35:34.487Z","type":"message"}
{"nick":"cannap","message":"gn8","date":"2017-06-21T00:35:47.887Z","type":"message"}
{"nick":"cannap","reason":"Quit: Leaving","date":"2017-06-21T00:35:49.654Z","type":"quit"}
{"nick":"doodadjs","message":"nahtnam: It does many thing but...  https://github.com/doodadjs/travis_scripts/blob/master/install.sh#L47-L58","date":"2017-06-21T00:36:03.013Z","type":"message"}
{"nick":"jaawerth","message":"\"non global commands\" includes install, then. Learn something new every day! Makes sense that would be possible I suppose","date":"2017-06-21T00:36:05.652Z","type":"message"}
{"nick":"f32","message":"jaawerth: oh, another reason for this is that the cli tool needs to create local processing directories, so yeah, its unrelated to node_modules, but less mental baggage having to track directories all over the place.","date":"2017-06-21T00:36:21.257Z","type":"message"}
{"nick":"jaawerth","message":"f32: so the only deps are used by /bin? nothing in /dist?","date":"2017-06-21T00:36:28.957Z","type":"message"}
{"nick":"f32","message":"jaawerth: i don't have a /dist at all","date":"2017-06-21T00:36:53.351Z","type":"message"}
{"nick":"f32","message":"i have ./src and ./bin","date":"2017-06-21T00:37:00.605Z","type":"message"}
{"nick":"f32","message":"and ./test","date":"2017-06-21T00:37:04.186Z","type":"message"}
{"nick":"f32","message":"(./src and ./test) -> ./bin","date":"2017-06-21T00:37:17.842Z","type":"message"}
{"nick":"jaawerth","message":"oh... huh. guess I'm at the time of day where my wires are crossing too much","date":"2017-06-21T00:37:27.605Z","type":"message"}
{"nick":"jaawerth","message":"worry to confuse the matter, glad you found a solution","date":"2017-06-21T00:37:55.272Z","type":"message"}
{"nick":"nahtnam","message":"Thanks","date":"2017-06-21T00:38:03.622Z","type":"message"}
{"nick":"f32","message":"jaawerth: im pretty happy with this... except it would be nice to npm install","date":"2017-06-21T00:38:05.903Z","type":"message"}
{"nick":"jaawerth","message":"that's why I was all \"don't fight it\", I thought you had other subfolders that needed to require stuff","date":"2017-06-21T00:38:17.287Z","type":"message"}
{"nick":"f32","message":"jaawerth: is it possible to override npm install in \"scripts\" ?","date":"2017-06-21T00:38:21.900Z","type":"message"}
{"nick":"DeltaHeavy","message":"WhatTheDilly has a hardon for C#","date":"2017-06-21T00:38:57.498Z","type":"message"}
{"nick":"prometh","message":"i can't seem to run createdb with knex:   knex({ client:\"pg\", connection:{ host } }).raw(`createdb ${name}`)","date":"2017-06-21T00:38:59.493Z","type":"message"}
{"nick":"markasoftware","message":"prometh, createdb isn't an sql command?","date":"2017-06-21T00:39:32.349Z","type":"message"}
{"nick":"prometh","message":"markasoftware: oh... it works in psql terminal","date":"2017-06-21T00:39:44.425Z","type":"message"}
{"nick":"markasoftware","message":"psql has some special stuff in it","date":"2017-06-21T00:39:51.418Z","type":"message"}
{"nick":"prometh","message":"how can i create a psql db from js ?","date":"2017-06-21T00:40:16.056Z","type":"message"}
{"nick":"f32","message":"DeltaHeavy: well, C# is a great language afterall","date":"2017-06-21T00:40:38.501Z","type":"message"}
{"nick":"f32","message":"probably the greatest of all the mainstream languages","date":"2017-06-21T00:40:53.795Z","type":"message"}
{"nick":"Cohedrin_","reason":"Read error: Connection reset by peer","date":"2017-06-21T00:41:05.815Z","type":"quit"}
{"nick":"jaawerth","message":"f32: the only way I can think of is with indirection - having some npm script do the npm install invocation for you, thus forcing the --prefix flag","date":"2017-06-21T00:41:06.098Z","type":"message"}
{"nick":"markasoftware","message":"prometh, probably can't do it with knex, knex is for running queries on a database that's already created","date":"2017-06-21T00:41:31.379Z","type":"message"}
{"nick":"DeltaHeavy","message":"Depends on what you're doing","date":"2017-06-21T00:41:43.459Z","type":"message"}
{"nick":"markasoftware","message":"you could try running `createdb whatever` as a system command","date":"2017-06-21T00:41:49.715Z","type":"message"}
{"nick":"f32","message":"jaawerth: haha, soo.. \"install\" : \"npm --prefix ./bin install .\" // infinite loop","date":"2017-06-21T00:41:52.001Z","type":"message"}
{"nick":"roelmonnens","date":"2017-06-21T00:41:59.988Z","type":"join"}
{"nick":"prometh","message":"markasoftware: has to be within psql temrinal, though","date":"2017-06-21T00:42:00.132Z","type":"message"}
{"nick":"jaawerth","message":"yeah it would need a different name lol","date":"2017-06-21T00:42:04.250Z","type":"message"}
{"nick":"m31271n","date":"2017-06-21T00:42:22.172Z","type":"join"}
{"nick":"Cohedrin_","date":"2017-06-21T00:42:36.658Z","type":"join"}
{"nick":"markasoftware","message":"prometh, check this https://github.com/olalonde/pgtools","date":"2017-06-21T00:42:38.123Z","type":"message"}
{"nick":"prometh","message":"markasoftware: i tried that and it requires credentials into the \"postgres\" maintenance db","date":"2017-06-21T00:42:57.945Z","type":"message"}
{"nick":"f32","message":"jaawerth: vscode is slick enough to give me hints of available alternitives, nothing strikes me as useful","date":"2017-06-21T00:43:01.066Z","type":"message"}
{"nick":"myndzi","message":"i mean, isn't it just 'create database'?","date":"2017-06-21T00:43:14.863Z","type":"message"}
{"nick":"prometh","message":"myndzi:  ?","date":"2017-06-21T00:43:24.891Z","type":"message"}
{"nick":"jaawerth","message":"f32: if you can set prefix as an env var and get the same behavior (doubtful since the docs specify as a CLI flag) you might be able to set the appropriate one in a preinstall script.. but you might have it to export it for it to remain set when the install happens","date":"2017-06-21T00:43:26.461Z","type":"message"}
{"nick":"myndzi","message":"https://www.postgresql.org/docs/9.0/static/sql-createdatabase.html","date":"2017-06-21T00:43:28.499Z","type":"message"}
{"nick":"jfhbrook","message":"pg has a cli command called 'createdb'","date":"2017-06-21T00:43:34.207Z","type":"message"}
{"nick":"jfhbrook","message":"that works pretty well","date":"2017-06-21T00:43:37.929Z","type":"message"}
{"nick":"f32","message":"jaawerth: hmm","date":"2017-06-21T00:43:39.355Z","type":"message"}
{"nick":"myndzi","message":"right, but he's not using psql","date":"2017-06-21T00:43:40.822Z","type":"message"}
{"nick":"myndzi","message":"he's using knex","date":"2017-06-21T00:43:41.860Z","type":"message"}
{"nick":"jaawerth","message":"f32: and that would mutate their system environment, probably bad","date":"2017-06-21T00:43:50.988Z","type":"message"}
{"nick":"jfhbrook","message":"using knex to create the db?","date":"2017-06-21T00:43:55.032Z","type":"message"}
{"nick":"brent__","reason":"Remote host closed the connection","date":"2017-06-21T00:43:57.031Z","type":"quit"}
{"nick":"AlexKvazos","reason":"Quit: ZNC 1.6.5 - http://znc.in","date":"2017-06-21T00:44:01.125Z","type":"quit"}
{"nick":"prometh","message":"knex({ client:\"pg\", connection:{ host } }).raw(`createdb ${name}`)","date":"2017-06-21T00:44:04.206Z","type":"message"}
{"nick":"jfhbrook","message":"is there a reason that extra tools for setup are a no-go?","date":"2017-06-21T00:44:06.979Z","type":"message"}
{"nick":"gwoztz","date":"2017-06-21T00:44:15.996Z","type":"join"}
{"nick":"markasoftware","message":"will knex handle CREATE DATABASE?","date":"2017-06-21T00:44:20.986Z","type":"message"}
{"nick":"jfhbrook","message":"for webapps I usually keep db creation and table creates external to the actual app","date":"2017-06-21T00:44:27.225Z","type":"message"}
{"nick":"jaawerth","message":"f32: worth a shot doing it without exporting (or the windows equivalent) to see if it works I guess. Are you having them enter \"npm install\" manually? Because you could always throw it (with --prefix) in a batch file or whatever","date":"2017-06-21T00:44:31.509Z","type":"message"}
{"nick":"jfhbrook","message":"is why I'm a little confused","date":"2017-06-21T00:44:32.793Z","type":"message"}
{"nick":"prometh","message":"jfhbrook: i'm trying to write a setup script","date":"2017-06-21T00:44:37.771Z","type":"message"}
{"nick":"jfhbrook","message":"(note I said usually, I have a case where I create tables on the fly)","date":"2017-06-21T00:44:42.381Z","type":"message"}
{"nick":"myndzi","message":"prometh: just use 'CREATE DATABASE <name>'","date":"2017-06-21T00:44:43.380Z","type":"message"}
{"nick":"prometh","message":"ok","date":"2017-06-21T00:44:47.599Z","type":"message"}
{"nick":"myndzi","message":"note, interpolation is sketchy here","date":"2017-06-21T00:44:49.819Z","type":"message"}
{"nick":"jfhbrook","message":"oh, I use bash for that XD","date":"2017-06-21T00:44:50.536Z","type":"message"}
{"nick":"myndzi","message":"if possible, use 'CREATE DATABASE ?' with a parameterized arg","date":"2017-06-21T00:45:02.942Z","type":"message"}
{"nick":"jaawerth","message":"f32: or even a node scripts that executes the shell command for you if you want it to be cross platform","date":"2017-06-21T00:45:17.758Z","type":"message"}
{"nick":"f32","message":"jaawerth: yeah, manually at this stage","date":"2017-06-21T00:45:17.760Z","type":"message"}
{"nick":"prometh","message":"myndzi: it didn't crash, but it's hanging","date":"2017-06-21T00:45:24.183Z","type":"message"}
{"nick":"myndzi","message":"terminate knex when you're done","date":"2017-06-21T00:45:57.744Z","type":"message"}
{"nick":"prometh","message":"it worked!","date":"2017-06-21T00:46:00.356Z","type":"message"}
{"nick":"prometh","message":"terminate knex?","date":"2017-06-21T00:46:06.238Z","type":"message"}
{"nick":"gwoztz","reason":"Client Quit","date":"2017-06-21T00:46:06.380Z","type":"quit"}
{"nick":"myndzi","message":"knex.destroy()","date":"2017-06-21T00:46:20.277Z","type":"message"}
{"nick":"myndzi","message":"if you don't end your database connection node will stay running","date":"2017-06-21T00:46:30.530Z","type":"message"}
{"nick":"roelmonnens","reason":"Ping timeout: 255 seconds","date":"2017-06-21T00:46:36.982Z","type":"quit"}
{"nick":"prometh","message":"how do i delete a db from psql terminal?","date":"2017-06-21T00:46:54.922Z","type":"message"}
{"nick":"prometh","message":"sorry, really new to dbs","date":"2017-06-21T00:46:59.979Z","type":"message"}
{"nick":"myndzi","message":"drop database","date":"2017-06-21T00:47:12.911Z","type":"message"}
{"nick":"ChALkeR","reason":"Quit: Konversation terminated!","date":"2017-06-21T00:47:28.968Z","type":"quit"}
{"nick":"jaawerth","message":"\"setup.js\" -> require('child_process').execSync('npm install --prefix ./bin') or whatever","date":"2017-06-21T00:47:43.521Z","type":"message"}
{"nick":"jaawerth","message":"f32: ^","date":"2017-06-21T00:47:46.876Z","type":"message"}
{"nick":"ChALkeR","date":"2017-06-21T00:48:19.852Z","type":"join"}
{"nick":"prometh","message":"myndzi: hmm, i get an error... i'm in psql terminal","date":"2017-06-21T00:48:20.971Z","type":"message"}
{"nick":"myndzi","message":"what's the error?","date":"2017-06-21T00:48:31.009Z","type":"message"}
{"nick":"prometh","message":"ERROR:  syntax error at or near \"todo\"","date":"2017-06-21T00:48:36.822Z","type":"message"}
{"nick":"prometh","message":"LINE 1: drop todo;","date":"2017-06-21T00:48:36.963Z","type":"message"}
{"nick":"myndzi","message":"sorry","date":"2017-06-21T00:48:42.349Z","type":"message"}
{"nick":"myndzi","message":"DROP DATABASE <name>;","date":"2017-06-21T00:48:47.307Z","type":"message"}
{"nick":"myndzi","message":"the command is literally 'drop database'","date":"2017-06-21T00:48:53.198Z","type":"message"}
{"nick":"myndzi","message":"(like create database above)","date":"2017-06-21T00:48:57.961Z","type":"message"}
{"nick":"prometh","message":"thank you","date":"2017-06-21T00:49:22.760Z","type":"message"}
{"nick":"devc","date":"2017-06-21T00:49:32.899Z","type":"join"}
{"nick":"prometh","message":"when do i run knex.destroy() ? after each query or at the very end ?","date":"2017-06-21T00:49:34.974Z","type":"message"}
{"nick":"myndzi","message":"when you want your program to exit","date":"2017-06-21T00:49:47.198Z","type":"message"}
{"nick":"myndzi","message":"you won't be able to perform any more queries after you've done that","date":"2017-06-21T00:49:54.556Z","type":"message"}
{"nick":"myndzi","message":"so, not after each query","date":"2017-06-21T00:50:05.976Z","type":"message"}
{"nick":"prometh","message":"cool, thanks.. seems to be working","date":"2017-06-21T00:50:55.314Z","type":"message"}
{"nick":"prometh","message":"how can i create a user/password for that new db?","date":"2017-06-21T00:51:01.066Z","type":"message"}
{"nick":"prometh","message":"something like:   create user batchblue with encrypted password 'batchblue' superuser createrole createdb;","date":"2017-06-21T00:51:37.000Z","type":"message"}
{"nick":"prometh","message":"?","date":"2017-06-21T00:51:37.439Z","type":"message"}
{"nick":"bpmedley","date":"2017-06-21T00:52:41.163Z","type":"join"}
{"nick":"myndzi","message":"i suggest reading up on some postgres basics","date":"2017-06-21T00:53:48.380Z","type":"message"}
{"nick":"deltab","message":"that's a lot of permission","date":"2017-06-21T00:54:37.724Z","type":"message"}
{"nick":"myndzi","message":"this looks like a useful summary about roles and such: https://www.digitalocean.com/community/tutorials/how-to-use-roles-and-manage-grant-permissions-in-postgresql-on-a-vps--2","date":"2017-06-21T00:54:41.716Z","type":"message"}
{"nick":"ChALkeR","reason":"Ping timeout: 276 seconds","date":"2017-06-21T00:55:33.827Z","type":"quit"}
{"nick":"Bajax","message":"So, a package I'm using has a few vital enum(ish) things declared as global variables.  Is there ever a good reason to do this in node?","date":"2017-06-21T00:55:53.651Z","type":"message"}
{"nick":"MachinShin","reason":"Ping timeout: 240 seconds","date":"2017-06-21T00:56:01.769Z","type":"quit"}
{"nick":"myndzi","message":"the postgres docs are pretty decent too, and have examples","date":"2017-06-21T00:56:04.275Z","type":"message"}
{"nick":"deltab","message":"prometh: why so much access?","date":"2017-06-21T00:56:11.271Z","type":"message"}
{"nick":"deltab","message":"Bajax: within a module?","date":"2017-06-21T00:56:26.010Z","type":"message"}
{"nick":"zivester","date":"2017-06-21T00:56:40.305Z","type":"join"}
{"nick":"Bajax","message":"deltab: no.  Everywhere.","date":"2017-06-21T00:56:47.211Z","type":"message"}
{"nick":"prometh","message":"deltab: i'm creating a setup/init script for an app","date":"2017-06-21T00:57:12.701Z","type":"message"}
{"nick":"prometh","message":"deltab: trying to simplify the initial install as much as possible","date":"2017-06-21T00:57:22.522Z","type":"message"}
{"nick":"Bajax","message":"I wouldn't care except it conflicts with a name I'm using everywhere (and is a fairly common word)","date":"2017-06-21T00:57:23.071Z","type":"message"}
{"nick":"sondr3_","reason":"Ping timeout: 255 seconds","date":"2017-06-21T00:58:11.993Z","type":"quit"}
{"nick":"deltab","message":"prometh: does the app need to be able to shut the server down? create users? create databases?","date":"2017-06-21T00:58:15.891Z","type":"message"}
{"nick":"myndzi","message":"Bajax: there's never really a good reason to declare any global things in node","date":"2017-06-21T00:58:26.943Z","type":"message"}
{"nick":"myndzi","message":"especially if it's a published package intended as a dependency","date":"2017-06-21T00:58:59.015Z","type":"message"}
{"nick":"prometh","message":"deltab: the app can create users, yes, but not superusers","date":"2017-06-21T00:58:59.443Z","type":"message"}
{"nick":"Bajax","message":"https://www.npmjs.com/package/infusionsoft-api  It's this.  I'm quickly getting ready to migrate away from it.","date":"2017-06-21T00:59:01.618Z","type":"message"}
{"nick":"deltab","message":"database users?","date":"2017-06-21T00:59:13.059Z","type":"message"}
{"nick":"Soulske","reason":"Ping timeout: 240 seconds","date":"2017-06-21T00:59:31.799Z","type":"quit"}
{"nick":"prometh","message":"deltab: no","date":"2017-06-21T00:59:32.506Z","type":"message"}
{"nick":"Bajax","message":"Just to publicly shame the author here","date":"2017-06-21T00:59:33.342Z","type":"message"}
{"nick":"melvster","reason":"Ping timeout: 255 seconds","date":"2017-06-21T00:59:40.008Z","type":"quit"}
{"nick":"prometh","message":"deltab: i'm just creating the database and users for the app.. one-time setup","date":"2017-06-21T01:00:00.292Z","type":"message"}
{"nick":"myndzi","message":"Bajax: what global variables does it expose?","date":"2017-06-21T01:00:32.308Z","type":"message"}
{"nick":"myndzi","message":"i'm not finding any","date":"2017-06-21T01:00:34.363Z","type":"message"}
{"nick":"deltab","message":"prometh: so you probably don't need to grant so much access (as I presume that command does)","date":"2017-06-21T01:00:35.979Z","type":"message"}
{"nick":"myndzi","message":"(though it does use Q, which is kinda funny these days)","date":"2017-06-21T01:00:41.444Z","type":"message"}
{"nick":"Cabanossi","reason":"Ping timeout: 276 seconds","date":"2017-06-21T01:00:45.890Z","type":"quit"}
{"nick":"prometh","message":"deltab: i don't know what i need.. i'm too new to this","date":"2017-06-21T01:01:03.110Z","type":"message"}
{"nick":"myndzi","message":"you need exactly what commands your application uses and no more","date":"2017-06-21T01:01:28.486Z","type":"message"}
{"nick":"sterns","reason":"Ping timeout: 246 seconds","date":"2017-06-21T01:01:46.541Z","type":"quit"}
{"nick":"Cabanossi","date":"2017-06-21T01:01:49.867Z","type":"join"}
{"nick":"myndzi","message":"you almost certainly never need an automated / application user to do things like create/drop databases","date":"2017-06-21T01:02:00.916Z","type":"message"}
{"nick":"Bajax","message":"myndzi : All the API Table names are public-- Contact, etc.  Infusionsoft is bad, but I thought that anyone forced to use them would have some sympathy","date":"2017-06-21T01:02:06.213Z","type":"message"}
{"nick":"dodobrain","date":"2017-06-21T01:02:13.292Z","type":"join"}
{"nick":"myndzi","message":"not sure what you mean, can you share code?","date":"2017-06-21T01:02:33.893Z","type":"message"}
{"nick":"prometh","message":"myndzi: this is to get the app installed only.. what's wrong with that?","date":"2017-06-21T01:02:48.980Z","type":"message"}
{"nick":"myndzi","message":"they all look to be explicitly exported, i don't see any use of global","date":"2017-06-21T01:02:55.156Z","type":"message"}
{"nick":"myndzi","message":"prometh: you don't need to create a user to get the app installed","date":"2017-06-21T01:03:09.702Z","type":"message"}
{"nick":"myndzi","message":"that is something the user installing it is responsible for doing","date":"2017-06-21T01:03:20.347Z","type":"message"}
{"nick":"prometh","message":"myndzi: the app will need a user/password to run","date":"2017-06-21T01:03:22.498Z","type":"message"}
{"nick":"jaawerth","message":"it's not uncommon for an install process to create a database and a user, with defaults and giving the user an option to choose alternate names for them","date":"2017-06-21T01:03:39.505Z","type":"message"}
{"nick":"myndzi","message":"(besides which, if you have permission to create the user, you're already running in a context with elevated privileges probably)","date":"2017-06-21T01:03:40.781Z","type":"message"}
{"nick":"prometh","message":"myndzi: i'm trying to minimize the effort required to install the app.. all they'll need to do is edit an env file","date":"2017-06-21T01:03:41.530Z","type":"message"}
{"nick":"jaawerth","message":"but unless the app itself needs to be able to create databes or db users on the fly, yeah, you don't need to grant those permissions to any db user","date":"2017-06-21T01:04:00.983Z","type":"message"}
{"nick":"myndzi","message":"prometh: yes, what i'm saying is that the user installing/setting things up is not the same as the user used in running the application","date":"2017-06-21T01:04:03.022Z","type":"message"}
{"nick":"prometh","message":"myndzi: i'm confused","date":"2017-06-21T01:04:21.677Z","type":"message"}
{"nick":"deltab","message":"\"Hi, new apprentice! I'm not sure what you'll need for your job, so take these keys and the safe combination.\"","date":"2017-06-21T01:04:26.403Z","type":"message"}
{"nick":"prometh","message":"i'll push my code","date":"2017-06-21T01:04:27.506Z","type":"message"}
{"nick":"jaawerth","message":"typically you just ask the person running the installation to input db user/pass on the command line or in a config file or whatever","date":"2017-06-21T01:04:37.115Z","type":"message"}
{"nick":"SSoulske","date":"2017-06-21T01:05:04.946Z","type":"join"}
{"nick":"jaawerth","message":"er, the db *superuser* user/pass (or an existing user that can create db's and users)","date":"2017-06-21T01:05:12.148Z","type":"message"}
{"nick":"myndzi","message":"prometh, i'm suggesting that you don't need root access to google's servers to send email on gmail","date":"2017-06-21T01:05:18.222Z","type":"message"}
{"nick":"jaawerth","message":"and probably just hold it in-memory since the app should *only* need it for the initial setup","date":"2017-06-21T01:05:23.056Z","type":"message"}
{"nick":"Bajax","message":"myndzi: I don't know how to make it clearer.  When you include the library, via require('infusionsoft-api');, the global namespace is populated with variables","date":"2017-06-21T01:05:24.769Z","type":"message"}
{"nick":"shoky_","message":"myndzi: https://github.com/bvalosek/infusionsoft-api/blob/52684d83c444d778e8ea4701d492686ba4aa0f66/lib/DataContext.js#L53","date":"2017-06-21T01:05:33.486Z","type":"message"}
{"nick":"apparition","date":"2017-06-21T01:05:58.929Z","type":"join"}
{"nick":"shoky_","message":"myndzi: and you can see they use globals in their example code e.g.  .where(Contact.FirstName, 'Brandon')","date":"2017-06-21T01:05:59.214Z","type":"message"}
{"nick":"prometh","message":"jaawerth: myndzi: the app needs a user/pass to edit the db, and that's stored in an env file... but teh db needs to be created and the user added to that db","date":"2017-06-21T01:06:07.616Z","type":"message"}
{"nick":"Bajax","message":"The guy thinks classes should be Global?  I guess?","date":"2017-06-21T01:06:24.624Z","type":"message"}
{"nick":"Bajax","message":"or \"classes\"","date":"2017-06-21T01:06:29.062Z","type":"message"}
{"nick":"myndzi","message":"Bajax: i was just trying to make sure you were saying what i thought you were saying","date":"2017-06-21T01:06:34.053Z","type":"message"}
{"nick":"myndzi","message":"shoky_: `this` in a node module shouldn't pollute the global namespace","date":"2017-06-21T01:06:45.227Z","type":"message"}
{"nick":"m31271n","reason":"Remote host closed the connection","date":"2017-06-21T01:06:45.371Z","type":"quit"}
{"nick":"jaawerth","message":"Bajax: you can run it using the \"vm\" module and supply an alternate object for it to use as the global object - that way it will pollute that object instead of actual global","date":"2017-06-21T01:06:55.545Z","type":"message"}
{"nick":"myndzi","message":"you have to explicitly use 'global.foo'","date":"2017-06-21T01:06:57.257Z","type":"message"}
{"nick":"m31271n","date":"2017-06-21T01:06:57.543Z","type":"join"}
{"nick":"deltab","message":"prometh: but it doesn't need  superuser createrole createdb","date":"2017-06-21T01:06:58.543Z","type":"message"}
{"nick":"iovoid","message":"Someone has idea of when bind syntax (a::b) will arrive to v8? (and nodejs)","date":"2017-06-21T01:07:04.371Z","type":"message"}
{"nick":"gwoztz","date":"2017-06-21T01:07:09.303Z","type":"join"}
{"nick":"shoky_","message":"myndzi: hm right. then no idea how their example code is supposed to work","date":"2017-06-21T01:07:12.915Z","type":"message"}
{"nick":"myndzi","message":"it's possibly a bad example, but alternately there's some dependency doing this work","date":"2017-06-21T01:07:36.367Z","type":"message"}
{"nick":"myndzi","message":"maybe typedef","date":"2017-06-21T01:07:55.055Z","type":"message"}
{"nick":"Bajax","message":"jaawerth: sounds useful.  I'll check it out.  I'm honestly just kind of outraged.  Even 4 years ago, when node was relatively new, he should know better.","date":"2017-06-21T01:07:57.628Z","type":"message"}
{"nick":"Bajax","message":"should have known","date":"2017-06-21T01:08:07.038Z","type":"message"}
{"nick":"prometh","message":"deltab: i understand taht now","date":"2017-06-21T01:08:12.606Z","type":"message"}
{"nick":"prometh","message":"deltab: i'm not sure what i need... i don't know what \"exactly what i need\" is yet","date":"2017-06-21T01:08:28.030Z","type":"message"}
{"nick":"prometh","message":"what i do know is that my app does not create db users or create databases","date":"2017-06-21T01:08:52.893Z","type":"message"}
{"nick":"AtumT","reason":"Remote host closed the connection","date":"2017-06-21T01:08:56.642Z","type":"quit"}
{"nick":"prometh","message":"i'm too new to dbs to know what that is in the context of roles","date":"2017-06-21T01:09:12.926Z","type":"message"}
{"nick":"jaawerth","message":"iovoid: probably when the proposal reaches stage 3 (behind a v8 flag) or stage 4 (no flags)","date":"2017-06-21T01:09:24.344Z","type":"message"}
{"nick":"jaawerth","message":"iovoid: I think it's still stage 0 so it might be a while","date":"2017-06-21T01:09:35.869Z","type":"message"}
{"nick":"markasoftware","message":"prometh, are you sure you should be creating databases for whatever you're doing?","date":"2017-06-21T01:09:38.452Z","type":"message"}
{"nick":"iovoid","message":"do is in the same stage but already is behind a flag AFAIK","date":"2017-06-21T01:09:46.889Z","type":"message"}
{"nick":"jaawerth","message":"ah then maybe they're not that strict, hehe","date":"2017-06-21T01:09:58.449Z","type":"message"}
{"nick":"prometh","message":"markasoftware: it's an install script","date":"2017-06-21T01:10:05.319Z","type":"message"}
{"nick":"jaawerth","message":"definitely not without a flag 'til stage 4 tho","date":"2017-06-21T01:10:06.891Z","type":"message"}
{"nick":"siba","reason":"Quit: My Mac has gone to sleep. ZZZzzz…","date":"2017-06-21T01:10:07.032Z","type":"quit"}
{"nick":"jaawerth","message":"iovoid: looks like do expressions are in stage 1 now","date":"2017-06-21T01:10:47.730Z","type":"message"}
{"nick":"prometh","message":"https://github.com/stevenvachon/todo-express/blob/master/scripts/createdb.js","date":"2017-06-21T01:12:13.065Z","type":"message"}
{"nick":"Phloxx","reason":"Ping timeout: 258 seconds","date":"2017-06-21T01:12:16.646Z","type":"quit"}
{"nick":"prometh","message":"jaawerth: myndzi: markasoftware: ^","date":"2017-06-21T01:12:23.016Z","type":"message"}
{"nick":"prometh","message":"if interested in what i'm doing","date":"2017-06-21T01:12:27.974Z","type":"message"}
{"nick":"bradfordli123","date":"2017-06-21T01:12:37.883Z","type":"join"}
{"nick":"dka","date":"2017-06-21T01:12:40.674Z","type":"join"}
{"nick":"prometh","message":"see teh readme for the why","date":"2017-06-21T01:13:01.717Z","type":"message"}
{"nick":"dka","message":"I am using rollup to create an ES module. My module depends on tether, which is not a named export. I am using https://github.com/rollup/rollup-plugin-commonjs , should I name my export in the module application or should I name the export in the application where I import my module ?","date":"2017-06-21T01:13:29.673Z","type":"message"}
{"nick":"SSoulske","reason":"Ping timeout: 268 seconds","date":"2017-06-21T01:13:40.848Z","type":"quit"}
{"nick":"jaawerth","message":"prometh: this is more stylistic but I'd suggest using the readline core module or the fancier inquirer lib to prompt for that info if not set","date":"2017-06-21T01:13:46.145Z","type":"message"}
{"nick":"matozoid","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T01:14:18.400Z","type":"quit"}
{"nick":"prometh","message":"jaawerth: i thought about that, but the dev should be familiar with the env file for other things, it hink","date":"2017-06-21T01:14:20.115Z","type":"message"}
{"nick":"prometh","message":"like if google oauth is added, or something","date":"2017-06-21T01:14:32.660Z","type":"message"}
{"nick":"jaawerth","message":"ah yeah if it's targeted at devs then that's different","date":"2017-06-21T01:14:44.437Z","type":"message"}
{"nick":"markasoftware","message":"prometh, is there any chance a bash script would be more appropriate for what you're doing","date":"2017-06-21T01:14:58.806Z","type":"message"}
{"nick":"prometh","message":"i'm just abstracting the db setup because i'm not a db guy","date":"2017-06-21T01:15:00.709Z","type":"message"}
{"nick":"prometh","message":"markasoftware: windows","date":"2017-06-21T01:15:06.564Z","type":"message"}
{"nick":"jaawerth","message":"even so, I like prompting and generating a .env if none is present. Saves an annoying step if you need to quickly grab and run something","date":"2017-06-21T01:15:15.888Z","type":"message"}
{"nick":"Phloxx","date":"2017-06-21T01:15:23.910Z","type":"join"}
{"nick":"prometh","message":"jaawerth: cool... i might do that then... i like inquirer","date":"2017-06-21T01:15:29.779Z","type":"message"}
{"nick":"myndzi","message":"it does seem to be typedef's fault","date":"2017-06-21T01:16:12.766Z","type":"message"}
{"nick":"myndzi","message":"its purported purpose is literally to do this sort of thing, though i can't quite spot the code responsible just yt","date":"2017-06-21T01:16:29.934Z","type":"message"}
{"nick":"ChALkeR","date":"2017-06-21T01:17:07.897Z","type":"join"}
{"nick":"deltab","message":"prometh: you should give the app as little access as you can; so that if it has a bug, or gets taken over by an attacker, it can't go dropping tables, or creating files, or loading extension code, or whatever","date":"2017-06-21T01:17:18.011Z","type":"message"}
{"nick":"nitric","reason":"Ping timeout: 240 seconds","date":"2017-06-21T01:17:31.775Z","type":"quit"}
{"nick":"prometh","message":"deltab: cool","date":"2017-06-21T01:17:33.670Z","type":"message"}
{"nick":"sterns","date":"2017-06-21T01:17:34.097Z","type":"join"}
{"nick":"jorji","date":"2017-06-21T01:17:46.922Z","type":"join"}
{"nick":"jaawerth","message":"prometh: btw, less of a big deal for an init script but instead of using template strings I'd probably use bindings: knex.raw('CREATE DATABASE ??', dbname)","date":"2017-06-21T01:19:44.616Z","type":"message"}
{"nick":"ed209","reason":"Remote host closed the connection","date":"2017-06-21T01:20:00.760Z","type":"quit"}
{"nick":"prometh","message":"why?","date":"2017-06-21T01:20:02.994Z","type":"message"}
{"nick":"ed209","date":"2017-06-21T01:20:07.890Z","type":"join"}
{"nick":"jaawerth","message":"prevents bobby tables","date":"2017-06-21T01:20:13.045Z","type":"message"}
{"nick":"prometh","message":"what's that?","date":"2017-06-21T01:20:18.179Z","type":"message"}
{"nick":"myndzi","message":"a reference to sql injection","date":"2017-06-21T01:20:35.093Z","type":"message"}
{"nick":"prometh","message":"how could that happen?","date":"2017-06-21T01:20:43.051Z","type":"message"}
{"nick":"myndzi","message":"user-supplied data interpolated into an sql string is dangerous","date":"2017-06-21T01:20:43.251Z","type":"message"}
{"nick":"prometh","message":"ohh","date":"2017-06-21T01:20:48.572Z","type":"message"}
{"nick":"jaawerth","message":"prometh: http://bobby-tables.com/","date":"2017-06-21T01:20:48.612Z","type":"message"}
{"nick":"myndzi","message":"you should as a matter of course not ever do that","date":"2017-06-21T01:20:54.204Z","type":"message"}
{"nick":"prometh","message":"lol","date":"2017-06-21T01:21:12.161Z","type":"message"}
{"nick":"jaawerth","message":"this is just an init script but better to just never do it","date":"2017-06-21T01:21:13.174Z","type":"message"}
{"nick":"prometh","message":"got it","date":"2017-06-21T01:21:18.372Z","type":"message"}
{"nick":"goodenough","date":"2017-06-21T01:21:39.904Z","type":"join"}
{"nick":"jaawerth","message":"prometh: for how bindings work, see http://knexjs.org/#Raw-Bindings","date":"2017-06-21T01:21:53.602Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:22:08.399Z","type":"quit"}
{"nick":"goodenough","date":"2017-06-21T01:22:25.945Z","type":"join"}
{"nick":"jaawerth","message":"? binds to values, ?? binds to identifiers (so ?? in this case, since db name is an identifier)","date":"2017-06-21T01:22:26.801Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:22:55.325Z","type":"quit"}
{"nick":"ChALkeR","reason":"Ping timeout: 255 seconds","date":"2017-06-21T01:23:01.968Z","type":"quit"}
{"nick":"goodenough","date":"2017-06-21T01:23:13.984Z","type":"join"}
{"nick":"prometh","message":"ah, was just about to ask","date":"2017-06-21T01:23:14.841Z","type":"message"}
{"nick":"myndzi","message":"....huh","date":"2017-06-21T01:23:19.415Z","type":"message"}
{"nick":"prometh","message":"(if i should use \"?\" instead)","date":"2017-06-21T01:23:25.257Z","type":"message"}
{"nick":"myndzi","message":"so apparently","date":"2017-06-21T01:23:26.258Z","type":"message"}
{"nick":"myndzi","message":"foo = 'bar';","date":"2017-06-21T01:23:34.414Z","type":"message"}
{"nick":"myndzi","message":"in a node module","date":"2017-06-21T01:23:40.051Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:23:42.449Z","type":"quit"}
{"nick":"myndzi","message":"is globally scoped","date":"2017-06-21T01:23:43.651Z","type":"message"}
{"nick":"prometh","message":"that's a leak, yes","date":"2017-06-21T01:23:56.171Z","type":"message"}
{"nick":"goodenough","date":"2017-06-21T01:23:57.832Z","type":"join"}
{"nick":"jaawerth","message":"if you aren't using strict mode, then undeclared assignments hit global scope","date":"2017-06-21T01:24:00.571Z","type":"message"}
{"nick":"jaawerth","message":"(you should use strict mode)","date":"2017-06-21T01:24:09.845Z","type":"message"}
{"nick":"myndzi","message":"yeah, whereas 'this.Foo' is not","date":"2017-06-21T01:24:10.273Z","type":"message"}
{"nick":"myndzi","message":"i always use strict mode","date":"2017-06-21T01:24:14.263Z","type":"message"}
{"nick":"prometh","message":"this refers to teh IIFE","date":"2017-06-21T01:24:27.167Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:24:29.459Z","type":"quit"}
{"nick":"myndzi","message":"i had thought that wasn't actually the case for some reason","date":"2017-06-21T01:24:31.933Z","type":"message"}
{"nick":"goodenough","date":"2017-06-21T01:24:47.852Z","type":"join"}
{"nick":"myndzi","message":"that is, i thought 'foo = 1' would have the same effect in non-strict mode as 'this.foo = 1'","date":"2017-06-21T01:24:53.524Z","type":"message"}
{"nick":"prometh","message":"that was never the case ;)","date":"2017-06-21T01:25:04.792Z","type":"message"}
{"nick":"jaawerth","message":"yeah - you need to use strict mode in every module","date":"2017-06-21T01:25:10.515Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:25:16.553Z","type":"quit"}
{"nick":"jaawerth","message":"(unless you're using ES syntax, in which it's implied)","date":"2017-06-21T01:25:17.837Z","type":"message"}
{"nick":"myndzi","message":"so basically this is all it takes: https://github.com/bvalosek/infusionsoft-api/blob/master/infusionsoft/tables/Contact.js#L1","date":"2017-06-21T01:25:25.247Z","type":"message"}
{"nick":"goodenough","date":"2017-06-21T01:25:32.844Z","type":"join"}
{"nick":"myndzi","message":"til","date":"2017-06-21T01:25:36.549Z","type":"message"}
{"nick":"jaawerth","message":"there's a babel plugin that will inject it into everything, plus an eslint rule that can yell at you about it and even fix it for you","date":"2017-06-21T01:25:36.550Z","type":"message"}
{"nick":"myndzi","message":"guess i never needed to know though since i've written every node script pretty much that i ever wrote with strict mode","date":"2017-06-21T01:25:49.735Z","type":"message"}
{"nick":"jaawerth","message":"ah","date":"2017-06-21T01:25:59.733Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:26:03.410Z","type":"quit"}
{"nick":"goodenough","date":"2017-06-21T01:26:18.549Z","type":"join"}
{"nick":"prometh","message":"it's ok, i don't know how to read machine code","date":"2017-06-21T01:26:26.759Z","type":"message"}
{"nick":"prometh","message":"we can't know everything","date":"2017-06-21T01:26:36.638Z","type":"message"}
{"nick":"myndzi","message":"we can try :)","date":"2017-06-21T01:26:42.383Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:26:50.484Z","type":"quit"}
{"nick":"goodenough","date":"2017-06-21T01:27:05.609Z","type":"join"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:27:37.538Z","type":"quit"}
{"nick":"goodenough","date":"2017-06-21T01:27:51.616Z","type":"join"}
{"nick":"mr-foobar","reason":"Ping timeout: 268 seconds","date":"2017-06-21T01:27:51.903Z","type":"quit"}
{"nick":"prometh","message":"and i always fail","date":"2017-06-21T01:28:05.664Z","type":"message"}
{"nick":"myndzi","message":"anyway @ Bajax, the vm trick is sneaky and seems good","date":"2017-06-21T01:28:10.258Z","type":"message"}
{"nick":"goodenough","reason":"Remote host closed the connection","date":"2017-06-21T01:28:24.557Z","type":"quit"}
{"nick":"goodenough","date":"2017-06-21T01:28:52.721Z","type":"join"}
{"nick":"Cabanossi","reason":"Ping timeout: 246 seconds","date":"2017-06-21T01:30:14.581Z","type":"quit"}
{"nick":"mr-foobar","date":"2017-06-21T01:30:36.918Z","type":"join"}
{"nick":"Janhouse","reason":"Remote host closed the connection","date":"2017-06-21T01:30:51.421Z","type":"quit"}
{"nick":"Cabanossi","date":"2017-06-21T01:31:43.578Z","type":"join"}
{"nick":"e14_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T01:33:01.043Z","type":"quit"}
{"nick":"emesde","reason":"Quit: WeeChat 1.4","date":"2017-06-21T01:33:25.415Z","type":"quit"}
{"nick":"zsoc","message":"Does anyone have a reference to a good argument for why a package that is created exclusively to be used in a node environment should not be using `import` syntax? Like... it's being transpiled ofc and all that but I feel like there are just too many downsides even if 'properly' babel/rollup'ing it","date":"2017-06-21T01:35:55.379Z","type":"message"}
{"nick":"joshontheweb","date":"2017-06-21T01:36:04.290Z","type":"join"}
{"nick":"jorji","reason":"Ping timeout: 268 seconds","date":"2017-06-21T01:36:29.880Z","type":"quit"}
{"nick":"ljharb","message":"zsoc: because node doesn't use it.","date":"2017-06-21T01:36:45.319Z","type":"message"}
{"nick":"ljharb","message":"zsoc: nothing should ever be published with anything but ES5 right now.","date":"2017-06-21T01:36:53.515Z","type":"message"}
{"nick":"zsoc","message":"Right, but what do you mean by 'published' here?","date":"2017-06-21T01:37:15.132Z","type":"message"}
{"nick":"zsoc","message":"Obv the published-to-npm stuff is es5","date":"2017-06-21T01:37:25.422Z","type":"message"}
{"nick":"ljharb","message":"oh you're asking about like, within the raw source code for a transpiled package","date":"2017-06-21T01:37:39.682Z","type":"message"}
{"nick":"zsoc","message":"Something more toward.. gaining and maintaining community support heh","date":"2017-06-21T01:37:39.967Z","type":"message"}
{"nick":"zsoc","message":"yeah","date":"2017-06-21T01:37:43.289Z","type":"message"}
{"nick":"ljharb","message":"zsoc: if it's not a top-level app, it doesn't matter either way except that you'll have to fix your code whenever ESM lands in node.","date":"2017-06-21T01:37:57.342Z","type":"message"}
{"nick":"zsoc","message":"Maybe there isn't a great argument.. it's going to be transpiled for other reasons anyway, it's def not just that","date":"2017-06-21T01:37:59.689Z","type":"message"}
{"nick":"ljharb","message":"zsoc: all the bundling benefits are irrelevant if it's not a top-level app.","date":"2017-06-21T01:38:05.058Z","type":"message"}
{"nick":"zsoc","message":"right there's certainly no benefit, I don't think they believe there is","date":"2017-06-21T01:38:19.147Z","type":"message"}
{"nick":"zsoc","message":"i think it was just one of those decisions made initially and never checked on... i'll open a meta issue i guess","date":"2017-06-21T01:38:31.763Z","type":"message"}
{"nick":"Janhouse","date":"2017-06-21T01:38:33.908Z","type":"join"}
{"nick":"netameta","reason":"Read error: Connection reset by peer","date":"2017-06-21T01:39:00.411Z","type":"quit"}
{"nick":"netameta","date":"2017-06-21T01:39:17.072Z","type":"join"}
{"nick":"zsoc","message":"ljharb: speaking of which.. what's the current state of \"which side breaks\" when esm lands? those transpiling now will have to continue to transpile, basically.. and those using require should \"just work\"? Either with some hybrid loader or because of mjs?","date":"2017-06-21T01:39:53.272Z","type":"message"}
{"nick":"brent__","date":"2017-06-21T01:40:12.949Z","type":"join"}
{"nick":"brent__","reason":"Ping timeout: 240 seconds","date":"2017-06-21T01:44:30.481Z","type":"quit"}
{"nick":"prometh","message":"should i use upper case for my sql ?","date":"2017-06-21T01:46:21.182Z","type":"message"}
{"nick":"prometh","message":"it doesn't seem to affect anything, but what's common ?","date":"2017-06-21T01:46:41.365Z","type":"message"}
{"nick":"zsoc","message":"i say no","date":"2017-06-21T01:46:50.127Z","type":"message"}
{"nick":"zsoc","message":"it doesn't affect anything *in knex*... with actual sql, uppercase letters in any identifiers cause you to use double quore","date":"2017-06-21T01:47:10.963Z","type":"message"}
{"nick":"zsoc","message":"*quotes","date":"2017-06-21T01:47:12.668Z","type":"message"}
{"nick":"prometh","message":"weird","date":"2017-06-21T01:47:31.102Z","type":"message"}
{"nick":"myndzi","message":"(knex adds quotes for you)","date":"2017-06-21T01:47:45.257Z","type":"message"}
{"nick":"zsoc","message":"so... `select \"Foo\".\"someField\" from \"Foo\"` vs `select foo.somefield from foo`","date":"2017-06-21T01:47:46.303Z","type":"message"}
{"nick":"zsoc","message":"never having to remember to user them or not to use them is just.. really nice. That and snake case is honestly the 'norm' anyway for sql","date":"2017-06-21T01:48:04.633Z","type":"message"}
{"nick":"myndzi","message":"^","date":"2017-06-21T01:48:16.011Z","type":"message"}
{"nick":"zsoc","message":"*use","date":"2017-06-21T01:48:21.123Z","type":"message"}
{"nick":"prometh","message":"thanks","date":"2017-06-21T01:48:26.006Z","type":"message"}
{"nick":"myndzi","message":"it'll be much less confusing in other contexts","date":"2017-06-21T01:48:26.691Z","type":"message"}
{"nick":"zsoc","action":"says something that makes sense every once in awhile..","date":"2017-06-21T01:48:28.496Z","type":"action"}
{"nick":"Guest86697","new_nick":"konobi","date":"2017-06-21T01:48:39.006Z","type":"nick"}
{"nick":"philm88","reason":"Ping timeout: 255 seconds","date":"2017-06-21T01:50:04.039Z","type":"quit"}
{"nick":"leptone","reason":"Remote host closed the connection","date":"2017-06-21T01:52:18.651Z","type":"quit"}
{"nick":"MachinShin","date":"2017-06-21T01:52:54.778Z","type":"join"}
{"nick":"MachinShin","reason":"Changing host","date":"2017-06-21T01:52:54.779Z","type":"quit"}
{"nick":"MachinShin","date":"2017-06-21T01:52:54.781Z","type":"join"}
{"nick":"prometh","message":"create user batchblue with encrypted password 'batchblue'","date":"2017-06-21T01:53:42.132Z","type":"message"}
{"nick":"prometh","message":"can that password be double quotes?","date":"2017-06-21T01:53:48.413Z","type":"message"}
{"nick":"zsoc","message":"you ... don't quote or double quote passwords.. or hashes.. as they will be bindings","date":"2017-06-21T01:54:11.002Z","type":"message"}
{"nick":"prometh","message":"oh","date":"2017-06-21T01:54:24.818Z","type":"message"}
{"nick":"prometh","message":"is that a knex thing?","date":"2017-06-21T01:54:27.591Z","type":"message"}
{"nick":"zsoc","message":"what? no that's a sql injection thing","date":"2017-06-21T01:54:36.702Z","type":"message"}
{"nick":"prometh","message":"ok","date":"2017-06-21T01:54:40.083Z","type":"message"}
{"nick":"cads2","date":"2017-06-21T01:54:41.983Z","type":"join"}
{"nick":"zsoc","message":"knex you would prepare the object and just knex('users').insert(userObj)","date":"2017-06-21T01:54:50.672Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user :user: with encrypted password :password:\", { password, user }))","date":"2017-06-21T01:55:08.887Z","type":"message"}
{"nick":"zsoc","message":"where userObj looks like { username: 'foo', passwordHash: '8sjdf892j3r8jdsf' } or whatever","date":"2017-06-21T01:55:11.275Z","type":"message"}
{"nick":"prometh","message":"hm","date":"2017-06-21T01:55:16.559Z","type":"message"}
{"nick":"zsoc","message":"wat","date":"2017-06-21T01:55:20.302Z","type":"message"}
{"nick":"zsoc","message":"i don't recognize that syntax, it might work tho who knows","date":"2017-06-21T01:55:26.822Z","type":"message"}
{"nick":"prometh","message":"i'm creating a db user","date":"2017-06-21T01:55:32.934Z","type":"message"}
{"nick":"zsoc","message":"what is 'create'?","date":"2017-06-21T01:55:34.063Z","type":"message"}
{"nick":"zsoc","message":"ohhhh","date":"2017-06-21T01:55:34.954Z","type":"message"}
{"nick":"asdasda","date":"2017-06-21T01:55:38.729Z","type":"join"}
{"nick":"zsoc","message":"psql","date":"2017-06-21T01:55:39.442Z","type":"message"}
{"nick":"prometh","message":"psql = knex({ client:\"pg\", connection:{ host } });","date":"2017-06-21T01:55:51.580Z","type":"message"}
{"nick":"zsoc","message":"jebus, yeah i have no idea what the programmatic syntax for that is","date":"2017-06-21T01:55:54.240Z","type":"message"}
{"nick":"TheFuzzball","reason":"Quit: Computer has gone to sleep.","date":"2017-06-21T01:56:16.734Z","type":"quit"}
{"nick":"zsoc","message":"I'm surprised it isn't just raw(`create user ? with encrypted password ?`, [ user, password ])","date":"2017-06-21T01:56:23.692Z","type":"message"}
{"nick":"prometh","message":"oh, i wasn't sure if i could use multiple ?'s","date":"2017-06-21T01:56:39.426Z","type":"message"}
{"nick":"zsoc","message":"oh, then it is lol","date":"2017-06-21T01:56:41.173Z","type":"message"}
{"nick":"leptone","date":"2017-06-21T01:56:44.637Z","type":"join"}
{"nick":"zsoc","message":"yeah, you can also use $1, $2 etc to reuse them","date":"2017-06-21T01:56:49.547Z","type":"message"}
{"nick":"zsoc","message":"also that's just `pg` syntax that is passed through with .raw","date":"2017-06-21T01:56:57.435Z","type":"message"}
{"nick":"myndzi","message":"database users != application users","date":"2017-06-21T01:57:08.632Z","type":"message"}
{"nick":"prometh","message":"what's preferred?","date":"2017-06-21T01:57:11.140Z","type":"message"}
{"nick":"deltab","message":"it might not accept a quoted string for the name","date":"2017-06-21T01:57:15.374Z","type":"message"}
{"nick":"MachinShin","reason":"Ping timeout: 268 seconds","date":"2017-06-21T01:57:27.826Z","type":"quit"}
{"nick":"zsoc","message":"you could test that easily enough","date":"2017-06-21T01:57:36.109Z","type":"message"}
{"nick":"myndzi","message":"slowpoke.jpg","date":"2017-06-21T01:57:40.306Z","type":"message"}
{"nick":"zsoc","message":":p","date":"2017-06-21T01:57:50.524Z","type":"message"}
{"nick":"prometh","action":"doesn't get that joke","date":"2017-06-21T01:58:07.097Z","type":"action"}
{"nick":"prometh","message":"must be for sql experts :)","date":"2017-06-21T01:58:12.693Z","type":"message"}
{"nick":"myndzi","message":"http://i0.kym-cdn.com/entries/icons/facebook/000/000/128/slowpoke_pokemon.jpg","date":"2017-06-21T01:58:32.709Z","type":"message"}
{"nick":"prometh","message":"oh, hmm","date":"2017-06-21T01:58:39.119Z","type":"message"}
{"nick":"prometh","message":"i was picturing a slow rider","date":"2017-06-21T01:58:46.648Z","type":"message"}
{"nick":"myndzi","message":"hehe","date":"2017-06-21T01:59:04.390Z","type":"message"}
{"nick":"smccarthy","reason":"Remote host closed the connection","date":"2017-06-21T01:59:20.070Z","type":"quit"}
{"nick":"smccarthy","date":"2017-06-21T01:59:54.846Z","type":"join"}
{"nick":"zsoc","message":"hey guys.. did you hear...","date":"2017-06-21T02:00:10.182Z","type":"message"}
{"nick":"prometh","message":"error: syntax error at or near \"$1\"","date":"2017-06-21T02:00:25.786Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user ? with encrypted password ?\", [user, password]))","date":"2017-06-21T02:00:42.173Z","type":"message"}
{"nick":"iczero","message":"zsoc: wat","date":"2017-06-21T02:00:51.570Z","type":"message"}
{"nick":"zsoc","message":"iczero: i was just starting a slowpoke meme joke, too sleep deprived to finish it :p","date":"2017-06-21T02:01:12.931Z","type":"message"}
{"nick":"iczero","message":"lmao","date":"2017-06-21T02:01:19.424Z","type":"message"}
{"nick":"prometh","message":"har har","date":"2017-06-21T02:01:20.915Z","type":"message"}
{"nick":"zsoc","message":"prometh: that error stack should contain the interpolated bindings","date":"2017-06-21T02:01:36.497Z","type":"message"}
{"nick":"zsoc","message":"like what 'user' was there, at runtime","date":"2017-06-21T02:01:46.308Z","type":"message"}
{"nick":"leptone","reason":"Remote host closed the connection","date":"2017-06-21T02:01:51.178Z","type":"quit"}
{"nick":"e14","date":"2017-06-21T02:02:03.519Z","type":"join"}
{"nick":"prometh","message":"nope","date":"2017-06-21T02:02:06.406Z","type":"message"}
{"nick":"zsoc","message":"well.. it does somewhere, it's in the query which is dropped into the error stack :p , any time i've ever seen anyhow","date":"2017-06-21T02:02:24.633Z","type":"message"}
{"nick":"zsoc","message":"but try ?? l ike deltab said","date":"2017-06-21T02:02:30.598Z","type":"message"}
{"nick":"zsoc","message":"i dunno how it's going to work in that situation with a 'create' command","date":"2017-06-21T02:02:37.809Z","type":"message"}
{"nick":"prometh","message":"oh, right, cuz it's not a value","date":"2017-06-21T02:03:01.563Z","type":"message"}
{"nick":"zsoc","message":"yeah, sounds right","date":"2017-06-21T02:03:10.990Z","type":"message"}
{"nick":"zsoc","message":"so ?? on the first and ? on the second should be fine","date":"2017-06-21T02:03:18.006Z","type":"message"}
{"nick":"prometh","message":"error: syntax error at or near \"\"todo\"\"","date":"2017-06-21T02:03:22.758Z","type":"message"}
{"nick":"prometh","message":"oh","date":"2017-06-21T02:03:25.613Z","type":"message"}
{"nick":"prometh","message":"why ? for the second ?","date":"2017-06-21T02:03:29.217Z","type":"message"}
{"nick":"zsoc","message":"because ? is ' ' and ?? is \" \" ? I think anyway","date":"2017-06-21T02:03:42.505Z","type":"message"}
{"nick":"zsoc","action":"is not the master of sql","date":"2017-06-21T02:03:46.595Z","type":"action"}
{"nick":"AlexKvazos","date":"2017-06-21T02:03:50.209Z","type":"join"}
{"nick":"doomhz","date":"2017-06-21T02:03:50.921Z","type":"join"}
{"nick":"prometh","message":"error: syntax error at or near \"$1\"","date":"2017-06-21T02:04:05.682Z","type":"message"}
{"nick":"zsoc","message":"?? is an identifier, ? is like a value","date":"2017-06-21T02:04:08.322Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user ?? with encrypted password ?\", [user, password]))","date":"2017-06-21T02:04:35.138Z","type":"message"}
{"nick":"smccarthy","reason":"Ping timeout: 268 seconds","date":"2017-06-21T02:04:51.831Z","type":"quit"}
{"nick":"zsoc","message":"so that is correct","date":"2017-06-21T02:04:54.477Z","type":"message"}
{"nick":"kerigan","date":"2017-06-21T02:04:58.785Z","type":"join"}
{"nick":"prometh","message":"maybe cuz it's an array?","date":"2017-06-21T02:05:01.661Z","type":"message"}
{"nick":"zsoc","message":"what's an array?","date":"2017-06-21T02:05:07.670Z","type":"message"}
{"nick":"prometh","message":"[user,password]","date":"2017-06-21T02:05:11.865Z","type":"message"}
{"nick":"zsoc","message":"the bindings are supposed to be an array","date":"2017-06-21T02:05:12.902Z","type":"message"}
{"nick":"prometh","message":"ok","date":"2017-06-21T02:05:15.022Z","type":"message"}
{"nick":"zsoc","message":"what about the values of 'user' and 'password' here? I assume they are strings and not null or undefined :p","date":"2017-06-21T02:05:32.638Z","type":"message"}
{"nick":"belmoussaoui","date":"2017-06-21T02:05:43.215Z","type":"join"}
{"nick":"prometh","message":"yep, both are \"todo\"","date":"2017-06-21T02:06:00.589Z","type":"message"}
{"nick":"zsoc","message":"i wonder if there's a security thing about that heh","date":"2017-06-21T02:06:37.836Z","type":"message"}
{"nick":"zsoc","message":"can you gist the stack","date":"2017-06-21T02:07:19.358Z","type":"message"}
{"nick":"zsoc","message":"not for the stack but because the error actually should include the whole query object :p","date":"2017-06-21T02:07:32.386Z","type":"message"}
{"nick":"prometh","message":"-error: syntax error at or near \"todo\"","date":"2017-06-21T02:07:57.143Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user todo with encrypted password todo\"))","date":"2017-06-21T02:08:03.575Z","type":"message"}
{"nick":"zsoc","message":"that's not the whole error... uhhhhh can you turn on debug: true;","date":"2017-06-21T02:08:16.141Z","type":"message"}
{"nick":"zsoc","message":"in the config you set here on knex","date":"2017-06-21T02:08:23.816Z","type":"message"}
{"nick":"doomhz","reason":"Ping timeout: 255 seconds","date":"2017-06-21T02:08:29.048Z","type":"quit"}
{"nick":"zsoc","message":"well that def won't work","date":"2017-06-21T02:08:48.023Z","type":"message"}
{"nick":"acidjazz","message":"does anyone here work with the AWS SDK for node? and potentially S3 buckets?","date":"2017-06-21T02:09:08.561Z","type":"message"}
{"nick":"zsoc","message":"you have to pretty much always use backticks when you want raw strings because otherwise you can't use \"\" and '' heh","date":"2017-06-21T02:09:09.636Z","type":"message"}
{"nick":"zsoc","message":"`create user \"todo\" with encrypted password 'todo'`","date":"2017-06-21T02:09:19.030Z","type":"message"}
{"nick":"prometh","message":"https://pastebin.com/7MQKagsF","date":"2017-06-21T02:09:30.951Z","type":"message"}
{"nick":"someone235","reason":"Ping timeout: 255 seconds","date":"2017-06-21T02:09:52.009Z","type":"quit"}
{"nick":"zsoc","message":"prometh: right, that's without the bindings and it's wrong, as per what i said above","date":"2017-06-21T02:10:04.478Z","type":"message"}
{"nick":"zsoc","message":"show me the error either with the correct query syntax, or using the bindings as you were previously","date":"2017-06-21T02:10:14.447Z","type":"message"}
{"nick":"prometh","message":"i think it's teh same as:","date":"2017-06-21T02:10:29.713Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(`create \"user\" todo with encrypted password 'todo'`))","date":"2017-06-21T02:10:30.142Z","type":"message"}
{"nick":"zsoc","message":"it's not tho","date":"2017-06-21T02:10:36.127Z","type":"message"}
{"nick":"prometh","message":"ok","date":"2017-06-21T02:10:38.899Z","type":"message"}
{"nick":"zsoc","message":"so show me the error from doing that","date":"2017-06-21T02:10:39.845Z","type":"message"}
{"nick":"zsoc","message":"that's fine too","date":"2017-06-21T02:10:43.819Z","type":"message"}
{"nick":"prometh","message":"https://pastebin.com/u8Y6zvsf","date":"2017-06-21T02:11:14.198Z","type":"message"}
{"nick":"prometh","message":"aw fuck","date":"2017-06-21T02:11:24.958Z","type":"message"}
{"nick":"prometh","message":"k, it works","date":"2017-06-21T02:11:42.855Z","type":"message"}
{"nick":"zsoc","action":"blinks","date":"2017-06-21T02:11:46.908Z","type":"action"}
{"nick":"zsoc","message":"okay","date":"2017-06-21T02:11:48.073Z","type":"message"}
{"nick":"prometh","message":"now how to get the vars working","date":"2017-06-21T02:11:57.033Z","type":"message"}
{"nick":"zsoc","message":"^ please inform the channel of what you changed that caused it to work","date":"2017-06-21T02:12:16.517Z","type":"message"}
{"nick":"kerigan","reason":"Remote host closed the connection","date":"2017-06-21T02:12:35.395Z","type":"quit"}
{"nick":"prometh","message":"oh, i had `create \"user\" todo...","date":"2017-06-21T02:12:50.686Z","type":"message"}
{"nick":"prometh","message":"i moved the quotes to where they should've been","date":"2017-06-21T02:12:56.072Z","type":"message"}
{"nick":"zsoc","message":"oh","date":"2017-06-21T02:13:11.468Z","type":"message"}
{"nick":"prometh","message":"when i put back the interpolating vars, it still fails","date":"2017-06-21T02:13:13.987Z","type":"message"}
{"nick":"zsoc","message":"yep, that would do it lol","date":"2017-06-21T02:13:15.024Z","type":"message"}
{"nick":"prometh","message":":)","date":"2017-06-21T02:13:16.962Z","type":"message"}
{"nick":"zsoc","message":"okay, show me the error with the ?? and ?","date":"2017-06-21T02:13:20.610Z","type":"message"}
{"nick":"zsoc","message":"i'm curious to know why it doesn't work, and honestly i think it's kind of important if indeed it's not user error here..","date":"2017-06-21T02:13:32.595Z","type":"message"}
{"nick":"jaawerth","message":"yeah, psql.raw(`create user ?? with encrypted password ?`, [user, pass]) should work","date":"2017-06-21T02:13:43.805Z","type":"message"}
{"nick":"prometh","message":"https://pastebin.com/wnfvVa0P","date":"2017-06-21T02:13:46.039Z","type":"message"}
{"nick":"kerigan","date":"2017-06-21T02:13:56.081Z","type":"join"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user ?? with encrypted password ?\", [user, password]))","date":"2017-06-21T02:13:57.441Z","type":"message"}
{"nick":"zsoc","message":"there's only 1 binding","date":"2017-06-21T02:14:00.153Z","type":"message"}
{"nick":"zsoc","message":"oh i see, n/m'","date":"2017-06-21T02:14:11.386Z","type":"message"}
{"nick":"zsoc","message":"i forgot knex interpolates the ??'s and sends the ?'s as bindings","date":"2017-06-21T02:14:34.609Z","type":"message"}
{"nick":"zsoc","message":"or maybe that's pg","date":"2017-06-21T02:14:36.736Z","type":"message"}
{"nick":"darkSeid_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T02:14:45.843Z","type":"quit"}
{"nick":"jaawerth","message":"they're both bindings, ?? just outputs as an identifier whereas ? as a value","date":"2017-06-21T02:14:59.853Z","type":"message"}
{"nick":"zsoc","message":"yeah but if you look at line 7 in the gist there","date":"2017-06-21T02:15:15.089Z","type":"message"}
{"nick":"markasoftware","reason":"Quit: Leaving","date":"2017-06-21T02:15:21.670Z","type":"quit"}
{"nick":"zsoc","message":"only the ?'s are sent as bindings over the wire","date":"2017-06-21T02:15:24.248Z","type":"message"}
{"nick":"jaawerth","message":"ah yeah I see, it does interpolate","date":"2017-06-21T02:16:31.574Z","type":"message"}
{"nick":"zsoc","message":"i.. don't see an error here tho","date":"2017-06-21T02:17:01.729Z","type":"message"}
{"nick":"prometh","message":"this fails too:","date":"2017-06-21T02:17:51.616Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user ?? with encrypted password ?\", [user, \"todo\"]))","date":"2017-06-21T02:17:51.901Z","type":"message"}
{"nick":"deltab","message":"fails how?","date":"2017-06-21T02:18:04.003Z","type":"message"}
{"nick":"prometh","message":"same error","date":"2017-06-21T02:18:04.646Z","type":"message"}
{"nick":"zsoc","message":"deltab: https://pastebin.com/wnfvVa0P","date":"2017-06-21T02:18:10.682Z","type":"message"}
{"nick":"prometh","message":"  sql: 'create user \"todo\" with encrypted password ?',","date":"2017-06-21T02:18:16.180Z","type":"message"}
{"nick":"prometh","message":"  bindings: [ 'todo' ],","date":"2017-06-21T02:18:16.323Z","type":"message"}
{"nick":"zsoc","message":"just a regular 42601","date":"2017-06-21T02:18:17.892Z","type":"message"}
{"nick":"zsoc","message":"i don't see a syntax error","date":"2017-06-21T02:18:25.056Z","type":"message"}
{"nick":"prometh","message":"yeah, 42601","date":"2017-06-21T02:18:30.016Z","type":"message"}
{"nick":"zsoc","message":"42601 is like \"look at your code, it's obvious\" lol.. usually it's type casting or something","date":"2017-06-21T02:18:45.204Z","type":"message"}
{"nick":"anuxivm","reason":"Quit: Leaving.","date":"2017-06-21T02:18:47.833Z","type":"quit"}
{"nick":"kerigan","reason":"Quit: kerigan","date":"2017-06-21T02:19:02.770Z","type":"quit"}
{"nick":"kerigan","date":"2017-06-21T02:19:25.208Z","type":"join"}
{"nick":"kerigan","reason":"Client Quit","date":"2017-06-21T02:19:50.981Z","type":"quit"}
{"nick":"jaawerth","message":"yeah and the raw SQL it's outputting works fine if entered directly, it's weird","date":"2017-06-21T02:19:57.167Z","type":"message"}
{"nick":"zsoc","message":"ooooooo","date":"2017-06-21T02:20:14.864Z","type":"message"}
{"nick":"deltab","message":"quotes?","date":"2017-06-21T02:20:20.545Z","type":"message"}
{"nick":"zsoc","message":"this is a security thing","date":"2017-06-21T02:20:22.469Z","type":"message"}
{"nick":"prometh","message":"https://github.com/stevenvachon/todo-express/blob/master/scripts/createdb.js#L26","date":"2017-06-21T02:20:25.362Z","type":"message"}
{"nick":"zsoc","message":"no it's not quotes","date":"2017-06-21T02:20:25.363Z","type":"message"}
{"nick":"zsoc","message":"create user + prepared statements","date":"2017-06-21T02:20:30.072Z","type":"message"}
{"nick":"fuzzybear3965","reason":"Quit: I'm leaving e'rybody.","date":"2017-06-21T02:20:55.499Z","type":"quit"}
{"nick":"zsoc","message":"i found a thread someone with the same error using java and postgres","date":"2017-06-21T02:21:01.911Z","type":"message"}
{"nick":"jaawerth","message":"nah, the quotes are fine - you can use double-quotes around identifiers - it's the only way to (for example) make it case sensitive","date":"2017-06-21T02:21:08.542Z","type":"message"}
{"nick":"deltab","message":"ah","date":"2017-06-21T02:21:16.207Z","type":"message"}
{"nick":"EyePulp","date":"2017-06-21T02:21:30.249Z","type":"join"}
{"nick":"jaawerth","message":"ahh that makes sense I suppose","date":"2017-06-21T02:21:31.538Z","type":"message"}
{"nick":"EyePulp","reason":"Remote host closed the connection","date":"2017-06-21T02:21:36.607Z","type":"quit"}
{"nick":"ljharb","message":"zsoc: anyone doing transpilation will likely break; anyone using require will not have to change anything.","date":"2017-06-21T02:21:40.217Z","type":"message"}
{"nick":"EyePulp","date":"2017-06-21T02:21:50.386Z","type":"join"}
{"nick":"jaawerth","message":"zsoc: what's the thread?","date":"2017-06-21T02:22:10.623Z","type":"message"}
{"nick":"fuzzybear3965","date":"2017-06-21T02:22:28.117Z","type":"join"}
{"nick":"zsoc","message":"jaawerth: i'm an idiot an closed the tab and then realized it was in an incognito browser >.> sec","date":"2017-06-21T02:22:29.943Z","type":"message"}
{"nick":"Cohedrin_","reason":"Read error: Connection reset by peer","date":"2017-06-21T02:22:34.279Z","type":"quit"}
{"nick":"zsoc","message":"lol okay here's a thread talking about that thread.. wat: https://github.com/brianc/node-postgres/issues/539","date":"2017-06-21T02:23:00.121Z","type":"message"}
{"nick":"deltab","message":"ctrl-shift-t?","date":"2017-06-21T02:23:07.080Z","type":"message"}
{"nick":"zsoc","message":"deltab: doesn't work in incognito >.>","date":"2017-06-21T02:23:17.513Z","type":"message"}
{"nick":"prometh","message":"zsoc: i need to use npmjs.com/pg-escape ?","date":"2017-06-21T02:24:15.542Z","type":"message"}
{"nick":"zsoc","message":"No.. you need to make a prepared statement and run it raw i guess","date":"2017-06-21T02:24:31.586Z","type":"message"}
{"nick":"Cohedrin_","date":"2017-06-21T02:24:51.322Z","type":"join"}
{"nick":"prometh","message":"but i used interpolation in \"create database\"","date":"2017-06-21T02:25:03.474Z","type":"message"}
{"nick":"prometh","message":"why is this one different? ebcause there're multiple?","date":"2017-06-21T02:25:13.032Z","type":"message"}
{"nick":"zsoc","message":"uhhh try stuffing the output of that knex.raw command with a .toSQL() at the end into another knew.raw? heh","date":"2017-06-21T02:25:15.701Z","type":"message"}
{"nick":"zsoc","message":"prometh: create database has no binding interpolation","date":"2017-06-21T02:25:31.243Z","type":"message"}
{"nick":"zsoc","message":"on pg's side","date":"2017-06-21T02:25:38.114Z","type":"message"}
{"nick":"zsoc","message":"knex string escapes the identifier for you (the name of the db)","date":"2017-06-21T02:25:46.997Z","type":"message"}
{"nick":"prometh","message":"binding?","date":"2017-06-21T02:25:49.487Z","type":"message"}
{"nick":"zsoc","message":"here you have the 'password' field which has the value binding","date":"2017-06-21T02:25:57.180Z","type":"message"}
{"nick":"prometh","message":"is this a knex bug?","date":"2017-06-21T02:26:20.743Z","type":"message"}
{"nick":"zsoc","message":"not it has nothing to do with knex","date":"2017-06-21T02:26:30.790Z","type":"message"}
{"nick":"jaawerth","message":"what's weird is it definitely works with create database","date":"2017-06-21T02:26:36.511Z","type":"message"}
{"nick":"zsoc","message":"in fact, knex escaping properly is the reason the first command works","date":"2017-06-21T02:26:38.692Z","type":"message"}
{"nick":"zsoc","message":"it's not weird","date":"2017-06-21T02:26:40.579Z","type":"message"}
{"nick":"zsoc","message":"because with create database there is no binding over the wire to pg","date":"2017-06-21T02:26:49.048Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"create database ??\", name))","date":"2017-06-21T02:27:02.703Z","type":"message"}
{"nick":"zsoc","message":"knex interpolates the identifier","date":"2017-06-21T02:27:03.556Z","type":"message"}
{"nick":"prometh","message":"that's not a binding?","date":"2017-06-21T02:27:05.308Z","type":"message"}
{"nick":"systemfault","date":"2017-06-21T02:27:05.740Z","type":"join"}
{"nick":"jaawerth","message":"ohh right","date":"2017-06-21T02:27:08.208Z","type":"message"}
{"nick":"zsoc","message":"correct","date":"2017-06-21T02:27:08.997Z","type":"message"}
{"nick":"prometh","message":"what is a binding?","date":"2017-06-21T02:27:14.957Z","type":"message"}
{"nick":"jaawerth","message":"also I didn't think parameterized knex.raw calls actaully did prepared statements","date":"2017-06-21T02:27:27.216Z","type":"message"}
{"nick":"gli","date":"2017-06-21T02:27:27.280Z","type":"join"}
{"nick":"prometh","message":"should i use query() ?","date":"2017-06-21T02:27:39.519Z","type":"message"}
{"nick":"jaawerth","message":"per https://github.com/tgriesser/knex/issues/718#issuecomment-76960004","date":"2017-06-21T02:27:45.227Z","type":"message"}
{"nick":"zsoc","message":"1 sec let me try something","date":"2017-06-21T02:27:46.086Z","type":"message"}
{"nick":"joshontheweb","reason":"Quit: Computer has gone to sleep.","date":"2017-06-21T02:28:07.595Z","type":"quit"}
{"nick":"zsoc","message":"jaawerth: yeah sorry, i am only trying to fake one lol, not a real prepared statement","date":"2017-06-21T02:28:09.597Z","type":"message"}
{"nick":"MachinShin","date":"2017-06-21T02:28:20.011Z","type":"join"}
{"nick":"zsoc","message":"jaawerth: in that thread: \"To see parametrized generated sql strings which are sent to database driver you can call .toSQL() method of the query builder\"","date":"2017-06-21T02:28:38.501Z","type":"message"}
{"nick":"zsoc","message":"which is what i wanted him to try","date":"2017-06-21T02:28:42.466Z","type":"message"}
{"nick":"jaawerth","message":"zsoc: yeah - I did that earlier and it outputs the right stuff","date":"2017-06-21T02:28:53.729Z","type":"message"}
{"nick":"jaawerth","message":"which makes it more confusing, lol","date":"2017-06-21T02:29:00.597Z","type":"message"}
{"nick":"zsoc","message":"that's the thing tho","date":"2017-06-21T02:29:05.969Z","type":"message"}
{"nick":"alex____1","date":"2017-06-21T02:29:10.191Z","type":"join"}
{"nick":"zsoc","message":"that isn't the same thing that happens when you use knex.raw","date":"2017-06-21T02:29:15.193Z","type":"message"}
{"nick":"zsoc","message":"knex.raw lets `pg` handle interpolation and escaping of values","date":"2017-06-21T02:29:28.033Z","type":"message"}
{"nick":"ovsh","date":"2017-06-21T02:29:48.196Z","type":"join"}
{"nick":"jaawerth","message":"knex.raw('create user ?? with encrypted password ?', ['foo', 'bar']).toString() outputs 'CREATE USER \"foo\" WITH ENCRYPTED PASSWORD \\'bar\\''","date":"2017-06-21T02:30:21.720Z","type":"message"}
{"nick":"Cabanossi","reason":"Ping timeout: 264 seconds","date":"2017-06-21T02:30:22.297Z","type":"quit"}
{"nick":"jaawerth","message":"er, the escaping there is because I did it in a repl","date":"2017-06-21T02:30:32.328Z","type":"message"}
{"nick":"zsoc","message":"blah i don't have an envrionment to do this in","date":"2017-06-21T02:30:46.747Z","type":"message"}
{"nick":"zsoc","message":"jaawerth: what happens when you do toSQL() tho?","date":"2017-06-21T02:30:52.074Z","type":"message"}
{"nick":"thekingofbandit","reason":"Max SendQ exceeded","date":"2017-06-21T02:31:01.722Z","type":"quit"}
{"nick":"jaawerth","message":"ahh right, that leaves the binding intact","date":"2017-06-21T02:31:30.023Z","type":"message"}
{"nick":"webguynow","reason":"Ping timeout: 240 seconds","date":"2017-06-21T02:31:35.615Z","type":"quit"}
{"nick":"prometh","message":"TypeError: sql.replace is not a function","date":"2017-06-21T02:31:48.300Z","type":"message"}
{"nick":"Cabanossi","date":"2017-06-21T02:31:49.467Z","type":"join"}
{"nick":"prometh","message":".then(() => psql.raw(psql.raw(\"create user ?? with encrypted password ?\", [user, password]).toSQL()))","date":"2017-06-21T02:31:56.554Z","type":"message"}
{"nick":"webguynow","date":"2017-06-21T02:32:09.917Z","type":"join"}
{"nick":"jaawerth","message":"but I'm pretty sure the final string is what actually gets sent to the DB.. not sure","date":"2017-06-21T02:32:20.574Z","type":"message"}
{"nick":"jaawerth","message":"now I'm curious","date":"2017-06-21T02:32:23.460Z","type":"message"}
{"nick":"jaawerth","message":"one sec, I'ma turn on logging in postgres for a sec","date":"2017-06-21T02:32:30.215Z","type":"message"}
{"nick":"zsoc","message":"No it's not, look at his stack trace :p","date":"2017-06-21T02:32:33.934Z","type":"message"}
{"nick":"zsoc","message":"toSQL() is what is.. sent.. to sql :p","date":"2017-06-21T02:32:42.061Z","type":"message"}
{"nick":"thekingofbandit","date":"2017-06-21T02:33:04.784Z","type":"join"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user ?? with encrypted password ?\", [user, password]).toSQL())","date":"2017-06-21T02:33:38.331Z","type":"message"}
{"nick":"prometh","message":".then(query => { console.log(query); psql.raw(query) })","date":"2017-06-21T02:33:38.472Z","type":"message"}
{"nick":"prometh","message":"/","date":"2017-06-21T02:33:41.149Z","type":"message"}
{"nick":"zsoc","message":"i mean otherwise he just uses pg-escape like he said","date":"2017-06-21T02:33:42.682Z","type":"message"}
{"nick":"prometh","message":"that runs without error, but never logs the query","date":"2017-06-21T02:33:48.767Z","type":"message"}
{"nick":"zsoc","message":"never logs the query? wat","date":"2017-06-21T02:34:22.750Z","type":"message"}
{"nick":"zsoc","message":"yes it will","date":"2017-06-21T02:34:27.905Z","type":"message"}
{"nick":"prometh","message":"well, it does not :P","date":"2017-06-21T02:34:32.857Z","type":"message"}
{"nick":"zsoc","message":"you might have missed it between the spam if debug is on","date":"2017-06-21T02:34:42.034Z","type":"message"}
{"nick":"prometh","message":"TypeError: sql.replace is not a function","date":"2017-06-21T02:34:52.140Z","type":"message"}
{"nick":"prometh","message":"i added a `return` on the second raw","date":"2017-06-21T02:35:08.208Z","type":"message"}
{"nick":"smccarthy","date":"2017-06-21T02:35:18.576Z","type":"join"}
{"nick":"Kainore","date":"2017-06-21T02:35:20.922Z","type":"quit"}
{"nick":"zsoc","message":"oh you have to return it","date":"2017-06-21T02:35:22.411Z","type":"message"}
{"nick":"jaawerth","message":"ah yeah the db IS getting it with the bindings as bindings","date":"2017-06-21T02:35:23.914Z","type":"message"}
{"nick":"jaawerth","message":"just verified it in the pg log","date":"2017-06-21T02:35:28.671Z","type":"message"}
{"nick":"zsoc","message":"the second .raw() is a promise","date":"2017-06-21T02:35:28.956Z","type":"message"}
{"nick":"prometh","message":"yes","date":"2017-06-21T02:35:34.844Z","type":"message"}
{"nick":"zsoc","message":"the first one isn't because you're just getting the sql from it","date":"2017-06-21T02:35:37.868Z","type":"message"}
{"nick":"ovsh","message":"I'm trying to do a simple PUT API endpoint through bookshelf.js (extension of Knex). Anyone know what the hell is going wrong here? Error included in gist. https://gist.github.com/ovsh/dc3f69ec9fccd5be2acd83aca66875e9","date":"2017-06-21T02:35:39.372Z","type":"message"}
{"nick":"zsoc","message":"so wait.. he can't use toString() tho.. right? because it doesn't escape?","date":"2017-06-21T02:36:31.155Z","type":"message"}
{"nick":"zsoc","message":"y/n?","date":"2017-06-21T02:36:33.067Z","type":"message"}
{"nick":"deltab","message":"ovsh: does the fetch work on its own?","date":"2017-06-21T02:39:26.622Z","type":"message"}
{"nick":"ovsh","message":"deltab, Should be? http://bookshelfjs.org/#Model-instance-fetch","date":"2017-06-21T02:40:17.108Z","type":"message"}
{"nick":"ovsh","message":"I just started with this as you can see (can't even write a solid PUT method), so I was hoping for help","date":"2017-06-21T02:40:30.976Z","type":"message"}
{"nick":"deltab","message":"ovsh: oh, that select part isn't part of the error message?","date":"2017-06-21T02:40:34.798Z","type":"message"}
{"nick":"ovsh","message":"deltab, select part is part of what it spits out as the query actually sent to the DB","date":"2017-06-21T02:41:01.703Z","type":"message"}
{"nick":"deltab","message":"so that part works","date":"2017-06-21T02:41:13.459Z","type":"message"}
{"nick":"prometh","message":"zsoc: jaawerth: using toString works","date":"2017-06-21T02:41:31.498Z","type":"message"}
{"nick":"phpnode","reason":"Remote host closed the connection","date":"2017-06-21T02:41:34.547Z","type":"quit"}
{"nick":"zsoc","message":"yes ofc it will \"work\"","date":"2017-06-21T02:41:42.080Z","type":"message"}
{"nick":"prometh","message":"oh","date":"2017-06-21T02:41:46.909Z","type":"message"}
{"nick":"ovsh","message":"deltab, not necessarily? It's crashing :(","date":"2017-06-21T02:41:50.166Z","type":"message"}
{"nick":"zsoc","message":"but the question is if it escapes which i think it most certainly doesn't","date":"2017-06-21T02:41:51.639Z","type":"message"}
{"nick":"deltab","message":"ovsh: when you save, you have to give an id, I guess","date":"2017-06-21T02:41:52.962Z","type":"message"}
{"nick":"zsoc","message":"deltab: project.save() should be able to create the proper 'where' clause... so something else funky is happening","date":"2017-06-21T02:42:23.027Z","type":"message"}
{"nick":"deltab","message":"there's no where on the select","date":"2017-06-21T02:42:40.838Z","type":"message"}
{"nick":"ovsh","message":"deltab, look at the forge() examples under save(): http://bookshelfjs.org/#Model-instance-save","date":"2017-06-21T02:42:48.297Z","type":"message"}
{"nick":"ovsh","message":"I don't see anything being passed into save itself","date":"2017-06-21T02:42:54.429Z","type":"message"}
{"nick":"deltab","message":"my browser's not working at the moment","date":"2017-06-21T02:43:07.156Z","type":"message"}
{"nick":"eb0t_","reason":"Ping timeout: 255 seconds","date":"2017-06-21T02:43:07.947Z","type":"quit"}
{"nick":"def_jam","reason":"Ping timeout: 255 seconds","date":"2017-06-21T02:43:07.956Z","type":"quit"}
{"nick":"zsoc","message":"yeah your fetch syntax is wrong i'm 90% sure","date":"2017-06-21T02:43:11.481Z","type":"message"}
{"nick":"ovsh","message":"I could not for the life of me find a solid sample for an API built with bookshelf. Should I just not use it?","date":"2017-06-21T02:43:24.397Z","type":"message"}
{"nick":"ovsh","message":"zsoc, what would be the right syntax?","date":"2017-06-21T02:43:30.587Z","type":"message"}
{"nick":"zsoc","message":"i don't know ORMs personally.. so no comment from me there.. but","date":"2017-06-21T02:43:50.171Z","type":"message"}
{"nick":"prometh","message":"zsoc: why is this happening?","date":"2017-06-21T02:43:51.252Z","type":"message"}
{"nick":"jaawerth","message":"ahhh okay, it isn't using PREPARE, but it *is* using EXECUTE","date":"2017-06-21T02:43:56.361Z","type":"message"}
{"nick":"jaawerth","message":"hence the direct passing of the bindings","date":"2017-06-21T02:44:07.072Z","type":"message"}
{"nick":"zsoc","message":"prometh: why is what happening? pg doesn't allow you to use bindings for the password field in a create statement","date":"2017-06-21T02:44:18.006Z","type":"message"}
{"nick":"zsoc","message":"well, for any field","date":"2017-06-21T02:44:22.359Z","type":"message"}
{"nick":"prometh","message":"why not?","date":"2017-06-21T02:44:27.919Z","type":"message"}
{"nick":"zsoc","message":"security, likely","date":"2017-06-21T02:44:33.566Z","type":"message"}
{"nick":"prometh","message":"should i just template string it?","date":"2017-06-21T02:44:45.910Z","type":"message"}
{"nick":"deltab","message":"using a prepared statement?","date":"2017-06-21T02:44:47.663Z","type":"message"}
{"nick":"jaawerth","message":"knex.raw, which evidently uses EXECUTE for value bindings","date":"2017-06-21T02:45:00.451Z","type":"message"}
{"nick":"deltab","message":"only some statements can be prepared, I imagine","date":"2017-06-21T02:45:05.537Z","type":"message"}
{"nick":"jaawerth","message":"it's not prepared, but EXECUTE has the same rules","date":"2017-06-21T02:45:15.024Z","type":"message"}
{"nick":"zsoc","message":"`pg` doesn't do prepared statements","date":"2017-06-21T02:45:16.312Z","type":"message"}
{"nick":"zsoc","message":"but yeah","date":"2017-06-21T02:45:18.711Z","type":"message"}
{"nick":"jaawerth","message":"but it's not just CREATE statements, it looks like it's specifically wrt passwords","date":"2017-06-21T02:45:33.193Z","type":"message"}
{"nick":"zsoc","message":"oh interesting","date":"2017-06-21T02:45:38.377Z","type":"message"}
{"nick":"zsoc","message":"prometh: just use `pg-escape`","date":"2017-06-21T02:45:44.726Z","type":"message"}
{"nick":"jaawerth","message":"wait nm","date":"2017-06-21T02:45:47.183Z","type":"message"}
{"nick":"deltab","message":"oh, if there are no prepared statements that doesn't apply","date":"2017-06-21T02:45:48.143Z","type":"message"}
{"nick":"jaawerth","message":"that's the identifier thing","date":"2017-06-21T02:45:49.430Z","type":"message"}
{"nick":"jaawerth","message":"when you use ?? identifiers, it's interpolating","date":"2017-06-21T02:45:53.842Z","type":"message"}
{"nick":"zsoc","message":"correct","date":"2017-06-21T02:46:00.995Z","type":"message"}
{"nick":"jaawerth","message":"(since pg won't let you use a binding to an identifier anyway)","date":"2017-06-21T02:46:10.432Z","type":"message"}
{"nick":"prometh","message":"cani use ?? for password?","date":"2017-06-21T02:46:12.435Z","type":"message"}
{"nick":"jaawerth","message":"(that is, postgres itself - in postgres)","date":"2017-06-21T02:46:17.812Z","type":"message"}
{"nick":"deltab","message":"if the client builds the statement as a string, pg has no idea what was bound","date":"2017-06-21T02:46:33.326Z","type":"message"}
{"nick":"prometh","message":"i'm pretty confused right now, and using another lib feels nasty","date":"2017-06-21T02:46:34.216Z","type":"message"}
{"nick":"zsoc","message":"ovsh: i think the thing you're putting in 'fetch' you want to put in 'forge'","date":"2017-06-21T02:46:38.108Z","type":"message"}
{"nick":"zsoc","message":"prometh: no.. it's not an identifier, it's a value lol","date":"2017-06-21T02:46:47.456Z","type":"message"}
{"nick":"zsoc","message":"prometh: technically what you're doing is nasty, that's the actual problem :p","date":"2017-06-21T02:46:55.869Z","type":"message"}
{"nick":"jaawerth","message":"which is why you need to do funky interpolation things via a postgres function if you wanna dynamically create tables or databases from inside an SQL statement","date":"2017-06-21T02:47:00.942Z","type":"message"}
{"nick":"ovsh","message":"zsoc, thanks! Let me try","date":"2017-06-21T02:47:03.022Z","type":"message"}
{"nick":"zsoc","message":"but since you seem to have a legitimate use case...","date":"2017-06-21T02:47:04.338Z","type":"message"}
{"nick":"prometh","message":"zsoc: what's wrong with it?","date":"2017-06-21T02:47:05.054Z","type":"message"}
{"nick":"zsoc","message":"programmatically creating database users is.. very sensitive","date":"2017-06-21T02:47:18.019Z","type":"message"}
{"nick":"jaawerth","message":"basically pg doesn't want outside interfaces to just let you dynamically set user passwords","date":"2017-06-21T02:47:30.465Z","type":"message"}
{"nick":"prometh","message":"oh","date":"2017-06-21T02:47:35.350Z","type":"message"}
{"nick":"zsoc","message":"^^^^","date":"2017-06-21T02:47:36.389Z","type":"message"}
{"nick":"zsoc","message":"so you can 'trick' it by 'preparing' the statement yourself","date":"2017-06-21T02:47:46.040Z","type":"message"}
{"nick":"jaawerth","message":"er, pg being postgres itself, not the node driver","date":"2017-06-21T02:47:48.282Z","type":"message"}
{"nick":"deltab","message":"how does it know?","date":"2017-06-21T02:47:54.164Z","type":"message"}
{"nick":"zsoc","message":"but you have to be insanely careful because you are basing manually doing the escaping","date":"2017-06-21T02:47:58.358Z","type":"message"}
{"nick":"dodobrain","reason":"Quit: buh bye.. o/","date":"2017-06-21T02:48:05.807Z","type":"quit"}
{"nick":"zsoc","message":"deltab: it knows because `knex` is just giving `pg` the bindings for values","date":"2017-06-21T02:48:12.539Z","type":"message"}
{"nick":"prometh","message":"we/i have to be very explicit, obtuse even, to make this happen","date":"2017-06-21T02:48:14.109Z","type":"message"}
{"nick":"jaawerth","message":"deltab: because knex.raw used with a ? binding ends up submitting your statement wrapped in EXECUTE (with the appropriate bound values)","date":"2017-06-21T02:48:23.707Z","type":"message"}
{"nick":"zsoc","message":"prometh: so that's why i say use `pg-escape`, because it was designed to solve this exact problem","date":"2017-06-21T02:48:36.290Z","type":"message"}
{"nick":"deltab","message":"so it doesn't support bindings for that type of statement?","date":"2017-06-21T02:48:41.817Z","type":"message"}
{"nick":"zsoc","message":"deltab: this is the same also with `pg` btw... and yes, pg specifically doesn't support binding for 'create' statements","date":"2017-06-21T02:48:52.586Z","type":"message"}
{"nick":"jaawerth","message":"but yeah, just knex.raw(knex.raw('create user ?? with encrypted password ?', [user, pass]).toString()) will work","date":"2017-06-21T02:49:01.991Z","type":"message"}
{"nick":"prometh","message":"zsoc: could pg support a flag to enable this? like imDamnSure:true","date":"2017-06-21T02:49:10.043Z","type":"message"}
{"nick":"zsoc","message":"i hope not","date":"2017-06-21T02:49:16.293Z","type":"message"}
{"nick":"zsoc","message":"the 'im damn sure' flag is.. escape it yourself :p","date":"2017-06-21T02:49:24.673Z","type":"message"}
{"nick":"jaawerth","message":"prometh: by \"pg\" in this case we mean postgres itself","date":"2017-06-21T02:49:29.305Z","type":"message"}
{"nick":"prometh","message":"hehe","date":"2017-06-21T02:49:29.589Z","type":"message"}
{"nick":"zsoc","message":"jaawerth: that \"will work\" but it will also not escape AT ALL","date":"2017-06-21T02:49:38.398Z","type":"message"}
{"nick":"Phloxx","reason":"Ping timeout: 255 seconds","date":"2017-06-21T02:49:47.940Z","type":"quit"}
{"nick":"zsoc","message":"that is the same as him just doing `encrypted password ${password}`","date":"2017-06-21T02:49:49.467Z","type":"message"}
{"nick":"prometh","message":"jaawerth: oh... that part i udnerstand even less.. i htought i was assembling a string for postgres","date":"2017-06-21T02:50:00.882Z","type":"message"}
{"nick":"prometh","message":"this is wehre i feel like i'm wasting people's time","date":"2017-06-21T02:51:09.875Z","type":"message"}
{"nick":"zsoc","message":"you're not, this is actually an interesting case","date":"2017-06-21T02:51:17.833Z","type":"message"}
{"nick":"zsoc","message":"that i understand better","date":"2017-06-21T02:51:21.351Z","type":"message"}
{"nick":"the_ant","date":"2017-06-21T02:51:27.899Z","type":"join"}
{"nick":"zsoc","message":"what is your use tho here? where is the input for 'password' coming from?","date":"2017-06-21T02:51:28.185Z","type":"message"}
{"nick":"zsoc","message":"is this a cli thing? or an npm script?","date":"2017-06-21T02:51:35.944Z","type":"message"}
{"nick":"prometh","message":"zsoc: a .env file","date":"2017-06-21T02:51:38.008Z","type":"message"}
{"nick":"prometh","message":"npm script","date":"2017-06-21T02:51:42.217Z","type":"message"}
{"nick":"zsoc","message":"so just use a template string and never do that again anywhere else ever","date":"2017-06-21T02:51:55.261Z","type":"message"}
{"nick":"zsoc","message":"is my 2 cents","date":"2017-06-21T02:51:56.838Z","type":"message"}
{"nick":"prometh","message":"the dev could mess up","date":"2017-06-21T02:52:05.496Z","type":"message"}
{"nick":"zsoc","message":"yeah but the point is not maliciously","date":"2017-06-21T02:52:20.502Z","type":"message"}
{"nick":"prometh","message":"or, you mean template string with pg-escape","date":"2017-06-21T02:52:21.217Z","type":"message"}
{"nick":"prometh","message":"yeah","date":"2017-06-21T02:52:27.735Z","type":"message"}
{"nick":"zsoc","message":"if someone maliciously altered your .env file they already have all of your credentials","date":"2017-06-21T02:52:29.943Z","type":"message"}
{"nick":"systemfault","reason":"Ping timeout: 240 seconds","date":"2017-06-21T02:52:31.693Z","type":"quit"}
{"nick":"jaawerth","message":"zsoc: well it will wrap the bound value in quotes and IIRC escape any internal quote marks","date":"2017-06-21T02:52:31.836Z","type":"message"}
{"nick":"zsoc","message":"no i mean use ${}","date":"2017-06-21T02:52:34.410Z","type":"message"}
{"nick":"prometh","message":"but they're keyboard could glitch","date":"2017-06-21T02:52:35.023Z","type":"message"}
{"nick":"jaawerth","message":"zsoc: still, yeah, seems sketchy","date":"2017-06-21T02:52:36.036Z","type":"message"}
{"nick":"jaawerth","message":"and you could just as easily do that yourself","date":"2017-06-21T02:52:48.943Z","type":"message"}
{"nick":"zsoc","message":"eh... true","date":"2017-06-21T02:52:53.697Z","type":"message"}
{"nick":"mr-foobar","reason":"Ping timeout: 268 seconds","date":"2017-06-21T02:52:57.851Z","type":"quit"}
{"nick":"zsoc","message":"prometh: then use toString()","date":"2017-06-21T02:52:58.993Z","type":"message"}
{"nick":"zsoc","message":"it's better than nothing","date":"2017-06-21T02:53:01.107Z","type":"message"}
{"nick":"Phloxx","date":"2017-06-21T02:53:04.897Z","type":"join"}
{"nick":"zsoc","message":"and there's no malicious vector here","date":"2017-06-21T02:53:06.857Z","type":"message"}
{"nick":"prometh","message":"but there's human error","date":"2017-06-21T02:53:14.814Z","type":"message"}
{"nick":"ljharb","message":"`String(x)`, ofc","date":"2017-06-21T02:53:16.662Z","type":"message"}
{"nick":"ljharb","message":"lol \"their keyboard could glitch\"","date":"2017-06-21T02:53:33.150Z","type":"message"}
{"nick":"prometh","message":";)","date":"2017-06-21T02:53:36.088Z","type":"message"}
{"nick":"zsoc","message":"right but toString fixes the escaping parts of things and stuff","date":"2017-06-21T02:53:41.726Z","type":"message"}
{"nick":"zsoc","message":"the important stuff","date":"2017-06-21T02:53:43.831Z","type":"message"}
{"nick":"zsoc","message":"'human error' is not 'sql injection'","date":"2017-06-21T02:53:54.008Z","type":"message"}
{"nick":"prometh","message":"zsoc: but the code is nasty","date":"2017-06-21T02:53:57.209Z","type":"message"}
{"nick":"prometh","message":"pg-escape would be clearer","date":"2017-06-21T02:54:01.592Z","type":"message"}
{"nick":"jaawerth","message":"it's one line","date":"2017-06-21T02:54:12.928Z","type":"message"}
{"nick":"jaawerth","message":"you won't have to do this anywhere else","date":"2017-06-21T02:54:16.604Z","type":"message"}
{"nick":"jaawerth","message":"just use .toString()","date":"2017-06-21T02:54:21.053Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"create user ?? with encrypted password ?\", [user, password]).toString())","date":"2017-06-21T02:54:27.891Z","type":"message"}
{"nick":"prometh","message":".then(query => psql.raw(query))","date":"2017-06-21T02:54:28.033Z","type":"message"}
{"nick":"prometh","message":" // ewwww","date":"2017-06-21T02:54:31.137Z","type":"message"}
{"nick":"zsoc","message":".toString() is sync","date":"2017-06-21T02:54:51.336Z","type":"message"}
{"nick":"zsoc","message":"you can do those in the same block","date":"2017-06-21T02:54:54.158Z","type":"message"}
{"nick":"zsoc","message":"return psql.raw on the 2nd line, clearer","date":"2017-06-21T02:54:59.650Z","type":"message"}
{"nick":"prometh","message":"hard to read","date":"2017-06-21T02:55:00.114Z","type":"message"}
{"nick":"zsoc","message":"ugh, you're one of those lol","date":"2017-06-21T02:55:05.245Z","type":"message"}
{"nick":"prometh","message":":D","date":"2017-06-21T02:55:09.149Z","type":"message"}
{"nick":"jaawerth","message":"then do it in its own line and store the string in a var","date":"2017-06-21T02:55:11.639Z","type":"message"}
{"nick":"prometh","message":"alright","date":"2017-06-21T02:55:27.926Z","type":"message"}
{"nick":"ovsh","message":"zsoc, Argh that didn't work. :(","date":"2017-06-21T02:55:30.247Z","type":"message"}
{"nick":"ovsh","message":"fml","date":"2017-06-21T02:55:30.876Z","type":"message"}
{"nick":"ovsh","message":"Now it pops this out: sql: 'select \"projects\".* from \"projects\" where \"projects\".\"projectID\" = ? limit ?' }","date":"2017-06-21T02:55:43.294Z","type":"message"}
{"nick":"kerigan","date":"2017-06-21T02:55:45.861Z","type":"join"}
{"nick":"eb0t_","date":"2017-06-21T02:55:49.700Z","type":"join"}
{"nick":"ovsh","message":"same no where clause or id attribute found","date":"2017-06-21T02:55:50.698Z","type":"message"}
{"nick":"zsoc","message":"ovsh: well at least that's correct tho","date":"2017-06-21T02:55:53.986Z","type":"message"}
{"nick":"zsoc","message":"there is a where clause","date":"2017-06-21T02:55:57.982Z","type":"message"}
{"nick":"zsoc","message":"look at it :p","date":"2017-06-21T02:56:01.200Z","type":"message"}
{"nick":"zsoc","message":"re gist the full error?","date":"2017-06-21T02:56:05.675Z","type":"message"}
{"nick":"ovsh","message":"Sure","date":"2017-06-21T02:56:08.964Z","type":"message"}
{"nick":"prometh","message":"thank you muchly, zsoc and jaawerth","date":"2017-06-21T02:56:09.249Z","type":"message"}
{"nick":"zsoc","message":"^_^","date":"2017-06-21T02:56:14.901Z","type":"message"}
{"nick":"systemfault","date":"2017-06-21T02:56:17.539Z","type":"join"}
{"nick":"jaawerth","message":"np","date":"2017-06-21T02:56:26.290Z","type":"message"}
{"nick":"kerigan","reason":"Client Quit","date":"2017-06-21T02:56:40.043Z","type":"quit"}
{"nick":"ovsh","message":"zsoc, thanks for helping! https://gist.github.com/ovsh/dc3f69ec9fccd5be2acd83aca66875e9","date":"2017-06-21T02:56:56.910Z","type":"message"}
{"nick":"zsoc","message":"ovsh: wait.. why are you using forge() here? I thought forge created a new model, don't you want a new object with an existing model?","date":"2017-06-21T02:57:07.011Z","type":"message"}
{"nick":"zsoc","message":"i don't know.. too much about bookshelf tho","date":"2017-06-21T02:57:12.750Z","type":"message"}
{"nick":"ovsh","message":"I tried the other stuff and it gave me other errors. I'm just fishing awau","date":"2017-06-21T02:57:27.963Z","type":"message"}
{"nick":"ovsh","message":"away*","date":"2017-06-21T02:57:31.199Z","type":"message"}
{"nick":"zsoc","message":"\"a model cannot be updated without... \"","date":"2017-06-21T02:57:49.120Z","type":"message"}
{"nick":"def_jam","date":"2017-06-21T02:57:56.795Z","type":"join"}
{"nick":"zsoc","message":"yeah it sounds like you're altering a model here, i don't think that's what you want","date":"2017-06-21T02:57:58.402Z","type":"message"}
{"nick":"prometh","message":"is there a specific github comment i can reference for this workaround ?","date":"2017-06-21T02:58:03.850Z","type":"message"}
{"nick":"zsoc","message":"ovsh: i assume that you are trying to just update some project (like a row in the table) and not the project model itself, right?","date":"2017-06-21T02:58:28.824Z","type":"message"}
{"nick":"ovsh","message":"zsoc, correct!","date":"2017-06-21T02:59:03.267Z","type":"message"}
{"nick":"zsoc","message":"i could be wrong about what forge does tho.. reading docs, sec","date":"2017-06-21T02:59:14.429Z","type":"message"}
{"nick":"jaawerth","message":"that seems like the error isn't coming from knex (which has no concept of model) and is instead coming from whatever's wrapping it","date":"2017-06-21T02:59:25.511Z","type":"message"}
{"nick":"zsoc","message":"yeah it def makes or updates the model itself","date":"2017-06-21T02:59:27.110Z","type":"message"}
{"nick":"zsoc","message":"100%","date":"2017-06-21T02:59:31.581Z","type":"message"}
{"nick":"zsoc","message":"you don't want forge","date":"2017-06-21T02:59:36.863Z","type":"message"}
{"nick":"ovsh","message":"zsoc, look at this:","date":"2017-06-21T02:59:46.735Z","type":"message"}
{"nick":"ovsh","message":"zsoc, under title \"Loading Models\": http://stackabuse.com/bookshelf-js-a-node-js-orm/","date":"2017-06-21T02:59:56.684Z","type":"message"}
{"nick":"zsoc","message":"oooo is this the 5th case today of \"thing failing because bad tutorial\"? hehe","date":"2017-06-21T03:00:21.910Z","type":"message"}
{"nick":"zsoc","message":"hmm i see","date":"2017-06-21T03:00:54.854Z","type":"message"}
{"nick":"Cabanossi","reason":"Ping timeout: 276 seconds","date":"2017-06-21T03:01:00.809Z","type":"quit"}
{"nick":"zsoc","message":"why do you have to load this model to save it tho?","date":"2017-06-21T03:01:04.542Z","type":"message"}
{"nick":"zsoc","message":"that seems backwards","date":"2017-06-21T03:01:14.262Z","type":"message"}
{"nick":"Cabanossi","date":"2017-06-21T03:01:52.234Z","type":"join"}
{"nick":"ovsh","message":"zsoc, I think you pull the model you want, then save it?","date":"2017-06-21T03:01:54.268Z","type":"message"}
{"nick":"ovsh","message":"zsoc, I dunno. I just pulled this document up while debugging. Docs are weird.","date":"2017-06-21T03:02:05.619Z","type":"message"}
{"nick":"ovsh","message":"zsoc, What do you use? And what should I use?","date":"2017-06-21T03:02:13.932Z","type":"message"}
{"nick":"zsoc","message":"knex('users').update(fields).where('users.user_id', userId)","date":"2017-06-21T03:02:27.245Z","type":"message"}
{"nick":"zsoc","message":"like ... i can't imagine the ORM makes it MORE verbose?","date":"2017-06-21T03:02:36.303Z","type":"message"}
{"nick":"zsoc","message":"that would be bizarre to me lol","date":"2017-06-21T03:02:39.792Z","type":"message"}
{"nick":"ChALkeR","date":"2017-06-21T03:03:00.471Z","type":"join"}
{"nick":"prometh","message":"zsoc: jaawerth: is this sensical? https://github.com/stevenvachon/todo-express/blob/master/scripts/createdb.js#L28","date":"2017-06-21T03:03:36.773Z","type":"message"}
{"nick":"mochiyoda_","reason":"Quit: Konversation terminated!","date":"2017-06-21T03:03:41.721Z","type":"quit"}
{"nick":"zsoc","message":"prometh: yeah, good enough imo","date":"2017-06-21T03:03:56.259Z","type":"message"}
{"nick":"jaawerth","message":"yeah","date":"2017-06-21T03:04:07.255Z","type":"message"}
{"nick":"prometh","message":"cool, thank you(s)","date":"2017-06-21T03:04:11.207Z","type":"message"}
{"nick":"zsoc","message":"besides your hideous brace on new line :>","date":"2017-06-21T03:04:12.245Z","type":"message"}
{"nick":"prometh","message":";)","date":"2017-06-21T03:04:16.711Z","type":"message"}
{"nick":"quantik","date":"2017-06-21T03:04:19.748Z","type":"join"}
{"nick":"prometh","message":"it's beautiful!","date":"2017-06-21T03:04:20.608Z","type":"message"}
{"nick":"leptone","date":"2017-06-21T03:04:25.523Z","type":"join"}
{"nick":"jaawerth","message":"btw, for init scripts and stuff knex is pretty great to use with async/await","date":"2017-06-21T03:04:34.504Z","type":"message"}
{"nick":"jaawerth","message":"await knex.doAThing(); // OH HEY IT DID THE THING","date":"2017-06-21T03:04:51.851Z","type":"message"}
{"nick":"zsoc","message":"ovsh: ok so just don't do the fetch first","date":"2017-06-21T03:05:00.397Z","type":"message"}
{"nick":"mochiyoda_","date":"2017-06-21T03:05:10.664Z","type":"join"}
{"nick":"prometh","message":"oh yeah, i forgot about async/await... and this project is latest and greatest too, so i could do it","date":"2017-06-21T03:05:23.969Z","type":"message"}
{"nick":"jaawerth","message":"I use all async functions with my knex migrations, it's awesomely readable","date":"2017-06-21T03:05:25.625Z","type":"message"}
{"nick":"zsoc","message":"ovsh: Project.forge({ projectID: '12345' }).save(req.body, { patch: true })","date":"2017-06-21T03:05:31.049Z","type":"message"}
{"nick":"prometh","message":"will try it","date":"2017-06-21T03:05:36.834Z","type":"message"}
{"nick":"zsoc","action":"enjoys his knex migrations with promises","date":"2017-06-21T03:05:49.981Z","type":"action"}
{"nick":"jaawerth","message":"hey it's still promises, lol","date":"2017-06-21T03:06:05.608Z","type":"message"}
{"nick":"zsoc","message":"i just like the way they look because i'm stubborn as a mule","date":"2017-06-21T03:06:21.709Z","type":"message"}
{"nick":"ovsh","message":"zsoc, let me try...","date":"2017-06-21T03:06:28.767Z","type":"message"}
{"nick":"zsoc","message":"like all the callback diehards in core that have taken years to come around to promises","date":"2017-06-21T03:06:30.922Z","type":"message"}
{"nick":"jaawerth","message":"heh","date":"2017-06-21T03:06:44.918Z","type":"message"}
{"nick":"prometh","message":"is a createdb script still considered a \"migration\" ?","date":"2017-06-21T03:06:53.159Z","type":"message"}
{"nick":"prometh","message":"i'm not really migrating from anything","date":"2017-06-21T03:06:59.531Z","type":"message"}
{"nick":"zsoc","message":"eh... no","date":"2017-06-21T03:07:01.100Z","type":"message"}
{"nick":"jaawerth","message":"I'm usually also resisting to async/await and like predefining my functions so I can do foo.doAThing().then(doAnotherThing)","date":"2017-06-21T03:07:05.561Z","type":"message"}
{"nick":"zsoc","message":"this is like.. some script that runs a create script heh","date":"2017-06-21T03:07:08.175Z","type":"message"}
{"nick":"ovsh","message":"zsoc, wait so without bookshelf.js, that;s what you would do on knex?","date":"2017-06-21T03:07:15.769Z","type":"message"}
{"nick":"prometh","message":":)","date":"2017-06-21T03:07:16.055Z","type":"message"}
{"nick":"ovsh","message":"why does knex seem so much simpler?","date":"2017-06-21T03:07:20.930Z","type":"message"}
{"nick":"jaawerth","message":"but for migrations and other imperative tasks, the imperative style of async/await is nice","date":"2017-06-21T03:07:29.578Z","type":"message"}
{"nick":"jaawerth","message":"ovsh: knex is just a querybuilder, it doesn't add the extra layer of abstraction you get form an orm","date":"2017-06-21T03:07:49.768Z","type":"message"}
{"nick":"zsoc","message":"ovsh: yeah well.. one of the differences is there's no \"Models\", so you can't just shove req.body in there","date":"2017-06-21T03:07:50.998Z","type":"message"}
{"nick":"zsoc","message":"ovsh: you've have to like.. validate that all the fields were right or map them (like { some_data: someData })","date":"2017-06-21T03:08:13.219Z","type":"message"}
{"nick":"ovsh","message":"zsoc, so how would you do it in knex? one by one?","date":"2017-06-21T03:08:14.503Z","type":"message"}
{"nick":"zsoc","message":"ovsh: what does your req.body look like here?","date":"2017-06-21T03:08:22.022Z","type":"message"}
{"nick":"ovsh","message":"{ some_data: someData, someData2: someData2 } etc","date":"2017-06-21T03:08:35.541Z","type":"message"}
{"nick":"ovsh","message":"Should work","date":"2017-06-21T03:08:41.288Z","type":"message"}
{"nick":"ovsh","message":"(from the examples I saw on bookshelf.js)","date":"2017-06-21T03:08:47.833Z","type":"message"}
{"nick":"qard","date":"2017-06-21T03:09:22.604Z","type":"join"}
{"nick":"mr-foobar","date":"2017-06-21T03:09:26.603Z","type":"join"}
{"nick":"ChALkeR","reason":"Ping timeout: 240 seconds","date":"2017-06-21T03:10:05.641Z","type":"quit"}
{"nick":"zsoc","message":"so.. you could do like `const { someData: some_data, otherData: other_data } = req.body; return knex('projects').update({ some_data, other_data }).where('projects.project_id', projectId)","date":"2017-06-21T03:10:10.389Z","type":"message"}
{"nick":"ovsh","message":"Why are all solutions in JS so hairy?","date":"2017-06-21T03:11:00.202Z","type":"message"}
{"nick":"zsoc","message":"they're.. not really","date":"2017-06-21T03:11:07.828Z","type":"message"}
{"nick":"zsoc","message":"you should just validate the crap","date":"2017-06-21T03:11:12.779Z","type":"message"}
{"nick":"zsoc","message":"i mean technically you should do knex('projects').update(req.body) but you'd have to have some middleware validating what req.body was heh","date":"2017-06-21T03:11:57.213Z","type":"message"}
{"nick":"jaawerth","message":"ovsh: looks like your issue in bookshelf might be related to https://github.com/tgriesser/bookshelf/issues/642","date":"2017-06-21T03:12:00.530Z","type":"message"}
{"nick":"ovsh","message":"zsoc, jaawerth, look at this dude L60:https://blog.ragingflame.co.za/2014/12/16/building-a-simple-api-with-express-and-bookshelfjs","date":"2017-06-21T03:12:24.264Z","type":"message"}
{"nick":"ovsh","message":"jaawerth, let me look, thanks!","date":"2017-06-21T03:12:32.333Z","type":"message"}
{"nick":"zsoc","message":"i.. don't think that's his issue","date":"2017-06-21T03:12:49.390Z","type":"message"}
{"nick":"jaawerth","message":"no?","date":"2017-06-21T03:12:54.612Z","type":"message"}
{"nick":"ovsh","message":"jaawerth, yeah I dont think so either","date":"2017-06-21T03:13:18.878Z","type":"message"}
{"nick":"zsoc","message":"what is require: true","date":"2017-06-21T03:13:27.540Z","type":"message"}
{"nick":"zsoc","message":"in fetch","date":"2017-06-21T03:13:28.397Z","type":"message"}
{"nick":"ovsh","message":"zsoc, is my syntax any different than dude L60?","date":"2017-06-21T03:13:32.604Z","type":"message"}
{"nick":"ovsh","message":"let me see","date":"2017-06-21T03:13:37.398Z","type":"message"}
{"nick":"jaawerth","message":"the idAttribute in your .forge isn't snake-cased","date":"2017-06-21T03:13:47.697Z","type":"message"}
{"nick":"jaawerth","message":"did you share the model definition already?","date":"2017-06-21T03:13:55.423Z","type":"message"}
{"nick":"ovsh","message":"Doesnt seem major","date":"2017-06-21T03:13:58.618Z","type":"message"}
{"nick":"ovsh","message":"[require=false] boolean","date":"2017-06-21T03:13:59.045Z","type":"message"}
{"nick":"ovsh","message":"Rejects the returned promise with an Collection.EmptyError if no records are returned.","date":"2017-06-21T03:13:59.188Z","type":"message"}
{"nick":"zsoc","message":"well it's a problem if it's not returning anything lol","date":"2017-06-21T03:14:17.689Z","type":"message"}
{"nick":"ovsh","message":"jaawerth, what do you mean?","date":"2017-06-21T03:14:17.974Z","type":"message"}
{"nick":"jaawerth","message":"the definition of your Projects model","date":"2017-06-21T03:14:27.860Z","type":"message"}
{"nick":"zsoc","message":"ovsh: between lines 5 and 6 there... i think \"project\" is undefined or w/e","date":"2017-06-21T03:14:50.662Z","type":"message"}
{"nick":"zsoc","message":"without required:true, you can end up on that line even tho the fetch didn't find anything","date":"2017-06-21T03:15:03.745Z","type":"message"}
{"nick":"ovsh","message":"jaawerth, yeah the only reason I can use Project is because it's imported","date":"2017-06-21T03:15:04.333Z","type":"message"}
{"nick":"zsoc","message":"no he means he wants to SEE the definition","date":"2017-06-21T03:15:15.671Z","type":"message"}
{"nick":"zsoc","message":"how projectID is defined in your model","date":"2017-06-21T03:15:22.068Z","type":"message"}
{"nick":"prometh","message":"how do i grant db access to a db user with knex? raw() again?","date":"2017-06-21T03:15:23.353Z","type":"message"}
{"nick":"ovsh","message":"zsoc, but project is part of the function(project) on those lines","date":"2017-06-21T03:15:28.239Z","type":"message"}
{"nick":"clearcut","reason":"Quit: Leaving","date":"2017-06-21T03:15:33.145Z","type":"quit"}
{"nick":"ovsh","message":"Oh","date":"2017-06-21T03:15:33.927Z","type":"message"}
{"nick":"jaawerth","message":"prometh: yeah, with GRANT and whatever permissions you wanna grant","date":"2017-06-21T03:15:46.606Z","type":"message"}
{"nick":"ovsh","message":"it's a primary key?","date":"2017-06-21T03:15:46.748Z","type":"message"}
{"nick":"zsoc","message":"ovsh: function(project) on that line is the return value from the forge fetch()","date":"2017-06-21T03:15:50.070Z","type":"message"}
{"nick":"prometh","message":"jaawerth: thanks","date":"2017-06-21T03:15:58.562Z","type":"message"}
{"nick":"ovsh","message":"zsoc,  yeah it's the actual project","date":"2017-06-21T03:16:07.173Z","type":"message"}
{"nick":"zsoc","message":"ovsh: it's very unlikely that you have a key named projectID... it's likely id or project_id, no?","date":"2017-06-21T03:16:09.936Z","type":"message"}
{"nick":"ovsh","message":"zsoc, I named it projectID... :x","date":"2017-06-21T03:16:23.355Z","type":"message"}
{"nick":"ovsh","message":"zsoc, rip?","date":"2017-06-21T03:16:31.819Z","type":"message"}
{"nick":"zsoc","message":"so you're saying that if you console.log(project) between lines 5 and 6... you have a project that was properly fetched?","date":"2017-06-21T03:16:37.797Z","type":"message"}
{"nick":"ovsh","message":"zsoc, %rip %rsp %rbp","date":"2017-06-21T03:16:38.939Z","type":"message"}
{"nick":"ovsh","message":"Let me try","date":"2017-06-21T03:16:44.069Z","type":"message"}
{"nick":"zsoc","message":"and yes that's not a thing in rdbms... lowercase and snake case all the things :p","date":"2017-06-21T03:16:51.092Z","type":"message"}
{"nick":"zsoc","message":"in which case if that's the actual problem, the jaawerth was right and that was your issue heh","date":"2017-06-21T03:17:02.528Z","type":"message"}
{"nick":"ovsh","message":"Oh snap","date":"2017-06-21T03:17:46.405Z","type":"message"}
{"nick":"zsoc","message":"although honestly that sql query looks fine","date":"2017-06-21T03:17:46.833Z","type":"message"}
{"nick":"ovsh","message":"Hmmm.","date":"2017-06-21T03:17:51.101Z","type":"message"}
{"nick":"zsoc","message":"oh snap what?","date":"2017-06-21T03:17:55.206Z","type":"message"}
{"nick":"ovsh","message":"zsoc, Oh snap if that's my problem","date":"2017-06-21T03:18:02.097Z","type":"message"}
{"nick":"ovsh","message":"Let me see....","date":"2017-06-21T03:18:06.089Z","type":"message"}
{"nick":"zsoc","message":"I mean it's physically possibly to use \"projects\".\"projectID\"","date":"2017-06-21T03:18:07.231Z","type":"message"}
{"nick":"zsoc","message":"it's just uncommon for a number of reasons","date":"2017-06-21T03:18:14.973Z","type":"message"}
{"nick":"zsoc","message":"I find it strange that your error doesn't include the actual thing it's erroring on","date":"2017-06-21T03:18:33.347Z","type":"message"}
{"nick":"ovsh","message":"zsoc, oooohh! new error!","date":"2017-06-21T03:18:45.115Z","type":"message"}
{"nick":"ovsh","message":"I addded the require true","date":"2017-06-21T03:18:47.554Z","type":"message"}
{"nick":"ovsh","message":"And now we're getting this:","date":"2017-06-21T03:18:52.721Z","type":"message"}
{"nick":"zsoc","message":"gist please don't paste","date":"2017-06-21T03:19:00.174Z","type":"message"}
{"nick":"zsoc","message":"lol","date":"2017-06-21T03:19:00.602Z","type":"message"}
{"nick":"jaawerth","message":"in the actual db (with postgres anyway), if you have uppercase chars in your column names you have to wrap quotes around them every time. super annoying to work with directly, lol","date":"2017-06-21T03:19:11.395Z","type":"message"}
{"nick":"ovsh","message":"zsoc, ofc https://gist.github.com/ovsh/dc3f69ec9fccd5be2acd83aca66875e9","date":"2017-06-21T03:19:38.102Z","type":"message"}
{"nick":"zsoc","message":"yes but... in theory the abstractions should do their job :p","date":"2017-06-21T03:19:40.359Z","type":"message"}
{"nick":"jaawerth","message":"bookshelf does a parse/format thing under the hood to let you use camelCase in the model and snake case in the db but evidently it's got bugs and isn't applying pasre/format across the board","date":"2017-06-21T03:19:54.347Z","type":"message"}
{"nick":"zsoc","message":"uh what","date":"2017-06-21T03:19:55.671Z","type":"message"}
{"nick":"ovsh","message":"does this look like its a camelcase issue?","date":"2017-06-21T03:20:02.051Z","type":"message"}
{"nick":"zsoc","message":"ovsh: no no, you don't add require in the forge, you add it in the fetch","date":"2017-06-21T03:20:16.084Z","type":"message"}
{"nick":"ovsh","message":"zsoc, shit sorry that first part of the code is the old one","date":"2017-06-21T03:20:28.304Z","type":"message"}
{"nick":"zsoc","message":"you didn't update your code example btw","date":"2017-06-21T03:20:30.158Z","type":"message"}
{"nick":"zsoc","message":"yep","date":"2017-06-21T03:20:31.485Z","type":"message"}
{"nick":"zsoc","message":"also i can tell you what the new (wrong) code is by the error","date":"2017-06-21T03:20:38.377Z","type":"message"}
{"nick":"zsoc","message":"you added require as a forge value lol","date":"2017-06-21T03:20:45.165Z","type":"message"}
{"nick":"quantik","reason":"Quit: quit","date":"2017-06-21T03:21:04.241Z","type":"quit"}
{"nick":"ovsh","message":"Updated now: https://gist.github.com/ovsh/dc3f69ec9fccd5be2acd83aca66875e9","date":"2017-06-21T03:21:10.165Z","type":"message"}
{"nick":"ovsh","message":"Wait what.","date":"2017-06-21T03:21:20.013Z","type":"message"}
{"nick":"ovsh","message":"No way","date":"2017-06-21T03:21:20.973Z","type":"message"}
{"nick":"zsoc","message":"yeah you are trying to save 'require'....","date":"2017-06-21T03:21:29.253Z","type":"message"}
{"nick":"ovsh","message":"I added require to save","date":"2017-06-21T03:21:29.538Z","type":"message"}
{"nick":"quantik","date":"2017-06-21T03:21:33.825Z","type":"join"}
{"nick":"zsoc","message":"require is a fetch thing","date":"2017-06-21T03:21:35.393Z","type":"message"}
{"nick":"zsoc","message":"if you're not fetching you don't need it","date":"2017-06-21T03:21:39.724Z","type":"message"}
{"nick":"ovsh","message":"jesus christ","date":"2017-06-21T03:21:43.060Z","type":"message"}
{"nick":"ovsh","message":"lol","date":"2017-06-21T03:21:45.224Z","type":"message"}
{"nick":"ovsh","message":"zsoc, so wait, I still need save though, right?","date":"2017-06-21T03:22:15.149Z","type":"message"}
{"nick":"zsoc","message":"y... yes? i assume you want to save the data.. it's a PUT request lol","date":"2017-06-21T03:22:31.763Z","type":"message"}
{"nick":"microdex","reason":"Remote host closed the connection","date":"2017-06-21T03:22:48.284Z","type":"quit"}
{"nick":"prometh","message":"does this look right? (it doesn't error, but i'm new) :","date":"2017-06-21T03:22:51.851Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"revoke connect on database ?? from public\", name))","date":"2017-06-21T03:22:52.745Z","type":"message"}
{"nick":"prometh","message":".then(() => psql.raw(\"grant all on database ?? to ??\", [name, user]))","date":"2017-06-21T03:22:52.888Z","type":"message"}
{"nick":"microdex","date":"2017-06-21T03:23:22.693Z","type":"join"}
{"nick":"ovsh","message":"zsoc,  lol :p","date":"2017-06-21T03:23:46.578Z","type":"message"}
{"nick":"jaawerth","message":"prometh: yeah but I would recommend putting in specific permissions - you probably don't want to grant the \"grant\" permission, for example","date":"2017-06-21T03:24:29.713Z","type":"message"}
{"nick":"prometh","message":"oh","date":"2017-06-21T03:24:39.975Z","type":"message"}
{"nick":"prometh","message":"thank you","date":"2017-06-21T03:24:42.294Z","type":"message"}
{"nick":"zsoc","message":"ovsh: why can't you just Project.save(Object.assign({ projectID: \"12345\" }, req.body), { method: 'update' })","date":"2017-06-21T03:25:30.457Z","type":"message"}
{"nick":"ovsh","message":"zsoc,  let me try that","date":"2017-06-21T03:25:49.135Z","type":"message"}
{"nick":"zsoc","message":"instead of jumping through all of those hoops of forge a new model, fetch the matching something from the data base... save the existing something with new data","date":"2017-06-21T03:25:51.994Z","type":"message"}
{"nick":"ovsh","message":"zsoc, because I got a new fresh error","date":"2017-06-21T03:25:54.145Z","type":"message"}
{"nick":"prometh","message":"jaawerth: hmm, i can't find \"grant\" permission","date":"2017-06-21T03:25:55.144Z","type":"message"}
{"nick":"prometh","message":"tehse roles all sound fine to me: https://www.postgresql.org/docs/9.0/static/sql-grant.html","date":"2017-06-21T03:27:07.623Z","type":"message"}
{"nick":"microdex","reason":"Ping timeout: 240 seconds","date":"2017-06-21T03:27:31.605Z","type":"quit"}
{"nick":"zsoc","message":"ovsh: and if that doesn't work, then just do oProject.forge({ projectID: '12345' }).save(req.body) without all the other gobblygook","date":"2017-06-21T03:27:45.826Z","type":"message"}
{"nick":"jaawerth","message":"prometh: oh my bad, that's different - allowing grant is \"WITH GRANT OPTION\" (which lets a user grant a permission it receives to others in turn), always forget that, lol","date":"2017-06-21T03:28:07.633Z","type":"message"}
{"nick":"prometh","message":"ah :)","date":"2017-06-21T03:28:19.661Z","type":"message"}
{"nick":"jaawerth","message":"prometh: if all roles work, then 'all' it is, just thought you should check","date":"2017-06-21T03:28:22.060Z","type":"message"}
{"nick":"zsoc","message":"ovsh: also.. don't these things return promises? like shouldn't you be doing *return* project.save(), in your example?","date":"2017-06-21T03:28:22.346Z","type":"message"}
{"nick":"prometh","message":"jaawerth: yep, and i hadn't","date":"2017-06-21T03:28:31.416Z","type":"message"}
{"nick":"jaawerth","reason":"\"Leaving\"","date":"2017-06-21T03:28:41.135Z","type":"part"}
{"nick":"jaawerth","date":"2017-06-21T03:28:43.778Z","type":"join"}
{"nick":"jaawerth","message":"whoops","date":"2017-06-21T03:28:45.867Z","type":"message"}
{"nick":"prometh","message":"it's late and i'm rushing a bit","date":"2017-06-21T03:29:05.572Z","type":"message"}
{"nick":"jaawerth","message":"hehe yeah I should head to bed","date":"2017-06-21T03:29:11.736Z","type":"message"}
{"nick":"prometh","message":"thanks for all the help!","date":"2017-06-21T03:30:37.203Z","type":"message"}
{"nick":"caryhartline","date":"2017-06-21T03:30:49.009Z","type":"join"}
{"nick":"leptone","reason":"Remote host closed the connection","date":"2017-06-21T03:31:09.419Z","type":"quit"}
{"nick":"jaawerth","message":"np, night","date":"2017-06-21T03:31:26.469Z","type":"message"}
{"nick":"shesek","reason":"Ping timeout: 240 seconds","date":"2017-06-21T03:32:27.816Z","type":"quit"}
{"nick":"ovsh","message":"zsoc, I'll try all of that. Thanks again zsoc the king.","date":"2017-06-21T03:32:48.292Z","type":"message"}
{"nick":"zsoc","message":"rofl","date":"2017-06-21T03:32:57.196Z","type":"message"}
{"nick":"zsoc","message":"ovsh: i'd be curious of the errors from either tho","date":"2017-06-21T03:33:12.926Z","type":"message"}
{"nick":"zsoc","message":"and maybe if you want to stick with an orm, Objection.js might be a more sane option. Otherwise just dropping down to knex and handling the column / field name transformations in middleware","date":"2017-06-21T03:33:46.503Z","type":"message"}
{"nick":"windragon","reason":"Ping timeout: 268 seconds","date":"2017-06-21T03:35:30.887Z","type":"quit"}
{"nick":"windragon","date":"2017-06-21T03:37:31.077Z","type":"join"}
{"nick":"caryhartline","reason":"Quit: Leaving.","date":"2017-06-21T03:38:32.625Z","type":"quit"}
{"nick":"howdoi","date":"2017-06-21T03:40:12.108Z","type":"join"}
{"nick":"m31271n","reason":"Remote host closed the connection","date":"2017-06-21T03:42:05.953Z","type":"quit"}
{"nick":"alvinhochun","date":"2017-06-21T03:42:06.844Z","type":"join"}
{"nick":"windragon","reason":"Ping timeout: 268 seconds","date":"2017-06-21T03:42:17.886Z","type":"quit"}
{"nick":"alvinhochun","new_nick":"windragon","date":"2017-06-21T03:42:36.401Z","type":"nick"}
{"nick":"Cabanossi","reason":"Ping timeout: 246 seconds","date":"2017-06-21T03:42:53.600Z","type":"quit"}
{"nick":"m31271n","date":"2017-06-21T03:43:05.619Z","type":"join"}
{"nick":"Cabanossi","date":"2017-06-21T03:43:58.328Z","type":"join"}
{"nick":"cagedwisdom","date":"2017-06-21T03:49:04.101Z","type":"join"}
{"nick":"m31271n","reason":"Ping timeout: 240 seconds","date":"2017-06-21T03:50:01.638Z","type":"quit"}
{"nick":"chipping","reason":"Ping timeout: 268 seconds","date":"2017-06-21T03:50:18.865Z","type":"quit"}
{"nick":"m31271n","date":"2017-06-21T03:50:35.805Z","type":"join"}
{"nick":"zsoc","message":"ugh, why","date":"2017-06-21T03:50:43.341Z","type":"message"}
{"nick":"zsoc","message":"why when transpiling import * as foo from 'foo'; the export function is on foo.default ?","date":"2017-06-21T03:50:58.844Z","type":"message"}
{"nick":"quantik","reason":"Quit: quit","date":"2017-06-21T03:51:20.808Z","type":"quit"}
{"nick":"systemfault","message":"o_O That syntax doesn't use .default","date":"2017-06-21T03:51:34.845Z","type":"message"}
{"nick":"zsoc","message":"yeah that's the... ooooohhhhh","date":"2017-06-21T03:51:46.088Z","type":"message"}
{"nick":"zsoc","message":"this is a babel fail","date":"2017-06-21T03:51:50.261Z","type":"message"}
{"nick":"quantik","date":"2017-06-21T03:51:54.782Z","type":"join"}
{"nick":"systemfault","message":"It just returns all the \"normal exports\" attached to foo","date":"2017-06-21T03:51:58.647Z","type":"message"}
{"nick":"chipping","date":"2017-06-21T03:51:59.932Z","type":"join"}
{"nick":"systemfault","message":"Ahh ok","date":"2017-06-21T03:52:00.361Z","type":"message"}
{"nick":"zsoc","message":"hmm","date":"2017-06-21T03:52:16.344Z","type":"message"}
{"nick":"zsoc","message":"the package is taking advantage of require global","date":"2017-06-21T03:52:39.665Z","type":"message"}
{"nick":"zsoc","message":"and monkey patching itself onto it","date":"2017-06-21T03:52:43.847Z","type":"message"}
{"nick":"inflames","date":"2017-06-21T03:53:18.122Z","type":"join"}
{"nick":"zsoc","message":"maybe then i should just import * as decache but then use require.decache instead of decache.default heh","date":"2017-06-21T03:53:20.238Z","type":"message"}
{"nick":"MINIMAN10000_","date":"2017-06-21T03:53:47.980Z","type":"join"}
{"nick":"systemfault","message":"If you want .default, you'd just do \"import Foo from 'foo';","date":"2017-06-21T03:54:23.257Z","type":"message"}
{"nick":"systemfault","message":"No?","date":"2017-06-21T03:54:26.123Z","type":"message"}
{"nick":"zsoc","message":"normally yes but this package isn't using esm syntax or anything","date":"2017-06-21T03:54:55.815Z","type":"message"}
{"nick":"zsoc","message":"wait why.. did that work","date":"2017-06-21T03:55:59.337Z","type":"message"}
{"nick":"MINIMAN10000__","date":"2017-06-21T03:56:00.189Z","type":"join"}
{"nick":"zsoc","message":"alright i think it's too late for me to be doing this lol","date":"2017-06-21T03:56:05.245Z","type":"message"}
{"nick":"zsoc","message":"systemfault: thanks :p","date":"2017-06-21T03:56:08.726Z","type":"message"}
{"nick":"prometh","message":"is it considered crazy to supply a clearbd script for removing an app's db and user(s) ?","date":"2017-06-21T03:56:18.275Z","type":"message"}
{"nick":"MINIMAN10000","reason":"Ping timeout: 260 seconds","date":"2017-06-21T03:56:40.286Z","type":"quit"}
{"nick":"prometh","message":"sometimes it's easier to just start with a clean slate multiple times during dev","date":"2017-06-21T03:56:45.500Z","type":"message"}
{"nick":"leptone","date":"2017-06-21T03:56:46.536Z","type":"join"}
{"nick":"systemfault","message":"I don't see that as crazy, just warn the user when the script is run before doing anything.","date":"2017-06-21T03:57:00.938Z","type":"message"}
{"nick":"prometh","message":"and opening psql terminal can be annoying","date":"2017-06-21T03:57:03.226Z","type":"message"}
{"nick":"prometh","message":"cool","date":"2017-06-21T03:57:11.730Z","type":"message"}
{"nick":"systemfault","message":"And be sure it doesn't have prod credentials hardcoded or something.","date":"2017-06-21T03:57:21.486Z","type":"message"}
{"nick":"prometh","message":"yep, pulls from .env","date":"2017-06-21T03:57:36.177Z","type":"message"}
{"nick":"ohmyfromage","reason":"Ping timeout: 260 seconds","date":"2017-06-21T03:58:32.902Z","type":"quit"}
{"nick":"MINIMAN10000_","reason":"Ping timeout: 255 seconds","date":"2017-06-21T03:59:10.999Z","type":"quit"}
{"nick":"doomhz","date":"2017-06-21T04:04:52.104Z","type":"join"}
{"nick":"caryhartline","date":"2017-06-21T04:04:54.435Z","type":"join"}
{"nick":"horsey","date":"2017-06-21T04:06:58.433Z","type":"join"}
{"nick":"jaawerth","message":"prometh: (can't sleep yet) you might consider using knex migrations for this - you can still source dotenv and prompt for stuff from the migration","date":"2017-06-21T04:08:12.542Z","type":"message"}
{"nick":"jaawerth","message":"you can largely reuse the same script, just wrapping the setup stuff in a module.exports.up = function(knex, Promise) { }","date":"2017-06-21T04:09:11.840Z","type":"message"}
{"nick":"jaawerth","message":"and then adding a module.exports.down that reverses it","date":"2017-06-21T04:09:24.244Z","type":"message"}
{"nick":"doomhz","reason":"Ping timeout: 260 seconds","date":"2017-06-21T04:09:38.141Z","type":"quit"}
{"nick":"prometh","message":"hmm","date":"2017-06-21T04:10:23.749Z","type":"message"}
{"nick":"NomadJim_","reason":"Read error: Connection reset by peer","date":"2017-06-21T04:10:36.247Z","type":"quit"}
{"nick":"Elyx0","date":"2017-06-21T04:11:01.765Z","type":"join"}
{"nick":"zsoc","message":"so wait.. when you remove a resolved dep from require cache... why is the var still existing","date":"2017-06-21T04:11:02.337Z","type":"message"}
{"nick":"prometh","message":"zsoc: because you didn't remove the var","date":"2017-06-21T04:11:14.820Z","type":"message"}
{"nick":"jaawerth","message":"though.. sometimes you might want to keep the db dropping out of the migrations just to save yourself from silly mistakes","date":"2017-06-21T04:11:27.012Z","type":"message"}
{"nick":"prometh","message":"it hasn't been garbage collected because of that reference","date":"2017-06-21T04:11:28.227Z","type":"message"}
{"nick":"zsoc","message":"like if i have const foo = require('bar') in two different modules. If I delete the require cache from module A, the reference in the var itself will still exist?","date":"2017-06-21T04:11:34.575Z","type":"message"}
{"nick":"NomadJim_","date":"2017-06-21T04:11:35.717Z","type":"join"}
{"nick":"prometh","message":"jaawerth: why is a migration better for complete removal of the db ?","date":"2017-06-21T04:11:41.536Z","type":"message"}
{"nick":"zsoc","message":"so i can't like.. globally remove a var that's in module scope?","date":"2017-06-21T04:11:44.209Z","type":"message"}
{"nick":"GreenJello","message":"zsoc, I don't think the modules are ever GC'd","date":"2017-06-21T04:11:44.958Z","type":"message"}
{"nick":"prometh","message":"zsoc: correct","date":"2017-06-21T04:11:53.649Z","type":"message"}
{"nick":"jaawerth","message":"prometh: it might not be since reversing it is just dropping stuff","date":"2017-06-21T04:11:58.123Z","type":"message"}
{"nick":"GreenJello","message":"zsoc, I wrote an irc bot that cleared the cache on each message (don't ask), and it ran out of memory after some time","date":"2017-06-21T04:12:07.427Z","type":"message"}
{"nick":"lowercaseman","date":"2017-06-21T04:12:18.909Z","type":"join"}
{"nick":"zsoc","message":"suhfdushdfsf","date":"2017-06-21T04:12:24.156Z","type":"message"}
{"nick":"jaawerth","message":"prometh: I just like the whole rollback/roll forward paradigm","date":"2017-06-21T04:12:46.264Z","type":"message"}
{"nick":"prometh","message":"jaawerth: it sounds like migration changes are stored [in teh db?] too","date":"2017-06-21T04:12:50.196Z","type":"message"}
{"nick":"jaawerth","message":"it uses a table to track where you are in the migration","date":"2017-06-21T04:13:01.772Z","type":"message"}
{"nick":"GreenJello","message":"zsoc, also, you can't really delete things in js","date":"2017-06-21T04:13:07.731Z","type":"message"}
{"nick":"prometh","message":"jaawerth: totally, i think migrations make perfect sense for changes, btu perhaps not clearing","date":"2017-06-21T04:13:16.564Z","type":"message"}
{"nick":"jaawerth","message":"yeah","date":"2017-06-21T04:13:22.039Z","type":"message"}
{"nick":"zsoc","message":"well i need to for this test","date":"2017-06-21T04:13:24.153Z","type":"message"}
{"nick":"Cabanossi","reason":"Ping timeout: 264 seconds","date":"2017-06-21T04:13:34.287Z","type":"quit"}
{"nick":"GreenJello","message":"you can't","date":"2017-06-21T04:13:34.852Z","type":"message"}
{"nick":"GreenJello","message":"find another solution","date":"2017-06-21T04:13:38.086Z","type":"message"}
{"nick":"zsoc","action":"grumbles","date":"2017-06-21T04:13:42.190Z","type":"action"}
{"nick":"jaawerth","message":"I've had them reverse table creations before but I usually get paranoid and hide it behind a confirmation prompt that rejects if you don't explicitly say yes","date":"2017-06-21T04:13:44.160Z","type":"message"}
{"nick":"Cabanossi","date":"2017-06-21T04:13:50.139Z","type":"join"}
{"nick":"jaawerth","message":"in which case it's not always worth doing it at all","date":"2017-06-21T04:13:50.573Z","type":"message"}
{"nick":"jaawerth","message":"(unless you're creating new tables after the app is already a thing)","date":"2017-06-21T04:14:08.363Z","type":"message"}
{"nick":"prometh","message":"jaawerth: i've done a lot of manual db clearing in another project, so i foresee myself needing it when major changes are made","date":"2017-06-21T04:14:19.041Z","type":"message"}
{"nick":"prometh","message":"signing up, configuring, starting over, etc","date":"2017-06-21T04:14:34.359Z","type":"message"}
{"nick":"jaawerth","message":"yeah, in general I find migrations to be a godsend, and knex's are nice a clean","date":"2017-06-21T04:14:45.191Z","type":"message"}
{"nick":"Cohedrin_","reason":"Read error: Connection reset by peer","date":"2017-06-21T04:14:49.541Z","type":"quit"}
{"nick":"ovsh","message":"zsoc, so both gave me errors. one a missing column one, and the other another different thing","date":"2017-06-21T04:14:57.290Z","type":"message"}
{"nick":"ovsh","message":"sorry its late I'm half dead.","date":"2017-06-21T04:15:02.446Z","type":"message"}
{"nick":"MachinShin","reason":"Ping timeout: 276 seconds","date":"2017-06-21T04:15:06.876Z","type":"quit"}
{"nick":"zsoc","message":"np, another time","date":"2017-06-21T04:15:09.340Z","type":"message"}
{"nick":"ovsh","message":"zsoc, Bookshelf.js has 4k stars","date":"2017-06-21T04:15:11.091Z","type":"message"}
{"nick":"zsoc","message":"that doesn't mean anything","date":"2017-06-21T04:15:16.791Z","type":"message"}
{"nick":"zsoc","message":"mongoose has 12k","date":"2017-06-21T04:15:18.432Z","type":"message"}
{"nick":"ovsh","message":"but Objection.js looks good","date":"2017-06-21T04:15:19.922Z","type":"message"}
{"nick":"Cohedrin_","date":"2017-06-21T04:15:25.293Z","type":"join"}
{"nick":"prometh","message":"i've used migrations in ruby and python, but never wrote them","date":"2017-06-21T04:15:26.627Z","type":"message"}
{"nick":"ovsh","message":"with 1k stars","date":"2017-06-21T04:15:27.548Z","type":"message"}
{"nick":"zsoc","message":"stars are pointless","date":"2017-06-21T04:15:36.010Z","type":"message"}
{"nick":"zsoc","message":"unless there's 0","date":"2017-06-21T04:15:38.584Z","type":"message"}
{"nick":"ovsh","message":"How did you hear about Objection.js?","date":"2017-06-21T04:15:49.890Z","type":"message"}
{"nick":"jaawerth","message":"prometh: btw are you wrapping all this in a transaction? because if not, I'd suggest it","date":"2017-06-21T04:15:50.678Z","type":"message"}
{"nick":"prometh","message":"jaawerth: transaction?","date":"2017-06-21T04:15:58.647Z","type":"message"}
{"nick":"zsoc","message":"prometh: \"if any of these queries fail, roll back all the things\"","date":"2017-06-21T04:16:13.577Z","type":"message"}
{"nick":"zsoc","message":"one transaction","date":"2017-06-21T04:16:16.991Z","type":"message"}
{"nick":"prometh","message":"oh","date":"2017-06-21T04:16:24.742Z","type":"message"}
{"nick":"prometh","message":"no, adn hmm","date":"2017-06-21T04:16:28.346Z","type":"message"}
{"nick":"jaawerth","message":"prometh: or say the process dies somehow in the middle of setup, you'd probably want it not to have changed anything lest you have a db created with no user, or a user created with incomplete privilege settings or whatever","date":"2017-06-21T04:16:58.199Z","type":"message"}
{"nick":"zsoc","message":"pretty straight forward in knex... knex.transaction(function(trx) { ... and basically you treat 'trx' like your knex object.. start by returning it starting a chain and do all the things in that chain","date":"2017-06-21T04:17:17.567Z","type":"message"}
{"nick":"zsoc","message":"it only commits once everything returns sanely","date":"2017-06-21T04:17:24.395Z","type":"message"}
{"nick":"zsoc","message":"i seriously can't think how to do this","date":"2017-06-21T04:17:44.451Z","type":"message"}
{"nick":"zsoc","message":"i have a try/catch around a require block and i need to be able to run tests for _both_ cases","date":"2017-06-21T04:17:59.077Z","type":"message"}
{"nick":"prometh","message":"knex is powerful stuff","date":"2017-06-21T04:18:10.233Z","type":"message"}
{"nick":"jaawerth","message":"yeah knex's promise interface makes it really easy since it only commits when the promise you return resolves","date":"2017-06-21T04:18:16.893Z","type":"message"}
{"nick":"quantik","reason":"Ping timeout: 248 seconds","date":"2017-06-21T04:18:25.939Z","type":"quit"}
{"nick":"zsoc","message":"knex is sexy indeed... it has its issues tho.. but in general its pretty intense. A lot of it really is pg pulling the weight.. in some ways. But it's a strong stack","date":"2017-06-21T04:18:47.663Z","type":"message"}
{"nick":"jaawerth","message":"zsoc: so the test isn't whether it errors or not, it's tests that depend on whether it *has* errored?","date":"2017-06-21T04:19:08.103Z","type":"message"}
{"nick":"cads2","reason":"Ping timeout: 255 seconds","date":"2017-06-21T04:19:20.911Z","type":"quit"}
{"nick":"zsoc","message":"jaawerth: neither is really an error, the lib can run in either state.. i need to run tests that expect the results depending on the state","date":"2017-06-21T04:19:44.462Z","type":"message"}
{"nick":"jamie_p","date":"2017-06-21T04:19:54.589Z","type":"join"}
{"nick":"zsoc","message":"and also yeah, i need the code coverage from both branches lol","date":"2017-06-21T04:19:55.540Z","type":"message"}
{"nick":"prometh","message":"knex docs are a bit confusing.. what is `trx` and is transaction() a static function on the `knex` module ?","date":"2017-06-21T04:19:55.541Z","type":"message"}
{"nick":"zsoc","message":"but that's not as important","date":"2017-06-21T04:19:58.886Z","type":"message"}
{"nick":"zsoc","message":"prometh: 'trx' is 'the transaction', use it just like knex, you can trx.raw() etc.. and yes it's a static function","date":"2017-06-21T04:20:19.420Z","type":"message"}
{"nick":"prometh","message":"where is the connection made, though?","date":"2017-06-21T04:20:31.690Z","type":"message"}
{"nick":"orbyt_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T04:20:48.782Z","type":"quit"}
{"nick":"jaawerth","message":"it's using the connection you already got when you instantiated","date":"2017-06-21T04:20:55.382Z","type":"message"}
{"nick":"prometh","message":"knex = require(\"knex\")  // ?","date":"2017-06-21T04:21:00.615Z","type":"message"}
{"nick":"Hoffman","reason":"Ping timeout: 246 seconds","date":"2017-06-21T04:21:02.517Z","type":"quit"}
{"nick":"prometh","message":"or knex = knex(config)  // ?","date":"2017-06-21T04:21:10.115Z","type":"message"}
{"nick":"jaawerth","message":"Knex(config)","date":"2017-06-21T04:21:16.953Z","type":"message"}
{"nick":"prometh","message":"ah, ok","date":"2017-06-21T04:21:21.184Z","type":"message"}
{"nick":"zsoc","message":"prometh: every knex query is a transaction anyway.. the only difference here is you can 'do multiple things' in this one","date":"2017-06-21T04:21:22.882Z","type":"message"}
{"nick":"zsoc","message":"'transactions' are a feature of rdbms.. one of the main ones actually","date":"2017-06-21T04:21:35.968Z","type":"message"}
{"nick":"zsoc","message":"\"take $100 from joe's account\", \"put 100$ in mary's account\", \"update some registry of data\"","date":"2017-06-21T04:21:55.527Z","type":"message"}
{"nick":"smccarthy","date":"2017-06-21T04:21:58.810Z","type":"quit"}
{"nick":"zsoc","message":"if any one of those things fails, that's bad... that's sort of the whole idea behind why sql is a thing","date":"2017-06-21T04:22:10.311Z","type":"message"}
{"nick":"prometh","message":"interesting","date":"2017-06-21T04:22:39.631Z","type":"message"}
{"nick":"mr-foobar","reason":"Ping timeout: 240 seconds","date":"2017-06-21T04:23:05.521Z","type":"quit"}
{"nick":"zsoc","message":"\"ACID\" and \"Transactions\" are why sql/rdbms is the powerhouse it is in the data world","date":"2017-06-21T04:23:11.555Z","type":"message"}
{"nick":"PhiSyX","reason":"Read error: Connection reset by peer","date":"2017-06-21T04:23:41.295Z","type":"quit"}
{"nick":"prometh","message":"did/does mongo have anything similar?","date":"2017-06-21T04:24:16.470Z","type":"message"}
{"nick":"zsoc","message":"no on both accounts","date":"2017-06-21T04:25:01.871Z","type":"message"}
{"nick":"zsoc","message":"unless you want to consider 'write concerns' a small part of acid but.. yeah, no","date":"2017-06-21T04:25:10.221Z","type":"message"}
{"nick":"mr-foobar","date":"2017-06-21T04:25:17.151Z","type":"join"}
{"nick":"jaawerth","message":"mongo has some atomic stuff but I've heard it's pretty limited","date":"2017-06-21T04:25:30.976Z","type":"message"}
{"nick":"jaawerth","message":"and it doesn't do full ACID","date":"2017-06-21T04:25:36.276Z","type":"message"}
{"nick":"systemfault","message":"PostgreSQL is a better mongo than mongo...","date":"2017-06-21T04:28:36.123Z","type":"message"}
{"nick":"systemfault","message":"Think about it.","date":"2017-06-21T04:28:39.318Z","type":"message"}
{"nick":"modernpacifist","message":"Mongo barely functioned safely in a cluster/HA environment until earlier this year","date":"2017-06-21T04:29:27.077Z","type":"message"}
{"nick":"zsoc","message":"1.) setup mongo, 2.) set up 1 table, 3.) set up 1 JSON column in said table","date":"2017-06-21T04:30:23.575Z","type":"message"}
{"nick":"zsoc","message":"bam, better mongo lol","date":"2017-06-21T04:30:25.885Z","type":"message"}
{"nick":"zsoc","message":"er.. obviously i meant postgres.. in that first.. line..","date":"2017-06-21T04:32:25.651Z","type":"message"}
{"nick":"zsoc","message":"yeah, sleep time","date":"2017-06-21T04:32:27.830Z","type":"message"}
{"nick":"prometh","message":"jaawerth: zsoc: error: CREATE DATABASE cannot run inside a transaction block","date":"2017-06-21T04:32:28.620Z","type":"message"}
{"nick":"zsoc","message":"night o/","date":"2017-06-21T04:32:29.673Z","type":"message"}
{"nick":"prometh","message":"poop :(","date":"2017-06-21T04:32:29.815Z","type":"message"}
{"nick":"zsoc","message":"prometh: oh?","date":"2017-06-21T04:32:35.695Z","type":"message"}
{"nick":"zsoc","message":"huh, well at least that error is very descriptive lol","date":"2017-06-21T04:32:44.042Z","type":"message"}
{"nick":"jaawerth","message":"whoops","date":"2017-06-21T04:32:46.347Z","type":"message"}
{"nick":"prometh","message":"yep :)","date":"2017-06-21T04:32:47.734Z","type":"message"}
{"nick":"zsoc","message":"you'll have to catch and rollback then","date":"2017-06-21T04:32:48.448Z","type":"message"}
{"nick":"jaawerth","message":"the other stuff (grants and user creation) should let you","date":"2017-06-21T04:32:57.440Z","type":"message"}
{"nick":"zsoc","message":"catch and delete the db i guess, and do everything else in a trx that you can","date":"2017-06-21T04:32:58.641Z","type":"message"}
{"nick":"jaawerth","message":"oh and table creation for sure","date":"2017-06-21T04:33:13.558Z","type":"message"}
{"nick":"prometh","message":"haven't done the table stuff yet","date":"2017-06-21T04:33:47.495Z","type":"message"}
{"nick":"prometh","message":"wonder if user works","date":"2017-06-21T04:33:54.165Z","type":"message"}
{"nick":"prometh","message":"seems to have","date":"2017-06-21T04:34:25.519Z","type":"message"}
{"nick":"jaawerth","message":"it does","date":"2017-06-21T04:34:43.284Z","type":"message"}
{"nick":"prometh","message":"yep","date":"2017-06-21T04:34:49.331Z","type":"message"}
{"nick":"JBreit","reason":"Quit: Leaving","date":"2017-06-21T04:34:49.902Z","type":"quit"}
{"nick":"jaawerth","message":"when I am tinkering with the db in the psql cli, I turn off autocommit so I can rollback stuff if I screw it up hehe","date":"2017-06-21T04:35:11.168Z","type":"message"}
{"nick":"jaawerth","message":"and I modify the prompt to tell me when I'm in an incomplete transaction - user creation definitely does, and allows rollback","date":"2017-06-21T04:35:49.901Z","type":"message"}
{"nick":"leptone","reason":"Remote host closed the connection","date":"2017-06-21T04:37:05.811Z","type":"quit"}
{"nick":"prometh","message":"i wish knex would abstract all of this for us","date":"2017-06-21T04:37:58.116Z","type":"message"}
{"nick":"jaawerth","message":"it's still a querybuilding, only cares about querybuilding","date":"2017-06-21T04:38:25.508Z","type":"message"}
{"nick":"jaawerth","message":"querybuilder*","date":"2017-06-21T04:38:29.698Z","type":"message"}
{"nick":"zsoc","message":"all of what?","date":"2017-06-21T04:38:35.731Z","type":"message"}
{"nick":"prometh","message":"https://github.com/tgriesser/knex/issues/2131","date":"2017-06-21T04:38:39.467Z","type":"message"}
{"nick":"zsoc","message":"it gives the right amount of control imo","date":"2017-06-21T04:38:40.504Z","type":"message"}
{"nick":"zsoc","message":"why am i still here","date":"2017-06-21T04:38:43.216Z","type":"message"}
{"nick":"prometh","message":"createdbIfNotExists()","date":"2017-06-21T04:38:52.006Z","type":"message"}
{"nick":"jaawerth","message":"I just wish it had something that let you extend it with custom methods without having to hack the API","date":"2017-06-21T04:39:00.148Z","type":"message"}
{"nick":"zsoc","message":"someone is going to tell you to use `pg-escape` lol","date":"2017-06-21T04:39:12.336Z","type":"message"}
{"nick":"prometh","message":":)","date":"2017-06-21T04:39:24.430Z","type":"message"}
{"nick":"prometh","message":"i should go to sleep.. not tired, but i have paying work tomorrow, heh","date":"2017-06-21T04:40:06.516Z","type":"message"}
{"nick":"led1","reason":"Quit: led1","date":"2017-06-21T04:40:24.280Z","type":"quit"}
{"nick":"prometh","message":"learning express and knex should be paying","date":"2017-06-21T04:40:25.562Z","type":"message"}
{"nick":"pilne","reason":"Quit: Quitting!","date":"2017-06-21T04:40:47.021Z","type":"quit"}
{"nick":"phpnode","date":"2017-06-21T04:42:07.532Z","type":"join"}
{"nick":"prometh","message":"if interested: https://github.com/stevenvachon/todo-express","date":"2017-06-21T04:44:51.942Z","type":"message"}
{"nick":"mr-foobar","reason":"Ping timeout: 260 seconds","date":"2017-06-21T04:45:48.118Z","type":"quit"}
{"nick":"zsoc","message":"pretty good stuff","date":"2017-06-21T04:45:56.137Z","type":"message"}
{"nick":"zsoc","message":"i'd hire you.. a linter on git hook would fix the problem with your code :p","date":"2017-06-21T04:46:15.986Z","type":"message"}
{"nick":"alex____1","date":"2017-06-21T04:46:36.166Z","type":"part"}
{"nick":"prometh","message":"heheh","date":"2017-06-21T04:47:21.852Z","type":"message"}
{"nick":"prometh","message":"bed time.. nite! thanks again!!","date":"2017-06-21T04:49:41.752Z","type":"message"}
{"nick":"mr-foobar","date":"2017-06-21T04:49:41.894Z","type":"join"}
{"nick":"prometh","reason":"Quit: My Mac Mini has gone to sleep. ZZZzzz…","date":"2017-06-21T04:49:52.742Z","type":"quit"}
{"nick":"foddo","reason":"Quit: Connection closed for inactivity","date":"2017-06-21T04:50:14.106Z","type":"quit"}
{"nick":"toi","date":"2017-06-21T04:50:18.316Z","type":"join"}
{"nick":"zxc","date":"2017-06-21T04:50:19.314Z","type":"join"}
{"nick":"leptone","date":"2017-06-21T04:50:20.580Z","type":"join"}
{"nick":"MachinShin","date":"2017-06-21T04:51:36.286Z","type":"join"}
{"nick":"MachinShin","reason":"Changing host","date":"2017-06-21T04:51:36.572Z","type":"quit"}
{"nick":"MachinShin","date":"2017-06-21T04:51:36.574Z","type":"join"}
{"nick":"m31271n","reason":"Remote host closed the connection","date":"2017-06-21T04:51:37.162Z","type":"quit"}
{"nick":"m31271n","date":"2017-06-21T04:52:37.161Z","type":"join"}
{"nick":"lpin","date":"2017-06-21T04:52:40.482Z","type":"join"}
{"nick":"kerigan","date":"2017-06-21T04:57:49.789Z","type":"join"}
{"nick":"marthinal","date":"2017-06-21T04:58:41.636Z","type":"join"}
{"nick":"kerigan","reason":"Client Quit","date":"2017-06-21T04:59:45.718Z","type":"quit"}
{"nick":"Aquazi","reason":"Quit: Leaving","date":"2017-06-21T05:05:04.971Z","type":"quit"}
{"nick":"barhum2013","date":"2017-06-21T05:05:18.662Z","type":"join"}
{"nick":"cagedwisdom","reason":"Ping timeout: 260 seconds","date":"2017-06-21T05:07:23.097Z","type":"quit"}
{"nick":"cagedwisdom","date":"2017-06-21T05:07:40.502Z","type":"join"}
{"nick":"invariant1729","date":"2017-06-21T05:08:03.517Z","type":"join"}
{"nick":"jeffaustin81","date":"2017-06-21T05:08:11.792Z","type":"join"}
{"nick":"darkSeid_","date":"2017-06-21T05:09:04.649Z","type":"join"}
{"nick":"rabbitea1","reason":"Ping timeout: 240 seconds","date":"2017-06-21T05:11:01.681Z","type":"quit"}
{"nick":"Cabanossi","reason":"Ping timeout: 276 seconds","date":"2017-06-21T05:11:39.910Z","type":"quit"}
{"nick":"matozoid","date":"2017-06-21T05:12:28.297Z","type":"join"}
{"nick":"Cabanossi","date":"2017-06-21T05:13:59.054Z","type":"join"}
{"nick":"roelmonnens","date":"2017-06-21T05:14:17.097Z","type":"join"}
{"nick":"devc","reason":"Quit: zzz...","date":"2017-06-21T05:15:55.222Z","type":"quit"}
{"nick":"darkSeid_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T05:16:05.874Z","type":"quit"}
{"nick":"armyriad","reason":"Quit: Leaving","date":"2017-06-21T05:16:43.346Z","type":"quit"}
{"nick":"armyriad","date":"2017-06-21T05:18:18.383Z","type":"join"}
{"nick":"roelmonnens","reason":"Ping timeout: 255 seconds","date":"2017-06-21T05:18:51.988Z","type":"quit"}
{"nick":"matozoid_","date":"2017-06-21T05:19:17.854Z","type":"join"}
{"nick":"asdasda","message":"wait","date":"2017-06-21T05:20:14.893Z","type":"message"}
{"nick":"matozoid","reason":"Ping timeout: 246 seconds","date":"2017-06-21T05:22:59.560Z","type":"quit"}
{"nick":"shailender","date":"2017-06-21T05:23:24.010Z","type":"join"}
{"nick":"led1","date":"2017-06-21T05:23:31.842Z","type":"join"}
{"nick":"Fleebox","reason":"Quit: Fleebox","date":"2017-06-21T05:23:55.852Z","type":"quit"}
{"nick":"shailender","reason":"Client Quit","date":"2017-06-21T05:24:03.495Z","type":"quit"}
{"nick":"ClusterXL","date":"2017-06-21T05:24:45.190Z","type":"join"}
{"nick":"ClusterXL","reason":"Client Quit","date":"2017-06-21T05:24:55.709Z","type":"quit"}
{"nick":"led1","reason":"Remote host closed the connection","date":"2017-06-21T05:24:55.997Z","type":"quit"}
{"nick":"qard","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T05:25:59.450Z","type":"quit"}
{"nick":"olalonde","reason":"Quit: Connection closed for inactivity","date":"2017-06-21T05:26:09.020Z","type":"quit"}
{"nick":"ClusterXL","date":"2017-06-21T05:26:24.175Z","type":"join"}
{"nick":"ClusterXL","reason":"Client Quit","date":"2017-06-21T05:26:25.560Z","type":"quit"}
{"nick":"T-2000","date":"2017-06-21T05:26:56.819Z","type":"join"}
{"nick":"led1","date":"2017-06-21T05:27:37.222Z","type":"join"}
{"nick":"slajax_","date":"2017-06-21T05:29:42.956Z","type":"join"}
{"nick":"Bock","date":"2017-06-21T05:30:24.502Z","type":"join"}
{"nick":"slajax","reason":"Ping timeout: 240 seconds","date":"2017-06-21T05:30:27.799Z","type":"quit"}
{"nick":"Lionel_Debroux_","reason":"Ping timeout: 240 seconds","date":"2017-06-21T05:30:35.546Z","type":"quit"}
{"nick":"slajax","date":"2017-06-21T05:32:08.280Z","type":"join"}
{"nick":"gwoztz","reason":"Quit: This computer has gone to sleep","date":"2017-06-21T05:32:22.739Z","type":"quit"}
{"nick":"slajax_","reason":"Ping timeout: 276 seconds","date":"2017-06-21T05:35:03.799Z","type":"quit"}
{"nick":"mochiyoda","date":"2017-06-21T05:42:55.850Z","type":"join"}
{"nick":"brent__","date":"2017-06-21T05:44:48.967Z","type":"join"}
{"nick":"jeffaustin81","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T05:45:05.453Z","type":"quit"}
{"nick":"m31271n","reason":"Ping timeout: 260 seconds","date":"2017-06-21T05:45:53.194Z","type":"quit"}
{"nick":"m31271n","date":"2017-06-21T05:46:06.493Z","type":"join"}
{"nick":"mochiyoda_","reason":"Ping timeout: 246 seconds","date":"2017-06-21T05:46:40.500Z","type":"quit"}
{"nick":"darkSeid_","date":"2017-06-21T05:47:03.946Z","type":"join"}
{"nick":"EyePulp","reason":"Remote host closed the connection","date":"2017-06-21T05:47:56.221Z","type":"quit"}
{"nick":"EyePulp","date":"2017-06-21T05:48:29.211Z","type":"join"}
{"nick":"brent__","reason":"Ping timeout: 246 seconds","date":"2017-06-21T05:49:14.606Z","type":"quit"}
{"nick":"invariant1729","reason":"Ping timeout: 240 seconds","date":"2017-06-21T05:52:01.531Z","type":"quit"}
{"nick":"hextileX","date":"2017-06-21T05:53:02.554Z","type":"join"}
{"nick":"notadeveloper","date":"2017-06-21T05:54:19.880Z","type":"join"}
{"nick":"invariant1729","date":"2017-06-21T05:55:24.637Z","type":"join"}
{"nick":"chipping","reason":"Ping timeout: 255 seconds","date":"2017-06-21T05:55:43.912Z","type":"quit"}
{"nick":"asdasda","reason":"Ping timeout: 240 seconds","date":"2017-06-21T05:56:01.575Z","type":"quit"}
{"nick":"chipping","date":"2017-06-21T05:56:39.502Z","type":"join"}
{"nick":"DeltaHeavy","reason":"Ping timeout: 260 seconds","date":"2017-06-21T05:56:58.175Z","type":"quit"}
{"nick":"nahtnam","reason":"Quit: Connection closed for inactivity","date":"2017-06-21T05:57:25.581Z","type":"quit"}
{"nick":"someone235","date":"2017-06-21T06:02:18.571Z","type":"join"}
{"nick":"f32","reason":"Remote host closed the connection","date":"2017-06-21T06:04:29.795Z","type":"quit"}
{"nick":"doomhz","date":"2017-06-21T06:05:45.945Z","type":"join"}
{"nick":"asteele","reason":"Ping timeout: 246 seconds","date":"2017-06-21T06:09:04.538Z","type":"quit"}
{"nick":"doomhz","reason":"Ping timeout: 255 seconds","date":"2017-06-21T06:10:34.867Z","type":"quit"}
{"nick":"groom","date":"2017-06-21T06:10:50.563Z","type":"join"}
{"nick":"fuzzybear3965","reason":"Ping timeout: 255 seconds","date":"2017-06-21T06:11:58.135Z","type":"quit"}
{"nick":"Cabanossi","reason":"Ping timeout: 246 seconds","date":"2017-06-21T06:11:59.613Z","type":"quit"}
{"nick":"bartmon","date":"2017-06-21T06:12:17.981Z","type":"join"}
{"nick":"mYD1","date":"2017-06-21T06:13:20.193Z","type":"join"}
{"nick":"Cabanossi","date":"2017-06-21T06:13:36.001Z","type":"join"}
{"nick":"^esc","reason":"Ping timeout: 258 seconds","date":"2017-06-21T06:16:15.673Z","type":"quit"}
{"nick":"zero1one0","date":"2017-06-21T06:16:36.161Z","type":"quit"}
{"nick":"qard","date":"2017-06-21T06:16:58.425Z","type":"join"}
{"nick":"doomhz","date":"2017-06-21T06:19:00.879Z","type":"join"}
{"nick":"tarkus","date":"2017-06-21T06:19:08.466Z","type":"join"}
{"nick":"roelmonnens","date":"2017-06-21T06:19:08.468Z","type":"join"}
{"nick":"roelmonnens","reason":"Remote host closed the connection","date":"2017-06-21T06:19:10.948Z","type":"quit"}
{"nick":"roelmonnens","date":"2017-06-21T06:19:39.036Z","type":"join"}
{"nick":"oohnoitz","reason":"Ping timeout: 276 seconds","date":"2017-06-21T06:21:45.497Z","type":"quit"}
{"nick":"oohnoitz-","date":"2017-06-21T06:21:45.928Z","type":"join"}
{"nick":"zero1one0","date":"2017-06-21T06:23:36.031Z","type":"join"}
{"nick":"doomhz","reason":"Ping timeout: 268 seconds","date":"2017-06-21T06:23:51.855Z","type":"quit"}
{"nick":"fuzzybear3965","date":"2017-06-21T06:26:07.495Z","type":"join"}
{"nick":"BSAlb","date":"2017-06-21T06:26:19.535Z","type":"join"}
{"nick":"lmoe","date":"2017-06-21T06:26:36.424Z","type":"join"}
{"nick":"lmoe","reason":"Client Quit","date":"2017-06-21T06:27:17.051Z","type":"quit"}
{"nick":"nodweber","date":"2017-06-21T06:27:44.261Z","type":"join"}
{"nick":"lmoe","date":"2017-06-21T06:28:52.133Z","type":"join"}
{"nick":"roomcayz","date":"2017-06-21T06:29:40.726Z","type":"join"}
{"nick":"BSaboia","reason":"Ping timeout: 260 seconds","date":"2017-06-21T06:30:12.288Z","type":"quit"}
{"nick":"asdasda","date":"2017-06-21T06:30:18.328Z","type":"join"}
{"nick":"ChALkeR","date":"2017-06-21T06:30:47.158Z","type":"join"}
{"nick":"asdasd","date":"2017-06-21T06:31:59.338Z","type":"join"}
{"nick":"m31271n","reason":"Quit: m31271n","date":"2017-06-21T06:34:35.233Z","type":"quit"}
{"nick":"m31271n","date":"2017-06-21T06:35:00.282Z","type":"join"}
{"nick":"asdasda","reason":"Ping timeout: 240 seconds","date":"2017-06-21T06:35:50.421Z","type":"quit"}
{"nick":"darkSeid_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T06:36:01.981Z","type":"quit"}
{"nick":"matozoid_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T06:37:25.724Z","type":"quit"}
{"nick":"smidr","date":"2017-06-21T06:38:37.746Z","type":"join"}
{"nick":"qard","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2017-06-21T06:40:23.081Z","type":"quit"}
{"nick":"smidr","message":"Anyone know of a library that will allow one to check a if a timestamp is matched by a rule, say \"Every weekday between 10:00AM and 09:00PM\"?","date":"2017-06-21T06:40:37.792Z","type":"message"}
{"nick":"GreenJello","message":"smidr, I'm sure moment can handle that","date":"2017-06-21T06:41:02.333Z","type":"message"}
{"nick":"GreenJello","message":"not like a human readable string, but you can express the logic sanely","date":"2017-06-21T06:41:22.258Z","type":"message"}
{"nick":"smidr","message":"GreenJello: Moment was my first guess too, however, I can't seem to find it in the docs","date":"2017-06-21T06:41:32.879Z","type":"message"}
{"nick":"malademe1tal","date":"2017-06-21T06:41:43.633Z","type":"part"}
{"nick":"synthmeat","reason":"Quit: WeeChat 1.8","date":"2017-06-21T06:42:02.076Z","type":"quit"}
{"nick":"melvster","date":"2017-06-21T06:42:10.893Z","type":"join"}
{"nick":"GreenJello","message":"smidr, get the day of the week and time of day in the correct timezone, and then write some if statements","date":"2017-06-21T06:42:16.222Z","type":"message"}
{"nick":"GreenJello","message":"if your input is literally that string, well, that's a harder problem","date":"2017-06-21T06:43:00.713Z","type":"message"}
{"nick":"smidr","message":"The thing is, the \"test\" has to be stored in a DB for several users and thus has to be some kind of rule or statement that can be parsed","date":"2017-06-21T06:43:28.707Z","type":"message"}
{"nick":"GreenJello","message":"store it as a json blob","date":"2017-06-21T06:43:45.959Z","type":"message"}
{"nick":"rhonabwy","reason":"Quit: Leaving","date":"2017-06-21T06:44:09.387Z","type":"quit"}
{"nick":"GreenJello","message":"[{type: 'day_of_week', values: [1, 2, 3, 4, 5]}, {type: 'after_minutes', value: 600},","date":"2017-06-21T06:44:39.121Z","type":"message"}
{"nick":"GreenJello","message":"something like that","date":"2017-06-21T06:44:46.882Z","type":"message"}
{"nick":"synthmeat","date":"2017-06-21T06:44:55.567Z","type":"join"}
{"nick":"rendar","date":"2017-06-21T06:45:01.138Z","type":"join"}
{"nick":"GreenJello","message":"rules engines can get quite complicated though","date":"2017-06-21T06:45:31.816Z","type":"message"}
{"nick":"smidr","message":"Oh yes :D","date":"2017-06-21T06:45:50.867Z","type":"message"}
{"nick":"GreenJello","message":"one time I ended up using s-expressions... that was... interesting","date":"2017-06-21T06:45:56.878Z","type":"message"}
{"nick":"bnason23","date":"2017-06-21T06:46:11.866Z","type":"join"}
{"nick":"smidr","message":"Can't really do a compare between two dates - Need my users to be able to specify which part of the day, and which weekdays they want notifications","date":"2017-06-21T06:46:39.790Z","type":"message"}
{"nick":"smidr","message":"s-expressions? That's a great way to torture yourself :P","date":"2017-06-21T06:46:56.584Z","type":"message"}
{"nick":"asteele","date":"2017-06-21T06:47:14.665Z","type":"join"}
{"nick":"Narbe","reason":"Quit: Page closed","date":"2017-06-21T06:47:39.409Z","type":"quit"}
{"nick":"GreenJello","message":"it actually worked quite well, and the rules were pretty complicated","date":"2017-06-21T06:47:43.669Z","type":"message"}
{"nick":"GreenJello","message":"So dropdown for start time, dropdown for end time, checkboxes for day of week?","date":"2017-06-21T06:48:04.870Z","type":"message"}
{"nick":"GreenJello","message":"that'd simplify the model if that's all you need to support","date":"2017-06-21T06:48:19.075Z","type":"message"}
{"nick":"smidr","message":"Hmm, yes that might just do it... And wouldn't need to use moment.js for that, should be rather simple in Vanilla Node","date":"2017-06-21T06:49:09.654Z","type":"message"}
{"nick":"bnason_","reason":"Ping timeout: 255 seconds","date":"2017-06-21T06:49:16.991Z","type":"quit"}
{"nick":"GreenJello","message":"smidr, well, you need to deal with timezones","date":"2017-06-21T06:50:22.194Z","type":"message"}
{"nick":"beerdrop","reason":"Ping timeout: 260 seconds","date":"2017-06-21T06:51:13.608Z","type":"quit"}
{"nick":"soee","reason":"Quit: Konversation terminated!","date":"2017-06-21T06:51:14.369Z","type":"quit"}
{"nick":"GreenJello","message":"timezones are tricky","date":"2017-06-21T06:51:22.302Z","type":"message"}
{"nick":"smidr","message":"Indeed, however I plan to refer to GMT server side, and then, in the frontend, convert that time to users configured local time","date":"2017-06-21T06:51:47.310Z","type":"message"}
{"nick":"leptone","reason":"Remote host closed the connection","date":"2017-06-21T06:51:56.278Z","type":"quit"}
{"nick":"chargen","date":"2017-06-21T06:52:00.427Z","type":"join"}
{"nick":"GreenJello","message":"smidr, oh, so you don't need to check the times on the server?","date":"2017-06-21T06:52:04.799Z","type":"message"}
{"nick":"smidr","message":"Oh wait, that won't work...","date":"2017-06-21T06:52:33.353Z","type":"message"}
{"nick":"matozoid","date":"2017-06-21T06:52:48.086Z","type":"join"}
{"nick":"smidr","message":"What I need to do is get the users notification interval and their timezone, convert that to GMT and compare that to the servers time (Which will be GMT aswell)","date":"2017-06-21T06:53:14.547Z","type":"message"}
{"nick":"angelluis_","date":"2017-06-21T06:53:41.590Z","type":"join"}
{"nick":"smidr","message":"Basically I have an notification generated by the server, and I need to check if a user wants to be notified based on their settings","date":"2017-06-21T06:53:51.541Z","type":"message"}
{"nick":"goodenough","reason":"Read error: Connection reset by peer","date":"2017-06-21T06:54:23.623Z","type":"quit"}
{"nick":"doomhz","date":"2017-06-21T06:54:56.534Z","type":"join"}
{"nick":"GreenJello","message":"hmm... looks like in recent browser versions you can do Intl.DateTimeFormat().resolvedOptions().timeZone to get the timezone","date":"2017-06-21T06:55:00.874Z","type":"message"}
{"nick":"asdasd","message":"if you know local time and you know gmt time","date":"2017-06-21T06:55:33.561Z","type":"message"}
{"nick":"asdasd","message":"then....","date":"2017-06-21T06:55:43.999Z","type":"message"}
{"nick":"zsvetlik","date":"2017-06-21T06:55:47.555Z","type":"join"}
{"nick":"GreenJello","message":"and, in case you're thinking of getTimezoneOffset, absolutely don't do that","date":"2017-06-21T06:56:34.303Z","type":"message"}
{"nick":"GreenJello","message":"mostly because of daylight savings time","date":"2017-06-21T06:56:46.746Z","type":"message"}
{"nick":"asdasd","message":"disregard peoples use of DST","date":"2017-06-21T06:57:07.775Z","type":"message"}
{"nick":"asdasd","message":"if they think they want DST","date":"2017-06-21T06:57:12.177Z","type":"message"}
{"nick":"asdasd","message":"they are mistaken","date":"2017-06-21T06:57:14.113Z","type":"message"}
{"nick":"asdasd","message":"and you can help them","date":"2017-06-21T06:57:16.513Z","type":"message"}
{"nick":"pstef_","date":"2017-06-21T06:57:29.917Z","type":"join"}
{"nick":"GreenJello","message":"I don't have DST, but you can't tell that from looking at my offset","date":"2017-06-21T06:57:34.766Z","type":"message"}
{"nick":"doomhz","reason":"Remote host closed the connection","date":"2017-06-21T06:57:48.951Z","type":"quit"}
{"nick":"doomhz","date":"2017-06-21T06:57:57.866Z","type":"join"}
{"nick":"doomhz_","date":"2017-06-21T06:59:13.496Z","type":"join"}
{"nick":"ryzokuken","date":"2017-06-21T06:59:54.944Z","type":"join"}
{"nick":"cybeaer","date":"2017-06-21T07:00:03.886Z","type":"join"}
{"nick":"doomhz","reason":"Ping timeout: 240 seconds","date":"2017-06-21T07:02:57.882Z","type":"quit"}
{"nick":"beerdrop","date":"2017-06-21T07:03:32.866Z","type":"join"}
{"nick":"Guest47983","reason":"Remote host closed the connection","date":"2017-06-21T07:04:59.329Z","type":"quit"}
{"nick":"Cohedrin_","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T07:06:03.833Z","type":"quit"}
{"nick":"Guest47983","date":"2017-06-21T07:07:24.051Z","type":"join"}
{"nick":"stormbytes","reason":"Quit: My Mac Mini has gone to sleep. ZZZzzz…","date":"2017-06-21T07:07:35.357Z","type":"quit"}
{"nick":"doomhz_","date":"2017-06-21T07:12:47.484Z","type":"quit"}
{"nick":"doomhz","date":"2017-06-21T07:13:11.661Z","type":"join"}
{"nick":"T-2000","reason":"Quit: Leaving","date":"2017-06-21T07:15:02.902Z","type":"quit"}
{"nick":"ryzokuken__","date":"2017-06-21T07:15:07.492Z","type":"join"}
{"nick":"matozoid","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T07:15:13.079Z","type":"quit"}
{"nick":"leptone","date":"2017-06-21T07:15:16.888Z","type":"join"}
{"nick":"Silvering","date":"2017-06-21T07:15:28.950Z","type":"join"}
{"nick":"zsoc","message":"n> JSON.stringify({ a: 'b' })","date":"2017-06-21T07:15:37.143Z","type":"message"}
{"nick":"babelboot","message":"zsoc: (okay) '{\"a\":\"b\"}'","date":"2017-06-21T07:15:39.492Z","type":"message"}
{"nick":"zsoc","message":"n> String(JSON.stringify({ a: 'b' }))","date":"2017-06-21T07:15:45.017Z","type":"message"}
{"nick":"babelboot","message":"zsoc: (okay) '{\"a\":\"b\"}'","date":"2017-06-21T07:15:47.499Z","type":"message"}
{"nick":"zsoc","action":"hmmms","date":"2017-06-21T07:15:53.430Z","type":"action"}
{"nick":"gunnaro","date":"2017-06-21T07:16:08.660Z","type":"join"}
{"nick":"doomhz","reason":"Client Quit","date":"2017-06-21T07:16:09.530Z","type":"quit"}
{"nick":"ryzokuken","reason":"Ping timeout: 268 seconds","date":"2017-06-21T07:16:16.853Z","type":"quit"}
{"nick":"lmoe","reason":"Quit: My notebook went to ****ing sleep - again..","date":"2017-06-21T07:16:32.794Z","type":"quit"}
{"nick":"rchavik","date":"2017-06-21T07:17:17.911Z","type":"join"}
{"nick":"matozoid","date":"2017-06-21T07:17:49.491Z","type":"join"}
{"nick":"goodenough","date":"2017-06-21T07:18:16.958Z","type":"join"}
{"nick":"leptone","reason":"Ping timeout: 255 seconds","date":"2017-06-21T07:19:47.938Z","type":"quit"}
{"nick":"berm","message":"win 32","date":"2017-06-21T07:21:02.360Z","type":"message"}
{"nick":"berm","message":"woops","date":"2017-06-21T07:21:08.087Z","type":"message"}
{"nick":"asdasd","message":"lol","date":"2017-06-21T07:21:12.968Z","type":"message"}
{"nick":"mochiyoda_","date":"2017-06-21T07:22:58.486Z","type":"join"}
{"nick":"mochiyoda","reason":"Read error: No route to host","date":"2017-06-21T07:23:12.077Z","type":"quit"}
{"nick":"karmahacker","date":"2017-06-21T07:25:20.876Z","type":"join"}
{"nick":"notadeveloper","reason":"Read error: No route to host","date":"2017-06-21T07:27:06.525Z","type":"quit"}
{"nick":"lpin","reason":"Read error: Connection reset by peer","date":"2017-06-21T07:27:06.835Z","type":"quit"}
{"nick":"notadeveloper","date":"2017-06-21T07:27:38.394Z","type":"join"}
{"nick":"MachinShin","reason":"Ping timeout: 260 seconds","date":"2017-06-21T07:28:04.284Z","type":"quit"}
{"nick":"agd_","date":"2017-06-21T07:28:19.508Z","type":"join"}
{"nick":"rabbitear","date":"2017-06-21T07:28:28.938Z","type":"join"}
{"nick":"Guest47983","reason":"Ping timeout: 260 seconds","date":"2017-06-21T07:30:52.285Z","type":"quit"}
{"nick":"munch_","reason":"Remote host closed the connection","date":"2017-06-21T07:31:03.934Z","type":"quit"}
{"nick":"caryhartline","reason":"Quit: Leaving.","date":"2017-06-21T07:31:08.267Z","type":"quit"}
{"nick":"lmoe","date":"2017-06-21T07:33:49.330Z","type":"join"}
{"nick":"systemfault","reason":"Quit: Bye!","date":"2017-06-21T07:35:47.045Z","type":"quit"}
{"nick":"f32","date":"2017-06-21T07:36:59.068Z","type":"join"}
{"nick":"fatalhalt","reason":"Remote host closed the connection","date":"2017-06-21T07:37:02.871Z","type":"quit"}
{"nick":"ryzokuken__","reason":"Ping timeout: 240 seconds","date":"2017-06-21T07:37:05.567Z","type":"quit"}
{"nick":"milardovich","date":"2017-06-21T07:37:43.214Z","type":"join"}
{"nick":"f32","message":"so phantomjs","date":"2017-06-21T07:38:57.015Z","type":"message"}
{"nick":"f32","message":"i wonder if there is a convenient way to pass phantom some script without having to get phantom loading it from disk","date":"2017-06-21T07:39:22.860Z","type":"message"}
{"nick":"f32","message":"probably right","date":"2017-06-21T07:39:29.742Z","type":"message"}
{"nick":"f32","message":"?","date":"2017-06-21T07:39:31.692Z","type":"message"}
{"nick":"f32","message":"it looks like it supports a repl of sorts","date":"2017-06-21T07:39:47.160Z","type":"message"}
{"nick":"rwesty202","date":"2017-06-21T07:40:06.057Z","type":"join"}
{"nick":"ahmedelgabri","date":"2017-06-21T07:41:04.015Z","type":"join"}
{"nick":"eSVG","date":"2017-06-21T07:41:11.382Z","type":"join"}
{"nick":"fatalhalt","date":"2017-06-21T07:41:23.064Z","type":"join"}
{"nick":"^esc","date":"2017-06-21T07:41:43.994Z","type":"join"}
{"nick":"svgDelux","date":"2017-06-21T07:43:15.589Z","type":"join"}
{"nick":"hextileX","reason":"Ping timeout: 246 seconds","date":"2017-06-21T07:44:02.511Z","type":"quit"}
{"nick":"__rgn","message":"maybe make it load it from your node app?","date":"2017-06-21T07:45:22.074Z","type":"message"}
{"nick":"eSVG","reason":"Ping timeout: 258 seconds","date":"2017-06-21T07:46:34.372Z","type":"quit"}
{"nick":"siba","date":"2017-06-21T07:46:59.434Z","type":"join"}
{"nick":"matozoid","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2017-06-21T07:48:05.218Z","type":"quit"}
{"nick":"verwilst","date":"2017-06-21T07:49:09.105Z","type":"join"}
{"nick":"stormbytes","date":"2017-06-21T07:50:17.771Z","type":"join"}
{"nick":"rwesty202","reason":"Ping timeout: 246 seconds","date":"2017-06-21T07:51:37.542Z","type":"quit"}
{"nick":"golonoza","reason":"Remote host closed the connection","date":"2017-06-21T07:52:04.507Z","type":"quit"}
{"nick":"golonoza","date":"2017-06-21T07:52:12.659Z","type":"join"}
{"nick":"hextileX","date":"2017-06-21T07:52:59.178Z","type":"join"}
{"nick":"ryzokuken","date":"2017-06-21T07:54:55.112Z","type":"join"}
{"nick":"Silenced","date":"2017-06-21T07:55:32.977Z","type":"join"}
{"nick":"Silenced","reason":"Client Quit","date":"2017-06-21T07:55:41.030Z","type":"quit"}
{"nick":"ryzokuken","reason":"Max SendQ exceeded","date":"2017-06-21T07:55:41.224Z","type":"quit"}
{"nick":"fastman_","date":"2017-06-21T07:55:49.721Z","type":"part"}
{"nick":"fastman","date":"2017-06-21T07:56:16.676Z","type":"join"}
{"nick":"ChALkeR","reason":"Ping timeout: 260 seconds","date":"2017-06-21T07:56:33.179Z","type":"quit"}
{"nick":"ryzokuken","date":"2017-06-21T07:56:33.287Z","type":"join"}
{"nick":"horsey_","date":"2017-06-21T07:56:44.650Z","type":"join"}
{"nick":"ryzokuken","reason":"Max SendQ exceeded","date":"2017-06-21T07:57:31.285Z","type":"quit"}
{"nick":"f32","message":"__rgn: id like to send phantom a thing to render","date":"2017-06-21T07:57:38.442Z","type":"message"}
{"nick":"f32","message":"__rgn: so, send it html as a string basically, have it parse it","date":"2017-06-21T07:57:55.994Z","type":"message"}
{"nick":"ryzokuken","date":"2017-06-21T07:58:08.287Z","type":"join"}
{"nick":"__rgn","message":"cool","date":"2017-06-21T07:58:39.813Z","type":"message"}
{"nick":"horsey","reason":"Ping timeout: 276 seconds","date":"2017-06-21T07:58:42.919Z","type":"quit"}
{"nick":"ChALkeR","date":"2017-06-21T07:59:53.322Z","type":"join"}
